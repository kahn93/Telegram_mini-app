import{r as t,j as e,u as xn,T as gn,R as lo,a as Qn,b as co,c as Ro,d as Co}from"./vendor-react--FyXiem4.js";import{c as Bo}from"./vendor-supabase-DoWyVS0q.js";import{_ as No}from"./vendor-BaVVdSmy.js";import"./vendor-ton-DdWMKeXQ.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const x of document.querySelectorAll('link[rel="modulepreload"]'))f(x);new MutationObserver(x=>{for(const I of x)if(I.type==="childList")for(const c of I.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&f(c)}).observe(document,{childList:!0,subtree:!0});function i(x){const I={};return x.integrity&&(I.integrity=x.integrity),x.referrerPolicy&&(I.referrerPolicy=x.referrerPolicy),x.crossOrigin==="use-credentials"?I.credentials="include":x.crossOrigin==="anonymous"?I.credentials="omit":I.credentials="same-origin",I}function f(x){if(x.ep)return;x.ep=!0;const I=i(x);fetch(x.href,I)}})();const Po="_modalOverlay_1lm47_1",Lo="_modalContent_1lm47_14",Do="_avatarGrid_1lm47_24",_o="_avatarOption_1lm47_31",Wo="_selected_1lm47_36",zo="_miningButtonWrapper_1lm47_41",Oo="_miningButton_1lm47_41",Uo="_pressed_1lm47_58",Go="_coinGain_1lm47_63",Ho="_topRow_1lm47_96",Yo="_coinBalanceCenter_1lm47_110",Fo="_passiveIncome_1lm47_119",Vo="_energyBarContainer_1lm47_135",Ko="_energyBar_1lm47_135",qo="_energyText_1lm47_176",Xo="_background_1lm47_188",Zo="_menuModalOverlay_1lm47_254",Qo="_menuModal_1lm47_254",Jo="_menuModalTitle_1lm47_279",$o="_menuModalList_1lm47_285",ea="_menuModalBtn_1lm47_290",ta="_app_1lm47_325",na="_countrySelection_1lm47_329",sa="_menu_1lm47_254",oa="_btn_1lm47_371",aa="_coinBalance_1lm47_110",ra="_coinsPerTap_1lm47_393",X={modalOverlay:Po,modalContent:Lo,avatarGrid:Do,avatarOption:_o,selected:Wo,miningButtonWrapper:zo,miningButton:Oo,pressed:Uo,coinGain:Go,topRow:Ho,coinBalanceCenter:Yo,passiveIncome:Fo,energyBarContainer:Vo,energyBar:Ko,energyText:qo,background:Xo,menuModalOverlay:Zo,menuModal:Qo,menuModalTitle:Jo,menuModalList:$o,menuModalBtn:ea,app:ta,countrySelection:na,menu:sa,btn:oa,coinBalance:aa,coinsPerTap:ra},Et={};let Pe=null,Vn=null;function Y(s){H()||(Et[s]||(Et[s]=new Audio(`/sounds/${s}.mp3`),Et[s].volume=.5),Et[s].currentTime=0,Et[s].play())}function ss(s,o=!0,i=.35){H()||Vn===s&&Pe||(pn(),Pe=new Audio(`/sounds/${s}.mp3`),Pe.loop=o,Pe.volume=i,Pe.play(),Vn=s)}function pn(){Pe&&(Pe.pause(),Pe.currentTime=0,Pe=null,Vn=null)}function ia(){fo(!H()),H()&&pn()}function H(){return localStorage.getItem("muteSounds")==="1"}function fo(s){localStorage.setItem("muteSounds",s?"1":"0"),s&&pn()}const la="https://pklvbpngamcbhsaxmlgn.supabase.co",ca="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBrbHZicG5nYW1jYmhzYXhtbGduIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU5MzE2NTEsImV4cCI6MjA3MTUwNzY1MX0.DcbX79sJg0aPGuCdGJCcCl9qoPWP4kM1E5GvO0SLeNQ",Q=Bo(la,ca),fa="arcade_scores",da="arcade_leaderboard";async function J(s,o,i){await Q.from(fa).insert([{game:s,userid:o,score:i}])}async function os(s){const{data:o,error:i}=await Q.from(da).select("*").eq("game",s).order("score",{ascending:!1}).limit(10);return i?[]:o}const ot=240,ie=340,Ae=12,je=38,Ee=32,_e=14,We=10;function wn(){return 20+Math.random()*(ot-40)}const ua=({userId:s})=>{const[o,i]=t.useState(s||"");t.useEffect(()=>{var T,h,y;if(!s)try{const W=(T=window.Telegram)==null?void 0:T.WebApp;W&&((y=(h=W.initDataUnsafe)==null?void 0:h.user)!=null&&y.id)&&i(W.initDataUnsafe.user.id.toString())}catch{}},[s]);const[f,x]=t.useState(ot/2),[I,c]=t.useState([]),[v,m]=t.useState([]),[j,A]=t.useState([]),[k,L]=t.useState(0),[B,_]=t.useState(3),[w,D]=t.useState(!1),[n,p]=t.useState(!1),[u,N]=t.useState(!1),[R,M]=t.useState(null),b=t.useRef(null);t.useEffect(()=>{const T=localStorage.getItem("guardianAngelHighScore");T&&M(Number(T))},[]),t.useEffect(()=>{if(w)return;const T=h=>{h.key==="ArrowLeft"&&x(y=>Math.max(je/2,y-24)),h.key==="ArrowRight"&&x(y=>Math.min(ot-je/2,y+24))};return window.addEventListener("keydown",T),()=>window.removeEventListener("keydown",T)},[w]),t.useEffect(()=>{if(w)return;const T=y=>{if(!b.current)return;const W=b.current.getBoundingClientRect(),U=y.touches[0].clientX-W.left;x(Math.max(je/2,Math.min(ot-je/2,U)))},h=b.current;return h&&h.addEventListener("touchmove",T),()=>{h&&h.removeEventListener("touchmove",T)}},[w]),t.useEffect(()=>{if(w)return;const T=setInterval(()=>{c(h=>h.map(y=>({...y,y:y.y+y.speed}))),m(h=>h.map(y=>({...y,y:y.y+y.speed}))),A(h=>h.map(y=>({...y,y:y.y+y.speed}))),c(h=>h.filter(y=>y.y<ie+Ae)),m(h=>h.filter(y=>y.y<ie+_e)),A(h=>h.filter(y=>y.y<ie+We)),c(h=>{let y=!1;const W=h.filter(U=>{const S=Math.abs(U.x-f),l=Math.abs(U.y-(ie-Ee/2));return S<Ae+je/2-4&&l<Ae+Ee/2-4?(y=!0,!1):!0});return y&&(L(U=>U+10),N(!0),H()||Y("win"),setTimeout(()=>N(!1),400)),W}),m(h=>{let y=!1;const W=h.filter(U=>{const S=Math.abs(U.x-f),l=Math.abs(U.y-(ie-Ee/2));return S<_e+je/2-2&&l<_e+Ee/2-2?(y=!0,!1):!0});return y&&(_(U=>U-1),H()||Y("die")),W}),A(h=>{let y=!1;const W=h.filter(U=>{const S=Math.abs(U.x-f),l=Math.abs(U.y-(ie-Ee/2));return S<We+je/2-2&&l<We+Ee/2-2?(y=!0,!1):!0});return y&&(L(U=>U+30),H()||Y("bonus")),W}),c(h=>{let y=!1;const W=h.filter(U=>U.y>=ie-Ae?(y=!0,!1):!0);return y&&(_(U=>U-1),H()||Y("die")),W})},40);return()=>clearInterval(T)},[f,w]),t.useEffect(()=>{if(w)return;const T=setInterval(()=>{c(W=>[...W,{x:wn(),y:-Ae,speed:2.2+Math.random()*1.2}])},900),h=setInterval(()=>{m(W=>[...W,{x:wn(),y:-_e,speed:2.5+Math.random()*1.5}])},1800),y=setInterval(()=>{Math.random()<.5&&A(W=>[...W,{x:wn(),y:-We,speed:2.1+Math.random()*1.1}])},3500);return()=>{clearInterval(T),clearInterval(h),clearInterval(y)}},[w]),t.useEffect(()=>{B<=0&&!w&&(D(!0),p(!0),H()||Y("die"),setTimeout(()=>p(!1),1200),k>(R||0)&&(M(k),localStorage.setItem("guardianAngelHighScore",String(k))),o&&k>0&&J("GuardianAngel",o,k))},[B,w,k,o,R]);const d=()=>{c([]),m([]),A([]),L(0),_(3),D(!1),p(!1),x(ot/2)};return e.jsxs("div",{className:X.arcadeGame,style:{padding:12,textAlign:"center",maxWidth:340,margin:"0 auto"},children:[e.jsx("h2",{style:{color:"#6ec6ff",textShadow:"0 0 8px #fff",marginBottom:8},children:"ðŸ‘¼ Guardian Angel"}),e.jsxs("div",{ref:b,style:{position:"relative",width:ot,height:ie,margin:"0 auto",background:"radial-gradient(ellipse at 60% 40%, #23234a 70%, #18182a 100%)",borderRadius:18,boxShadow:"0 0 32px #6ec6ff",overflow:"hidden",border:"2px solid #6ec6ff"},children:[I.map((T,h)=>e.jsx("div",{style:{position:"absolute",left:T.x-Ae,top:T.y-Ae,width:Ae*2,height:Ae*2,borderRadius:"50%",background:"linear-gradient(135deg,#fff,#ffe259 80%)",boxShadow:"0 0 8px #ffe259",display:"flex",alignItems:"center",justifyContent:"center",fontSize:18,color:"#23234a",zIndex:2},children:"ðŸ‘¶"},h)),v.map((T,h)=>e.jsx("div",{style:{position:"absolute",left:T.x-_e,top:T.y-_e,width:_e*2,height:_e*2,borderRadius:"50%",background:"linear-gradient(135deg,#e57373,#b71c1c 80%)",boxShadow:"0 0 8px #b71c1c",display:"flex",alignItems:"center",justifyContent:"center",fontSize:18,color:"#fff",zIndex:2},children:"ðŸ˜ˆ"},h)),j.map((T,h)=>e.jsx("div",{style:{position:"absolute",left:T.x-We,top:T.y-We,width:We*2,height:We*2,borderRadius:"50%",background:"linear-gradient(135deg,#b2ff59,#00e676 80%)",boxShadow:"0 0 8px #00e676",display:"flex",alignItems:"center",justifyContent:"center",fontSize:16,color:"#222",zIndex:2},children:"â­"},h)),e.jsx("div",{style:{position:"absolute",left:f-je/2,top:ie-Ee-6,width:je,height:Ee,borderRadius:12,background:"linear-gradient(135deg,#fff,#6ec6ff 80%)",boxShadow:"0 0 12px #6ec6ff",display:"flex",alignItems:"center",justifyContent:"center",fontSize:28,color:"#23234a",zIndex:3,border:"2px solid #fff"},children:"ðŸ˜‡"}),u&&e.jsx("div",{style:{position:"absolute",left:f-18,top:ie-Ee-32,color:"#ffe600",fontWeight:700,fontSize:18,textShadow:"0 0 8px #fff",zIndex:10,animation:"popSuccess 0.5s"},children:"+10"}),w&&e.jsxs("div",{style:{position:"absolute",left:0,top:0,width:ot,height:ie,background:"#23234acc",zIndex:20,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",borderRadius:18},children:[e.jsx("div",{style:{color:"#ffe600",fontWeight:900,fontSize:32,marginBottom:10,textShadow:"0 0 18px #fff, 0 0 24px #ffe600",animation:n?"popError 1.1s":void 0},children:"ðŸ’” GAME OVER"}),e.jsxs("div",{style:{color:"#fff",fontWeight:700,fontSize:20,marginBottom:8},children:["Score: ",k]}),R!==null&&e.jsxs("div",{style:{color:"#6ec6ff",fontWeight:600,fontSize:16,marginBottom:8},children:["High Score: ",R]}),e.jsx("button",{onClick:d,style:{background:"#6ec6ff",color:"#222",fontWeight:700,fontSize:18,border:"none",borderRadius:12,padding:"10px 28px",marginTop:10,boxShadow:"0 2px 12px #6ec6ff88",cursor:"pointer"},children:"Restart"})]}),e.jsx("div",{style:{position:"absolute",left:10,top:8,color:"#ffe600",fontWeight:700,fontSize:18,textShadow:"0 0 8px #fff",zIndex:10},children:Array.from({length:B}).map((T,h)=>e.jsx("span",{children:"â¤ï¸"},h))}),e.jsx("div",{style:{position:"absolute",right:10,top:8,color:"#fff",fontWeight:700,fontSize:18,textShadow:"0 0 8px #6ec6ff",zIndex:10},children:k})]}),e.jsxs("div",{style:{color:"#ffe600",fontWeight:600,fontSize:14,marginTop:8,textShadow:"0 0 6px #fff"},children:["User: ",o||"Not connected"]}),e.jsx("style",{children:`
        @keyframes popSuccess {
          0% { transform: scale(1); }
          50% { transform: scale(1.2); }
          100% { transform: scale(1); }
        }
        @keyframes popError {
          0% { transform: scale(1); }
          50% { transform: scale(1.15); }
          100% { transform: scale(1); }
        }
      `})]})};async function ha(s){return ke("analytics",s)}async function ke(s,o){const{data:i,error:f}=await Q.functions.invoke(s,{body:JSON.stringify(o),headers:{"Content-Type":"application/json"}});if(f)throw f;return i}async function kn(s){return ke("coin_balance_save_load",s)}async function xa(s){return ke("user_upgrade_purchase",s)}async function ga(s){return ke("guardian_angel_airdrop",s)}async function pa(s){return ke("ton_jetton_payment_verify",s)}async function as(s){return ke("slot_machine_deposit_withdraw",s)}async function ya(s){return ke("chat_message_send",s)}async function ma(s){return ke("nft_mint",s)}async function Sa(s){return ke("marketplace_action",s)}async function ba(s){return ke("achievement_unlock",s)}const Jn="/assets/rocket-DzE50pAu.png",va="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALYAAAAuCAYAAACFxeMqAAADRElEQVR42u2dQW7tIAxFs4cu6m+hS+l+OvwbfLN00kqvPGNsX5sGcpGuVLUNAXMwYEhyHN/p/9txUtTqOp4TDUJtB7dKPBPTIumF4xbqx8f7SVGrqYX7INTUjnATbIpgUxTBpiiCTVEEm0qGIfr/0rXW8BzBBhphtfqg9YtcPwK1B2778688Ho9T0zJgI4F1tOGi5Z7pSSxl6IHizctjkx8IPdc9X9NevyXYo8qglew1QqRztOX9K8hbSCRQwvkYbDOC1HrNS7soNq20bxnYlZ67dw8rCBrQ5+e/U1I14M/l/7lftMO3+YzK3ru3B2ypzO3fNWXbthTsUWUiAEn5eyCQvIunrJUeBq1XC7UV0minMpXZAXamXS8H9qgH9/K3NAYC9AwPk1Uv6fqoPb1gv1zr8diJc+7Lgi3Bo+XtASCjbNlwR+umQZ0BdtSeo3IRbEfeCABXBrtXN0udNGCs94w6CnpsAzyWfC1gR8olTVt6cdvoAjlUP0NHzQA7o2PcCmzLPFeKelgM5PVsbqCFBreGOqNg9yIPEWC890M6I8HWVsvOnt+Lp2YCrcHi9dpR7xYFBnEUBNs53GeAjcZTtfv3gA7DCdjNawtpZEHy8HYOgq1MRVzzchBsD9DIaBUdVby2yAAbzed2UxHLUBbpKJGNAmmU8Oz8RYfeWWAjjodgF1TWO39DwO55VY8NVgW7Z9OMtQvBNgb4Ld4+c6cx4rnVxeNksNHFXmWZt52KSI2OLqYyzoSggFtDf1cBW7Np5qJ8e7BHjW7NB/H8VYB7wn4VG1vRcxs9qNGOYi7nLmBrjY6AlzkdUeeeE7bUZ4Ldi+NnrV1uBXZvkwM1WMVcG11c/hXYGeseZBS4LdjZB5WyvUz0rPSuYGc6iiXARmK5WdGLNh8U7kqoK+ue9eBHz57RPQatnJd+Sh09x5AZGciObVc+iFoZFam05fZRESSWiz7lbr2fdOzTuvs54+nqijpX2jM7r8u/VyTjGGelrA0065UBlfVvF3wVtkzLZwWwo0c4ZyXxvR6DjjD7PSN3S3zF2WSo+Bo0vruPogg2RRFsiiLYFMEm2NTuYBNuasvP4fEDpkxbfcBU+iVF8XvqFHVBqL8ADLBVpSxQqIEAAAAASUVORK5CYII=",qe="/assets/gift-D7ErWEXl.png",Ht="/assets/money-DHhF0O9w.png";async function wa(s){const{data:o}=await Q.from("nfts").select("*").eq("userid",s);return o||[]}async function ka(s){const{data:o,error:i}=await Q.from("nfts").insert([s]);return{data:o,error:i}}const Aa=()=>{const[s,o]=t.useState([]),[i,f]=t.useState(!0),[x,I]=t.useState(""),[c,v]=t.useState(""),[m,j]=t.useState("item"),[A,k]=t.useState(!1),[L,B]=t.useState(""),[_,w]=t.useState(""),[D,n]=t.useState("");t.useEffect(()=>{Q.from("marketplace_listings").select("*").eq("status","active").then(({data:u})=>{o(u||[]),f(!1)})},[]);const p=async u=>{const N=localStorage.getItem("userId")||"anon";await Sa({userId:N,action:"buy",itemId:u.id.toString()}),o(s.filter(R=>R.id!==u.id)),alert(`Purchased ${u.item}!`)};return e.jsxs("div",{style:{maxWidth:600,margin:"32px auto",padding:24},children:[e.jsx("h2",{style:{textAlign:"center",color:"#24308a",fontWeight:800},children:"Marketplace"}),e.jsxs("form",{style:{marginBottom:32,background:"#fff",borderRadius:8,padding:16,boxShadow:"0 2px 8px #0001"},onSubmit:async u=>{if(u.preventDefault(),!x||!c)return;k(!0);const N=localStorage.getItem("userId")||"anon";let R;if(m==="nft"){if(!L||!_){alert("Please fill NFT name and image URL"),k(!1);return}R=Date.now().toString();const{error:T}=await ka({userid:N,nft_id:R,name:L,image_url:_,description:D});if(T){alert("Error minting NFT!"),k(!1);return}}const{error:M,data:b}=await Q.from("marketplace_listings").insert([{seller:N,item:m==="nft"?L:x,price:parseFloat(c),type:m,status:"active",...m==="nft"?{nft_id:R,image_url:_,description:D}:{}}]);k(!1);const d=b;!M&&d&&d.length>0&&typeof d[0].id=="number"?(o(T=>[...T,{id:d[0].id,seller:N,item:m==="nft"?L:x,price:parseFloat(c),type:m,status:"active"}]),I(""),v(""),j("item"),B(""),w(""),n("")):alert("Error creating listing!")},children:[e.jsx("h4",{style:{margin:0,color:"#24308a"},children:"Create Listing"}),e.jsxs("div",{style:{display:"flex",gap:8,marginTop:8},children:[m==="nft"?e.jsxs(e.Fragment,{children:[e.jsx("input",{placeholder:"NFT Name",value:L,onChange:u=>B(u.target.value),style:{flex:2,padding:6,borderRadius:4,border:"1px solid #ccc"},required:!0}),e.jsx("input",{placeholder:"Image URL",value:_,onChange:u=>w(u.target.value),style:{flex:2,padding:6,borderRadius:4,border:"1px solid #ccc"},required:!0}),e.jsx("input",{placeholder:"Description",value:D,onChange:u=>n(u.target.value),style:{flex:2,padding:6,borderRadius:4,border:"1px solid #ccc"}})]}):e.jsx("input",{placeholder:"Item name",value:x,onChange:u=>I(u.target.value),style:{flex:2,padding:6,borderRadius:4,border:"1px solid #ccc"},required:!0}),e.jsx("input",{placeholder:"Price (TON)",value:c,onChange:u=>v(u.target.value.replace(/[^0-9.]/g,"")),style:{flex:1,padding:6,borderRadius:4,border:"1px solid #ccc"},required:!0,type:"number",min:"0.01",step:"0.01"}),e.jsxs("select",{value:m,onChange:u=>j(u.target.value),style:{flex:1,padding:6,borderRadius:4},children:[e.jsx("option",{value:"item",children:"Item"}),e.jsx("option",{value:"boost",children:"Boost"}),e.jsx("option",{value:"nft",children:"NFT"})]}),e.jsx("button",{type:"submit",disabled:A,style:{background:"#ffe259",color:"#222",fontWeight:700,border:"none",borderRadius:4,padding:"0 16px"},children:A?"Listing...":"List"})]})]}),i?e.jsx("div",{style:{textAlign:"center",color:"#888",marginTop:32},children:"Loading..."}):e.jsx("ul",{style:{listStyle:"none",padding:0},children:s.map(u=>e.jsxs("li",{style:{background:"rgba(255,255,255,0.12)",borderRadius:8,margin:"12px 0",padding:16,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[u.type==="boost"&&e.jsx("img",{src:Jn,alt:"Boost",style:{width:28,verticalAlign:"middle"}}),u.type==="nft"&&e.jsx("img",{src:va,alt:"NFT",style:{width:28,verticalAlign:"middle"}}),u.type==="item"&&e.jsx("img",{src:qe,alt:"Item",style:{width:28,verticalAlign:"middle"}}),e.jsx("strong",{children:u.item})," ",e.jsxs("span",{style:{fontSize:12,color:"#888"},children:["(",u.type,")"]}),e.jsx("br",{}),e.jsxs("span",{style:{color:"#888",fontSize:11},children:["Seller: ",u.seller]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("img",{src:Ht,alt:"TON",style:{width:22,verticalAlign:"middle"}}),e.jsxs("span",{style:{fontWeight:700,color:"#24308a"},children:[u.price," TON"]}),e.jsx("button",{style:{marginLeft:16,padding:"6px 14px",borderRadius:4,background:"#ffe259",color:"#222",fontWeight:700,border:"none",cursor:"pointer"},onClick:()=>p(u),children:"Buy"})]})]},u.id))}),!i&&s.length===0&&e.jsx("div",{style:{textAlign:"center",color:"#888",marginTop:32},children:"No active listings."})]})},ja="https://lisa-games.onrender.com";async function Ea(s,o,i){return fetch(`${ja}/webhook/analytics`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({event:s,userId:o,referrerId:i})})}function Ia(){"Notification"in window&&Notification.permission!=="granted"&&Notification.requestPermission()}function Ta(s,o){"Notification"in window&&Notification.permission==="granted"&&new Notification(s,o)}const Ma="/assets/check-BK0B6DVF.png",Ra="/assets/fail-DfMFjEyK.png",yn="/assets/list-DXF8oD-t.png",Ca=t.createContext({notify:()=>{}}),Ba=({children:s})=>{const[o,i]=t.useState(null),f=x=>{i(x),setTimeout(()=>i(null),x.duration||3e3)};return e.jsxs(Ca.Provider,{value:{notify:f},children:[s,o&&e.jsxs("div",{style:{position:"fixed",top:24,right:24,zIndex:9999,background:o.type==="success"?"#00b894":o.type==="error"?"#d63031":"#222",color:"#fff",padding:"12px 24px",borderRadius:8,boxShadow:"0 2px 16px #0004",fontWeight:700,fontSize:16,minWidth:180,textAlign:"center",animation:"popNotif 0.5s",display:"flex",alignItems:"center",gap:10},children:[o.type==="success"&&e.jsx("img",{src:Ma,alt:"Success",style:{width:24,verticalAlign:"middle"}}),o.type==="error"&&e.jsx("img",{src:Ra,alt:"Error",style:{width:24,verticalAlign:"middle"}}),o.type==="info"&&e.jsx("img",{src:yn,alt:"Info",style:{width:24,verticalAlign:"middle"}}),e.jsx("span",{children:o.message}),e.jsx("style",{children:`
            @keyframes popNotif {
              0% { transform: scale(0.8); opacity: 0.5; }
              60% { transform: scale(1.1); opacity: 1; }
              100% { transform: scale(1); opacity: 1; }
            }
          `})]})]})},mn="users";async function Na(s){await Q.from(mn).upsert([s],{onConflict:"userid"})}async function Pa(s,o){await Q.from(mn).update(o).eq("userid",s)}async function $n(s){const{data:o}=await Q.from(mn).select("*").eq("userid",s).single();return o||null}async function La(){const{data:s}=await Q.from(mn).select("*");return s||[]}async function Da(s){const{data:o}=await Q.from("users").select("*").eq("referral_code",s).single();return o}async function rs(s,o,i,f=1){await Q.from("referrals").insert([{referrer_id:s,referred_id:o,parent_referral_id:i||null,referral_level:f}])}const _a=["Afghanistan","Albania","Algeria","Andorra","Angola","Antigua & Deps","Argentina","Armenia","Australia","Austria","Azerbaijan","Bahamas","Bahrain","Bangladesh","Barbados","Belarus","Belgium","Belize","Benin","Bhutan","Bolivia","Bosnia Herzegovina","Botswana","Brazil","Brunei","Bulgaria","Burkina","Burundi","Cambodia","Cameroon","Canada","Cape Verde","Central African Rep","Chad","Chile","China","Colombia","Comoros","Congo","Costa Rica","Croatia","Cuba","Cyprus","Czech Republic","Denmark","Djibouti","Dominica","Dominican Republic","East Timor","Ecuador","Egypt","El Salvador","Equatorial Guinea","Eritrea","Estonia","Ethiopia","Fiji","Finland","France","Gabon","Gambia","Georgia","Germany","Ghana","Greece","Grenada","Guatemala","Guinea","Guinea-Bissau","Guyana","Haiti","Honduras","Hungary","Iceland","India","Indonesia","Iran","Iraq","Ireland","Israel","Italy","Ivory Coast","Jamaica","Japan","Jordan","Kazakhstan","Kenya","Kiribati","Korea North","Korea South","Kosovo","Kuwait","Kyrgyzstan","Laos","Latvia","Lebanon","Lesotho","Liberia","Libya","Liechtenstein","Lithuania","Luxembourg","Macedonia","Madagascar","Malawi","Malaysia","Maldives","Mali","Malta","Marshall Islands","Mauritania","Mauritius","Mexico","Micronesia","Moldova","Monaco","Mongolia","Montenegro","Morocco","Mozambique","Myanmar","Namibia","Nauru","Nepal","Netherlands","New Zealand","Nicaragua","Niger","Nigeria","Norway","Oman","Pakistan","Palau","Panama","Papua New Guinea","Paraguay","Peru","Philippines","Poland","Portugal","Qatar","Romania","Russian Federation","Rwanda","St Kitts & Nevis","St Lucia","Saint Vincent & the Grenadines","Samoa","San Marino","Sao Tome & Principe","Saudi Arabia","Senegal","Serbia","Seychelles","Sierra Leone","Singapore","Slovakia","Slovenia","Solomon Islands","Somalia","South Africa","South Sudan","Spain","Sri Lanka","Sudan","Suriname","Swaziland","Sweden","Switzerland","Syria","Taiwan","Tajikistan","Tanzania","Thailand","Togo","Tonga","Trinidad & Tobago","Tunisia","Turkey","Turkmenistan","Tuvalu","Uganda","Ukraine","United Arab Emirates","United Kingdom","United States","Uruguay","Uzbekistan","Vanuatu","Vatican City","Venezuela","Vietnam","Yemen","Zambia","Zimbabwe"],Wa="_leaderboard_1c6t9_1",za="_top1_1c6t9_49",Oa="_top2_1c6t9_57",Ua="_top3_1c6t9_65",Ft={leaderboard:Wa,top1:za,top2:Oa,top3:Ua},we="/assets/crown-D07N0x4g.png",At="/assets/trophy-fGOFSCFR.png",Ga=()=>{const[s,o]=t.useState([]),[i,f]=t.useState([]),[x,I]=t.useState("global"),[c,v]=t.useState(""),[m,j]=t.useState([]);return t.useEffect(()=>{let A=!0;const k=async()=>{var _;const B=await La();if(B.sort((w,D)=>D.coins-w.coins),A){o(B);const w=localStorage.getItem("country")||(((_=B.find(n=>n.userid===localStorage.getItem("userId")))==null?void 0:_.country)??"");v(w);const D=JSON.parse(localStorage.getItem("friends")||"[]");j(D),f(B.slice(0,100))}};k();const L=setInterval(k,5e3);return()=>{A=!1,clearInterval(L)}},[]),t.useEffect(()=>{let A=s;x==="country"&&c?A=s.filter(k=>k.country===c):x==="friends"&&m.length>0&&(A=s.filter(k=>m.includes(k.userid))),f(A.slice(0,100))},[x,s,c,m]),e.jsxs("div",{className:Ft.leaderboard,children:[e.jsx("h2",{children:"Leaderboard"}),e.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"center",marginBottom:12},children:[e.jsx("button",{onClick:()=>I("global"),style:{fontWeight:x==="global"?700:400,background:x==="global"?"#ffe259":"#fff",borderRadius:6,padding:"4px 16px",border:"1px solid #eee"},children:"Global"}),e.jsx("button",{onClick:()=>I("country"),style:{fontWeight:x==="country"?700:400,background:x==="country"?"#ffe259":"#fff",borderRadius:6,padding:"4px 16px",border:"1px solid #eee"},children:"Country"}),e.jsx("button",{onClick:()=>I("friends"),style:{fontWeight:x==="friends"?700:400,background:x==="friends"?"#ffe259":"#fff",borderRadius:6,padding:"4px 16px",border:"1px solid #eee"},children:"Friends"})]}),e.jsx("ul",{children:i.map((A,k)=>e.jsxs("li",{className:k===0?Ft.top1:k===1?Ft.top2:k===2?Ft.top3:"",style:{"--i":k},children:[k===0&&e.jsx("img",{src:we,alt:"Crown",style:{width:24,marginRight:4,verticalAlign:"middle"}}),k===1&&e.jsx("img",{src:At,alt:"Trophy",style:{width:22,marginRight:4,verticalAlign:"middle"}}),k===2&&e.jsx("img",{src:At,alt:"Trophy",style:{width:20,marginRight:4,verticalAlign:"middle",filter:"grayscale(0.5)"}}),k+1,". ",A.userid," (",A.country,"): ",A.coins," coins"]},A.userid))})]})},es="data:image/png;base64,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",Ha="data:image/png;base64,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",Sn="data:image/png;base64,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",ve="/assets/cdollar-BAHfZPNA.png",Yt="/assets/earn-BNCIqzz0.png",ts="/assets/airdrop-CxSwq6QT.png",jt="/assets/tg-n2id2ce2.png",Ya="/assets/arcade_pacman_sprites-D1QHgfjt.png",bn="/assets/axs-DhhIb20v.png",is=[{label:"Home",page:"coin",icon:es},{label:"Shop",page:"Shop",icon:Ht},{label:"Trophies",page:"Trophies",icon:Ha},{label:"Tasks",page:"Tasks",icon:Sn},{label:"Upgrades",page:"Upgrades",icon:ve},{label:"Friends",page:"Friends",icon:yn},{label:"Arcade",page:"Arcade",icon:Yt},{label:"Airdrop",page:"Airdrop",icon:ts},{label:"Leaderboard",page:"leaderboard",icon:we},{label:"Guardian Angel",page:"guardianangel",icon:At},{label:"Chat",page:"chat",icon:jt},{label:"Events",page:"events",icon:At},{label:"NFTs",page:"Marketplace",icon:Ya},{label:"Analytics",page:"useranalytics",icon:bn},{label:"Boosts",page:"Boosts",icon:Jn}],Fa=localStorage.getItem("userRole")==="admin",Va=({onNavigate:s,extraItems:o})=>{const[i,f]=t.useState(H()),[x,I]=t.useState(!1),c=()=>{fo(!i),f(!i)},v=()=>{I(A=>{const k=!A;return k?document.body.style.overflow="hidden":document.body.style.overflow="",k})},m=A=>{I(!1),document.body.style.overflow="",s(A)},j=o?[...is,...o]:is;return e.jsxs(e.Fragment,{children:[e.jsxs("nav",{className:X.menu,children:[e.jsx("button",{className:X.btn,onClick:v,type:"button","aria-label":"Open menu",style:{background:"#ffe259",color:"#222",fontWeight:700},children:"â˜°"}),e.jsx("button",{className:X.btn,onClick:c,type:"button","aria-label":i?"Unmute sounds":"Mute sounds",style:{background:i?"#eee":"#ffe259",color:"#222",fontWeight:700},children:i?"ðŸ”‡":"ðŸ”Š"}),Fa&&e.jsx("button",{className:X.btn,onClick:()=>m("AdminAnalytics"),type:"button",style:{background:"#ffe259",color:"#222",fontWeight:700},children:"Admin"})]}),x&&e.jsx("div",{className:X.menuModalOverlay,onClick:()=>{I(!1),document.body.style.overflow=""},children:e.jsxs("div",{className:X.menuModal,onClick:A=>A.stopPropagation(),children:[e.jsx("div",{className:X.menuModalTitle,children:"Menu"}),e.jsx("div",{className:X.menuModalList,children:j.map(A=>e.jsxs("button",{className:X.menuModalBtn,onClick:()=>m(A.page),type:"button",children:[A.icon&&e.jsx("img",{src:A.icon,alt:A.label,style:{height:22,width:22,marginRight:10,verticalAlign:"middle"}}),A.label]},A.page))})]})})]})},Ka="_shopContainer_13ln7_474",qa="_shopAbsoluteLayout_13ln7_489",Xa="_shopItemAbsolute_13ln7_495",Za="_shopBuyBtn_13ln7_623",Qa="_shopActions_13ln7_638",It={shopContainer:Ka,shopAbsoluteLayout:qa,shopItemAbsolute:Xa,shopBuyBtn:Za,shopActions:Qa};async function Le(s,o,i){await ha({userid:s,event:o,details:i})}const vn="UQC9Vgi5erLMGVOHit2dQ5C1dww3XTV0OAvWOm3XhgVaVUI_",Ne="/assets/ewallet-BwdFUCtF.png",dn="/assets/turbo-i3NQ1NMb.png",un="/assets/button-BU5-t-rk.png",ls=[{label:"1.2x Coin Mult",value:1.2,price:.3,icon:ve,desc:"+20%/tap"},{label:"1.5x Coin Mult",value:1.5,price:.7,icon:ve,desc:"+50%/tap"},{label:"2x Coin Mult",value:2,price:1.2,icon:ve,desc:"2x/tap"},{label:"3x Coin Mult",value:3,price:2.5,icon:ve,desc:"3x/tap"},{label:"5x Coin Mult",value:5,price:5,icon:ve,desc:"5x/tap"},{label:"1.2x Energy Mult",value:1.2,price:.3,icon:Ne,desc:"+20% energy"},{label:"1.5x Energy Mult",value:1.5,price:.7,icon:Ne,desc:"+50% energy"},{label:"2x Energy Mult",value:2,price:1.2,icon:Ne,desc:"2x energy"},{label:"3x Energy Mult",value:3,price:2.5,icon:Ne,desc:"3x energy"},{label:"5x Energy Mult",value:5,price:5,icon:Ne,desc:"5x energy"},{label:"Auto Clicker",desc:"Auto 1hr",price:.5,effect:"autoclicker",icon:dn},{label:"Energy Refill",desc:"Full energy",price:.4,effect:"refill",icon:Ne},{label:"Golden Tap",desc:"+100/tap",price:2.5,effect:"goldentap",icon:un}],Ja=({onPurchase:s,purchased:o})=>{const[i,f]=t.useState(null),[x,I]=t.useState(null),[c]=xn(),[v,m]=t.useState(null),j=async A=>{f(null),m(null),I(A.label);try{if(!c.account){m("Please connect your TON wallet before making a purchase."),I(null);return}await c.sendTransaction({validUntil:Math.floor(Date.now()/1e3)+360,messages:[{address:vn,amount:(A.price*1e9).toString()}]}),f(`âœ… Purchase successful: ${A.label}`),s(A);const k=localStorage.getItem("userId")||"unknown";await Le(k,"shop_purchase",{item:A.label,price:A.price})}catch(k){let L="Transaction cancelled or failed.";typeof k=="object"&&k&&"message"in k&&typeof k.message=="string"&&(L+=`
${k.message}`),f(L)}I(null)};return e.jsxs("div",{className:It.shopContainer,children:[e.jsx("div",{className:It.shopAbsoluteLayout,style:{width:600,height:600,position:"relative",margin:"0 auto"},children:(()=>{const w=ls.length,D=Array.from({length:w},(n,p)=>{let u=64;p===0?u=128:p===1?u=96:p===2?u=72:u+=16;let N=0;return p>=3&&(N=(p-2)*16),{x:224,y:-12+p*32-u+N,width:152,height:15}});return ls.map((n,p)=>{const u=D[p]||{x:0,y:0,width:100,height:50};return e.jsxs("div",{className:It.shopItemAbsolute,style:{position:"absolute",left:u.x,top:u.y,width:u.width,height:u.height,boxSizing:"border-box",background:"none"},children:[e.jsx("img",{src:n.icon,alt:n.label,style:{width:24,height:24,marginRight:8}}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:700,color:"#000"},children:n.label}),e.jsx("div",{style:{fontSize:"0.85em",color:"#000"},children:n.desc})]}),e.jsxs("div",{style:{fontWeight:700,color:"#000",marginLeft:8},children:[n.price," TON"]}),e.jsx("button",{className:It.shopBuyBtn,onClick:()=>j(n),disabled:!!o[n.label]||x===n.label,children:x===n.label?"...":o[n.label]?"Owned":"Buy"})]},n.label)})})()}),e.jsx("div",{className:It.shopActions,children:e.jsx(gn,{})}),v&&e.jsx("div",{style:{color:"red",fontWeight:600,margin:"8px 0"},children:v}),i&&e.jsx("div",{style:{animation:i.startsWith("âœ…")?"popSuccess 0.5s":void 0},children:i}),e.jsx("style",{children:`
						@keyframes popSuccess {
							0% { transform: scale(0.8); opacity: 0.5; }
							60% { transform: scale(1.1); opacity: 1; }
							100% { transform: scale(1); opacity: 1; }
						}
					`})]})},$a=()=>{const[s,o]=t.useState([]),[i,f]=t.useState(!0),[x,I]=t.useState(""),[c,v]=t.useState(""),[m,j]=t.useState("");t.useEffect(()=>{f(!0),I(""),(async()=>{const{data:L,error:B}=await Q.from("analytics_events").select("*").order("created_at",{ascending:!1}).limit(200);B?I(B.message):o(L||[]),f(!1)})()},[]);const A=s.filter(k=>(!c||k.userid===c)&&(!m||k.event===m));return e.jsxs("div",{style:{padding:24,background:"#222",color:"#fff",borderRadius:12,maxWidth:800,margin:"0 auto"},children:[e.jsx("h2",{children:"Analytics Events (Admin)"}),e.jsxs("div",{style:{marginBottom:12},children:[e.jsx("input",{placeholder:"Filter by User ID",value:c,onChange:k=>v(k.target.value),style:{marginRight:8,borderRadius:4,padding:4,outline:"none",boxShadow:"0 0 0 2px #24308a33",transition:"box-shadow 0.2s"},"aria-label":"Filter by User ID",tabIndex:0,onFocus:k=>k.currentTarget.style.boxShadow="0 0 0 3px #24308a",onBlur:k=>k.currentTarget.style.boxShadow="0 0 0 2px #24308a33"}),e.jsx("input",{placeholder:"Filter by Event Type",value:m,onChange:k=>j(k.target.value),style:{borderRadius:4,padding:4,outline:"none",boxShadow:"0 0 0 2px #24308a33",transition:"box-shadow 0.2s"},"aria-label":"Filter by Event Type",tabIndex:0,onFocus:k=>k.currentTarget.style.boxShadow="0 0 0 3px #24308a",onBlur:k=>k.currentTarget.style.boxShadow="0 0 0 2px #24308a33"})]}),i?e.jsx("div",{children:"Loading..."}):x?e.jsx("div",{style:{color:"#ff4d4f"},children:x}):e.jsxs("table",{style:{width:"100%",background:"#333",borderRadius:8},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{background:"#444"},children:[e.jsx("th",{style:{color:"#ffe259"},children:"Time"}),e.jsx("th",{style:{color:"#ffe259"},children:"User ID"}),e.jsx("th",{style:{color:"#ffe259"},children:"Event"}),e.jsx("th",{style:{color:"#ffe259"},children:"Details"})]})}),e.jsx("tbody",{children:A.map(k=>{var L;return e.jsxs("tr",{children:[e.jsx("td",{children:(L=k.created_at)==null?void 0:L.replace("T"," ").slice(0,19)}),e.jsx("td",{children:k.userid}),e.jsx("td",{children:k.event}),e.jsx("td",{children:e.jsx("pre",{style:{color:"#00ff99",fontSize:12,margin:0},children:JSON.stringify(k.details,null,2)})})]},k.created_at+k.userid+k.event)})})]})]})},er="_trophiesPage_1ws34_2",tr="_trophiesTitle_1ws34_8",nr="_trophyList_1ws34_12",sr="_trophyCard_1ws34_17",or="_trophyIcon_1ws34_22",ar="_trophyName_1ws34_27",rr="_trophyDesc_1ws34_30",ir="_trophyReward_1ws34_30",lr="_earned_1ws34_73",Ie={trophiesPage:er,trophiesTitle:tr,trophyList:nr,trophyCard:sr,trophyIcon:or,trophyName:ar,trophyDesc:rr,trophyReward:ir,earned:lr},cs=[{key:"firstTap",name:"First Tap!",desc:"Earn your first coin.",icon:ve,milestone:1,reward:100},{key:"hundredCoins",name:"Coin Collector",desc:"Reach 100 coins.",icon:Yt,milestone:100,reward:500},{key:"thousandCoins",name:"Thousand Club",desc:"Reach 1,000 coins.",icon:Ne,milestone:1e3,reward:2e3},{key:"tenKCoins",name:"10K Master",desc:"Reach 10,000 coins.",icon:qe,milestone:1e4,reward:1e4},{key:"fiftyKCoins",name:"50K Tycoon",desc:"Reach 50,000 coins.",icon:dn,milestone:5e4,reward:25e3},{key:"hundredKCoins",name:"100K Legend",desc:"Reach 100,000 coins.",icon:we,milestone:1e5,reward:5e4},{key:"millionCoins",name:"Millionaire",desc:"Reach 1,000,000 coins.",icon:un,milestone:1e6,reward:2e5},{key:"energyMax",name:"Energy Hoarder",desc:"Max out your energy.",icon:bn,milestone:1e3,reward:1e4},{key:"shopper",name:"Shopper",desc:"Buy 5 shop items.",icon:Ht,milestone:5,reward:15e3},{key:"allTrophies",name:"Trophy Champion",desc:"Unlock all trophies.",icon:Sn,milestone:10,reward:1e5}],cr=({coinCount:s,energy:o,shopPurchases:i,earned:f,onEarn:x})=>{const I={firstTap:"First coin",hundredCoins:"100 coins",thousandCoins:"1K coins",tenKCoins:"10K coins",fiftyKCoins:"50K",hundredKCoins:"100K",millionCoins:"1M",energyMax:"Max energy",shopper:"5 buys",allTrophies:"All done"};return lo.useEffect(()=>{cs.forEach(c=>{if(!f[c.key]){let v=!1;c.key==="firstTap"&&s>=c.milestone&&(v=!0),c.key==="hundredCoins"&&s>=c.milestone&&(v=!0),c.key==="thousandCoins"&&s>=c.milestone&&(v=!0),c.key==="tenKCoins"&&s>=c.milestone&&(v=!0),c.key==="fiftyKCoins"&&s>=c.milestone&&(v=!0),c.key==="hundredKCoins"&&s>=c.milestone&&(v=!0),c.key==="millionCoins"&&s>=c.milestone&&(v=!0),c.key==="energyMax"&&o>=c.milestone&&(v=!0),c.key==="shopper"&&i>=c.milestone&&(v=!0),c.key==="allTrophies"&&Object.values(f).filter(Boolean).length>=9&&(v=!0),v&&x(c)}})},[s,o,i,f,x]),e.jsxs("div",{className:Ie.trophiesPage,children:[e.jsx("div",{className:Ie.trophiesTitle,children:"Trophies"}),e.jsx("div",{className:Ie.trophyList,children:cs.map(c=>e.jsxs("div",{className:Ie.trophyCard+(f[c.key]?" "+Ie.earned:""),children:[e.jsx("img",{src:c.icon,alt:c.name,className:Ie.trophyIcon}),e.jsx("div",{className:Ie.trophyName,children:c.name}),e.jsx("div",{className:Ie.trophyDesc,children:I[c.key]||c.desc}),e.jsxs("div",{className:Ie.trophyReward,children:["+",c.reward]}),f[c.key]&&e.jsx("div",{style:{color:"#1bbf4c",fontWeight:700,fontSize:10},children:"Unlocked!"})]},c.key))})]})},fr="_tasksPage_4akxz_2",dr="_dailyCheckInBtn_4akxz_8",ur="_taskCard_4akxz_14",hr="_taskHeader_4akxz_20",xr="_taskTitle_4akxz_23",gr="_taskReward_4akxz_26",pr="_taskDesc_4akxz_29",yr="_taskLink_4akxz_32",mr="_completeBtn_4akxz_36",Sr="_dailyCheckInContainer_4akxz_526",br="_tasksTitle_4akxz_557",vr="_tasksList_4akxz_565",wr="_completed_4akxz_597",kr="_taskActions_4akxz_630",ne={tasksPage:fr,dailyCheckInBtn:dr,taskCard:ur,taskHeader:hr,taskTitle:xr,taskReward:gr,taskDesc:pr,taskLink:yr,completeBtn:mr,dailyCheckInContainer:Sr,tasksTitle:br,tasksList:vr,completed:wr,taskActions:kr},Ar="/assets/twitter-Cxj2oo1j.png",jr="/assets/friends-CUSeA5LR.png",Er=[{id:1,title:"Follow on X",desc:"Follow us on X.",reward:5e5,link:"https://x.com/",icon:Ar},{id:2,title:"Instagram",desc:"Like & follow.",reward:5e5,link:"https://instagram.com/",icon:qe},{id:3,title:"Play TG Game",desc:"Play our game.",reward:75e4,link:"https://t.me/LisaToken_bot?game=Lisa",icon:es},{id:4,title:"Join Channel",desc:"Join Telegram.",reward:5e5,link:"https://t.me/LisaToken_bot?game=Lisa",icon:jt},{id:5,title:"Invite Friend",desc:"Invite a friend.",reward:1e6,link:"",icon:jr}],Ir=({tasks:s})=>{const[o,i]=t.useState({}),[f,x]=t.useState(!1),[I,c]=t.useState(!1),[v,m]=t.useState("idle"),[j,A]=t.useState(""),[k]=xn(),L=Qn(),[B,_]=t.useState(0),[w,D]=t.useState(null),[n,p]=t.useState(0),u=7;t.useEffect(()=>{const b=parseInt(localStorage.getItem("dailyStreak")||"0",10),d=parseInt(localStorage.getItem("lastCheckIn")||"0",10),T=parseInt(localStorage.getItem("weeklyProgress")||"0",10);_(b),D(d||null),p(T)},[]);const N=async()=>{c(!0),m("idle"),A("");try{await k.sendTransaction({validUntil:Math.floor(Date.now()/1e3)+360,messages:[{address:vn,amount:(.5*1e9).toString()}]}),x(!0),m("success"),A("âœ… Daily check-in successful! +1,000,000 coins awarded.");const d=Math.floor(new Date().getTime()/(1e3*60*60*24));let T=B;w&&d-w===1?T=B+1:(!w||d-w>1)&&(T=1),_(T),D(d),localStorage.setItem("dailyStreak",T.toString()),localStorage.setItem("lastCheckIn",d.toString());let h=n+1;h>u&&(h=1),p(h),localStorage.setItem("weeklyProgress",h.toString());const y=localStorage.getItem("userId")||"unknown";await Le(y,"daily_checkin",{amountTon:.5,reward:1e6})}catch(b){let d="Transaction cancelled or failed.";typeof b=="object"&&b&&"message"in b&&typeof b.message=="string"&&(d+=`
${b.message}`),m("error"),A(d)}c(!1)},R=b=>{i(d=>({...d,[b]:!0}))},M=s??Er;return e.jsxs("div",{className:ne.tasksPage,children:[e.jsxs("div",{className:ne.dailyCheckInContainer,children:[e.jsx("div",{style:{color:"#000",fontWeight:600,marginBottom:4},children:"Daily Check-In"}),e.jsxs("div",{style:{fontSize:13,color:"#888",marginBottom:4},children:[e.jsx("b",{children:"Streak:"})," ",B," days"]}),e.jsxs("div",{style:{fontSize:13,color:"#888",marginBottom:8},children:[e.jsx("b",{children:"Weekly Quest:"})," ",n," / ",u," check-ins",n===u&&e.jsx("span",{style:{color:"#1bbf4c",fontWeight:700,marginLeft:8},children:"ðŸŽ‰ Weekly Reward!"})]}),L?e.jsx("button",{className:ne.dailyCheckInBtn,onClick:N,disabled:f||I,children:I?"Processing...":f?"Checked In Today":"Daily Check-In (0.5 TON â†’ 1,000,000 coins)"}):e.jsx(gn,{}),j&&e.jsx("div",{style:{marginTop:8,color:v==="success"?"#00b894":v==="error"?"#d63031":"#222",fontWeight:600,minHeight:20,animation:v==="success"?"popSuccess 0.5s":v==="error"?"popError 0.5s":void 0,transition:"color 0.2s"},children:j}),e.jsx("style",{children:`
							@keyframes popSuccess {
								0% { transform: scale(1); }
								50% { transform: scale(1.15); }
								100% { transform: scale(1); }
							}
							@keyframes popError {
								0% { transform: scale(1); }
								50% { transform: scale(1.1); }
								100% { transform: scale(1); }
							}
						`})]}),e.jsx("div",{className:ne.tasksTitle,children:"Telegram & Social Tasks"}),e.jsx("div",{className:ne.tasksList,children:M.map(b=>e.jsxs("div",{className:ne.taskCard+(o[b.id]?" "+ne.completed:""),children:[e.jsxs("div",{className:ne.taskHeader,children:[b.icon&&e.jsx("img",{src:b.icon,alt:b.title,style:{width:22,marginRight:6,verticalAlign:"middle"}}),e.jsx("span",{className:ne.taskTitle,children:b.title}),e.jsxs("span",{className:ne.taskReward,children:["+",b.reward.toLocaleString()," coins"]})]}),e.jsx("div",{className:ne.taskDesc,children:b.desc}),e.jsxs("div",{className:ne.taskActions,children:[b.link&&e.jsx("a",{href:b.link,target:"_blank",rel:"noopener noreferrer",className:ne.taskLink,children:"Go"}),e.jsx("button",{className:ne.completeBtn,onClick:()=>R(b.id),disabled:o[b.id],"aria-label":o[b.id]?`Task ${b.title} completed`:`Mark task ${b.title} as done`,tabIndex:0,onKeyDown:d=>{(d.key==="Enter"||d.key===" ")&&R(b.id)},onFocus:d=>d.currentTarget.style.boxShadow="0 0 0 3px #24308a",onBlur:d=>d.currentTarget.style.boxShadow="none",children:o[b.id]?"Completed":"Mark as Done"})]})]},b.id))})]})},Tr="_upgradesPage_iq4s3_2",Mr="_upgradeGrid_iq4s3_8",Rr="_upgradeCard_iq4s3_12",Cr="_icon_iq4s3_17",Br="_title_iq4s3_22",Nr="_desc_iq4s3_25",Pr="_level_iq4s3_28",Lr="_value_iq4s3_28",Dr="_price_iq4s3_28",_r="_buyBtn_iq4s3_31",ce={upgradesPage:Tr,upgradeGrid:Mr,upgradeCard:Rr,icon:Cr,title:Br,desc:Nr,level:Pr,value:Lr,price:Dr,buyBtn:_r},Wr=[{key:"coinPerTap",name:"Coin Per Tap",desc:"+Coins/tap",baseValue:2,basePrice:400,icon:ve},{key:"passiveIncome",name:"Passive Income",desc:"+Coins/hr",baseValue:100,basePrice:500,icon:Yt},{key:"energy",name:"Energy",desc:"+Max energy",baseValue:100,basePrice:300,icon:Ne},{key:"hungerDrive",name:"Hunger Drive",desc:"+Passive/hr",baseValue:500,basePrice:500,icon:qe},{key:"energyRegen",name:"Energy Regen",desc:"+Energy regen",baseValue:1,basePrice:350,icon:dn},{key:"tapStreak",name:"Tap Streak",desc:"Streak bonus",baseValue:10,basePrice:600,icon:we},{key:"criticalTap",name:"Critical Tap",desc:"Crit chance",baseValue:1,basePrice:700,icon:un},{key:"autoMiner",name:"Auto Miner",desc:"Auto/hr",baseValue:50,basePrice:800,icon:dn},{key:"energySaver",name:"Energy Saver",desc:"-Energy/tap",baseValue:1,basePrice:900,icon:bn},{key:"magnet",name:"Coin Magnet",desc:"Bonus/hr",baseValue:100,basePrice:1e3,icon:Ht},{key:"ultraBoost",name:"Ultra Boost",desc:"x2 1hr",baseValue:1,basePrice:2e3,icon:Sn},{key:"goldenTouch",name:"Golden Touch",desc:"+10/tap",baseValue:10,basePrice:2500,icon:un}],Vt=5e3,zr=({upgrades:s,coins:o,onPurchase:i})=>e.jsxs("div",{className:ce.upgradesPage,children:[e.jsx("h2",{children:"Upgrades"}),e.jsx("div",{className:ce.upgradeGrid,children:Wr.map(f=>{const x=s[f.key]||0,I=f.basePrice*Math.pow(2,x),c=f.baseValue*Math.pow(2,x);return e.jsxs("div",{className:ce.upgradeCard,children:[e.jsx("img",{src:f.icon,alt:f.name,className:ce.icon}),e.jsx("div",{className:ce.title,children:f.name}),e.jsx("div",{className:ce.desc,children:f.desc}),e.jsxs("div",{className:ce.level,children:["Level: ",x]}),e.jsxs("div",{className:ce.value,children:["Value: +",c]}),e.jsxs("div",{className:ce.price,children:["Price: ",I," coins"]}),e.jsx("button",{className:ce.buyBtn,disabled:o<I||x>=Vt,onClick:()=>i(f.key),"aria-label":x>=Vt?`${f.name} maxed out`:`Upgrade ${f.name} for ${I} coins`,tabIndex:0,onKeyDown:v=>{(v.key==="Enter"||v.key===" ")&&!(o<I||x>=Vt)&&i(f.key)},onFocus:v=>v.currentTarget.style.boxShadow="0 0 0 3px #24308a",onBlur:v=>v.currentTarget.style.boxShadow="none",children:x>=Vt?"Maxed":"Upgrade"})]},f.key)})})]}),Or=({friends:s=[]})=>{const[o,i]=t.useState(()=>{try{return JSON.parse(localStorage.getItem("friends")||"[]")}catch{return s}}),[f,x]=t.useState(""),[I,c]=t.useState(""),[v,m]=t.useState(""),[j,A]=t.useState(null),[k,L]=t.useState(""),[B,_]=t.useState(()=>{try{return JSON.parse(localStorage.getItem("chatHistory")||"{}")}catch{return{}}}),[w,D]=t.useState(()=>{try{return JSON.parse(localStorage.getItem("guild")||"null")}catch{return null}}),[n,p]=t.useState("");t.useEffect(()=>{localStorage.setItem("friends",JSON.stringify(o))},[o]),t.useEffect(()=>{w&&localStorage.setItem("guild",JSON.stringify(w))},[w]),t.useEffect(()=>{localStorage.setItem("chatHistory",JSON.stringify(B))},[B]);const u=()=>{if(!f||!I){m("Enter both user ID and name.");return}if(o.some(d=>d.id===f)){m("Already added.");return}i(d=>[...d,{id:f,name:I}]),x(""),c(""),m("Friend added!"),setTimeout(()=>m(""),1200)},N=d=>{A(d)},R=()=>{if(!j||!k.trim())return;const T={sender:localStorage.getItem("userId")||"You",text:k,timestamp:Date.now()};_(h=>({...h,[j.id]:[...h[j.id]||[],T]})),L("")},M=()=>{if(!n.trim())return;const d=localStorage.getItem("userId")||"You",T=localStorage.getItem("userName")||"You";D({name:n.trim(),members:[{id:d,name:T}]}),p("")},b=()=>{if(!n.trim())return;const d=localStorage.getItem("userId")||"You",T=localStorage.getItem("userName")||"You";let h=null;try{h=JSON.parse(localStorage.getItem("guild")||"null")}catch{h=null}h&&h.name===n.trim()?(h.members.some(y=>y.id===d)||h.members.push({id:d,name:T}),D({...h})):D({name:n.trim(),members:[{id:d,name:T}]}),p("")};return e.jsxs("div",{style:{maxWidth:340,margin:"20px auto",padding:12,background:"linear-gradient(135deg, #f8fafc 0%, #e0e7ff 100%)",borderRadius:12,boxShadow:"0 2px 12px #24308a11"},children:[e.jsxs("div",{style:{margin:"18px 0",padding:10,background:"#f0f7ff",borderRadius:8,boxShadow:"0 1px 4px #24308a10"},children:[e.jsx("div",{style:{fontWeight:700,fontSize:13,marginBottom:6},children:"Guild / Team"}),w?e.jsxs("div",{children:[e.jsxs("div",{style:{fontSize:11,marginBottom:4},children:[e.jsx("b",{children:"Guild:"})," ",w.name]}),e.jsx("div",{style:{fontSize:10,marginBottom:4},children:e.jsx("b",{children:"Members:"})}),e.jsx("ul",{style:{fontSize:10,margin:0,padding:0,listStyle:"none"},children:w.members.map((d,T)=>e.jsxs("li",{style:{marginBottom:2},children:[d.name," ",e.jsxs("span",{style:{color:"#888",fontSize:9},children:["(",d.id,")"]})]},d.id+T))})]}):e.jsxs("div",{style:{display:"flex",gap:4,alignItems:"center"},children:[e.jsx("input",{value:n,onChange:d=>p(d.target.value),placeholder:"Guild name",style:{fontSize:10,borderRadius:4,padding:2,width:90}}),e.jsx("button",{onClick:M,style:{fontSize:10,borderRadius:4,padding:"2px 8px",background:"#ffe259",fontWeight:700},children:"Create"}),e.jsx("button",{onClick:b,style:{fontSize:10,borderRadius:4,padding:"2px 8px",background:"#b8e259",fontWeight:700},children:"Join"})]})]}),e.jsx("div",{style:{fontSize:12,fontWeight:700,marginBottom:6},children:"Your Friends"}),e.jsxs("div",{style:{marginBottom:10},children:[e.jsx("input",{value:f,onChange:d=>x(d.target.value),placeholder:"User ID",style:{fontSize:10,borderRadius:4,padding:2,marginRight:4,width:70}}),e.jsx("input",{value:I,onChange:d=>c(d.target.value),placeholder:"Name",style:{fontSize:10,borderRadius:4,padding:2,marginRight:4,width:70}}),e.jsx("button",{onClick:u,style:{fontSize:10,borderRadius:4,padding:"2px 8px",background:"#ffe259",fontWeight:700},children:"Add Friend"}),v&&e.jsx("span",{style:{fontSize:10,color:"#1bbf4c",marginLeft:8},children:v})]}),e.jsxs("ul",{style:{listStyle:"none",padding:0,margin:0},children:[o.length===0&&e.jsx("li",{style:{fontSize:10,color:"#888"},children:"No friends yet. Invite some!"}),o.map(d=>e.jsx("li",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:6,background:(j==null?void 0:j.id)===d.id?"#e6f7ff":"#fff",borderRadius:6,padding:"4px 8px",boxShadow:"0 1px 2px #24308a08",fontSize:10,cursor:"pointer"},children:e.jsxs("span",{style:{flex:1},onClick:()=>N(d),children:[d.name," ",e.jsxs("span",{style:{color:"#888",fontSize:9},children:["(",d.id,")"]})]})},d.id))]}),j&&e.jsxs("div",{style:{marginTop:16,background:"#f7faff",borderRadius:8,padding:10,boxShadow:"0 1px 4px #24308a10"},children:[e.jsxs("div",{style:{fontWeight:700,fontSize:12,marginBottom:6},children:["Chat with ",j.name,e.jsx("button",{style:{float:"right",fontSize:10,border:"none",background:"none",color:"#888",cursor:"pointer"},onClick:()=>A(null),children:"Ã—"})]}),e.jsxs("div",{style:{maxHeight:120,overflowY:"auto",background:"#fff",borderRadius:6,padding:6,marginBottom:8,fontSize:10},children:[(B[j.id]||[]).length===0&&e.jsx("div",{style:{color:"#aaa"},children:"No messages yet."}),(B[j.id]||[]).map((d,T)=>e.jsxs("div",{style:{marginBottom:4,textAlign:d.sender===(localStorage.getItem("userId")||"You")?"right":"left"},children:[e.jsxs("span",{style:{background:d.sender===(localStorage.getItem("userId")||"You")?"#e6f7ff":"#ffe259",borderRadius:4,padding:"2px 6px",display:"inline-block"},children:[e.jsxs("b",{children:[d.sender===(localStorage.getItem("userId")||"You")?"You":j.name,":"]})," ",d.text.startsWith(":sticker:")?e.jsx("img",{src:d.text.replace(":sticker:",""),alt:"sticker",style:{height:24,verticalAlign:"middle"}}):d.text]}),e.jsx("span",{style:{color:"#bbb",fontSize:8,marginLeft:4},children:new Date(d.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]},T))]}),e.jsxs("div",{style:{display:"flex",gap:4,marginBottom:4},children:[e.jsx("div",{style:{display:"flex",gap:2},children:["ðŸ˜€","ðŸ˜‚","ðŸ˜","ðŸ˜Ž","ðŸ¥³","ðŸ˜‡","ðŸ˜œ","ðŸ¤©","ðŸ˜­","ðŸ”¥","ðŸ’Ž","ðŸŽ‰"].map(d=>e.jsx("button",{style:{fontSize:14,border:"none",background:"none",cursor:"pointer"},onClick:()=>L(k+d),children:d},d))}),e.jsxs("div",{style:{display:"flex",gap:2,marginLeft:8},children:[e.jsx("button",{style:{border:"none",background:"none",cursor:"pointer"},onClick:()=>L(":sticker:"+qe),children:e.jsx("img",{src:qe,alt:"gift",style:{height:22}})}),e.jsx("button",{style:{border:"none",background:"none",cursor:"pointer"},onClick:()=>L(":sticker:"+we),children:e.jsx("img",{src:we,alt:"crown",style:{height:22}})}),e.jsx("button",{style:{border:"none",background:"none",cursor:"pointer"},onClick:()=>L(":sticker:"+jt),children:e.jsx("img",{src:jt,alt:"tg",style:{height:22}})})]})]}),e.jsxs("div",{style:{display:"flex",gap:4},children:[e.jsx("input",{value:k,onChange:d=>L(d.target.value),onKeyDown:d=>{d.key==="Enter"&&R()},placeholder:"Type a message...",style:{flex:1,fontSize:10,borderRadius:4,padding:4}}),e.jsx("button",{onClick:R,style:{fontSize:10,borderRadius:4,padding:"2px 10px",background:"#ffe259",fontWeight:700},children:"Send"})]})]})]})};async function uo(s,o,i){const{data:f,error:x}=await Q.storage.from(s).upload(o,i,{cacheControl:"3600",upsert:!0});return{data:f,error:x}}function Ur(s,o){const{data:i}=Q.storage.from(s).getPublicUrl(o);return i.publicUrl}const Gr=["/vite.svg","/assets/crown.png","/assets/tg.png","/assets/arcade_pacman_sprites.png","/assets/gift.png","/assets/axs.png"],Hr=({isOpen:s,onClose:o,onAvatarChange:i})=>{const f=t.useRef(null),[x,I]=t.useState(null),c=async j=>{var k;const A=(k=j.target.files)==null?void 0:k[0];if(A){const L=localStorage.getItem("userId")||"anon",B=A.name.split(".").pop()||"png",_=`avatars/${L}_${Date.now()}.${B}`,{error:w}=await uo("avatars",_,A);if(w)alert("Failed to upload avatar.");else{const D=Ur("avatars",_);I(D)}}},v=j=>{I(j)},m=()=>{x&&(i(x),o())};return s?e.jsx("div",{className:X.modalOverlay,children:e.jsxs("div",{className:X.modalContent,children:[e.jsx("h3",{children:"Select or Upload Avatar"}),e.jsx("div",{className:X.avatarGrid,children:Gr.map(j=>e.jsx("img",{src:j,alt:"avatar",className:X.avatarOption+(x===j?" "+X.selected:""),onClick:()=>v(j),style:{width:56,height:56,borderRadius:"50%",margin:8,cursor:"pointer",border:x===j?"2px solid #ffe259":"2px solid #eee"}},j))}),e.jsx("input",{type:"file",accept:"image/*",ref:f,onChange:c,style:{margin:"12px 0"}}),x&&e.jsx("img",{src:x,alt:"Selected avatar",style:{width:64,height:64,borderRadius:"50%",margin:8}}),e.jsxs("div",{style:{marginTop:12},children:[e.jsx("button",{onClick:m,style:{background:"#ffe259",borderRadius:6,padding:"6px 18px",fontWeight:700,marginRight:8},children:"Save"}),e.jsx("button",{onClick:o,style:{background:"#eee",borderRadius:6,padding:"6px 18px",fontWeight:700},children:"Cancel"})]})]})}):null},fs=[{src:"/vite.svg",label:"Default"},{src:jt,label:"Telegram",link:"https://t.me/LisaToken_bot?game=Lisa"},{src:we,label:"Crown"},{src:qe,label:"Gift"},{src:bn,label:"AXS"},{src:ts,label:"Airdrop"}],ds=[{label:"Early Bird",icon:we},{label:"Top Referrer",icon:jt},{label:"Arcade Champ",icon:At},{label:"Airdrop Winner",icon:ts}],Yr=({userId:s})=>{var D;const[o,i]=t.useState(null),[f,x]=t.useState(!0),[I,c]=t.useState(!1),[v,m]=t.useState(""),[j,A]=t.useState(""),[k,L]=t.useState([]),[B,_]=t.useState(!1);t.useEffect(()=>{$n(s).then(n=>{i(n),m((n==null?void 0:n.nickname)||""),A((n==null?void 0:n.avatar_url)||fs[0].src),L((n==null?void 0:n.badges)||[]),x(!1)})},[s]);const w=async()=>{x(!0),await Pa(s,{nickname:v,avatar_url:j,badges:k}),c(!1),x(!1)};return f?e.jsx("div",{children:"Loading profile..."}):o?e.jsxs("div",{style:{maxWidth:340,margin:"24px auto",background:"#f8fafc",borderRadius:12,padding:16,boxShadow:"0 2px 8px #24308a11"},children:[e.jsx("h2",{style:{color:"#24308a",fontWeight:800,fontSize:16,marginBottom:12},children:"Your Profile"}),e.jsxs("div",{style:{textAlign:"center",marginBottom:12},children:[e.jsx("img",{src:j,alt:"avatar",style:{width:64,height:64,borderRadius:"50%",border:"2px solid #ffe259"}}),e.jsx("button",{onClick:()=>_(!0),style:{marginTop:8,background:"#ffe259",borderRadius:6,padding:"4px 14px",fontWeight:700},children:"Change Avatar"})]}),e.jsx(Hr,{isOpen:B,onClose:()=>_(!1),onAvatarChange:n=>A(n)}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6,marginBottom:10},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,fontSize:14},children:[e.jsx("img",{src:Ht,alt:"Coins",style:{width:18,verticalAlign:"middle"}}),e.jsx("b",{children:"Coins:"})," ",e.jsx("span",{style:{color:"#b88a00",fontWeight:700},children:((D=o.coins)==null?void 0:D.toLocaleString())??0})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,fontSize:13},children:[e.jsx("b",{children:"Country:"})," ",e.jsx("span",{children:o.country||"(unknown)"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,fontSize:12,color:"#888"},children:[e.jsx("b",{children:"User ID:"})," ",e.jsx("span",{style:{fontFamily:"monospace"},children:o.userid})]})]}),I?e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginBottom:8},children:e.jsxs("label",{children:["Nickname: ",e.jsx("input",{value:v,onChange:n=>m(n.target.value),style:{borderRadius:4,padding:4}})]})}),e.jsxs("div",{style:{marginBottom:8},children:[e.jsx("label",{children:"Avatar: "}),e.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap",marginTop:4},children:fs.map(n=>e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",cursor:"pointer"},onClick:()=>A(n.src),children:[e.jsx("img",{src:n.src,alt:n.label,style:{width:38,height:38,borderRadius:"50%",border:j===n.src?"2px solid #24308a":"2px solid #ffe259",marginBottom:2,background:"#fff"}}),e.jsx("span",{style:{fontSize:10},children:n.label})]},n.src))})]}),e.jsxs("div",{style:{marginBottom:8},children:[e.jsx("label",{children:"Badges: "}),e.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap",marginTop:4},children:ds.map(n=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[e.jsx("input",{type:"checkbox",checked:k.includes(n.label),onChange:p=>{p.target.checked?L([...k,n.label]):L(k.filter(u=>u!==n.label))}}),e.jsx("img",{src:n.icon,alt:n.label,style:{width:16,verticalAlign:"middle"}}),e.jsx("span",{style:{fontSize:11},children:n.label})]},n.label))})]}),e.jsx("button",{onClick:w,style:{background:"#ffe259",borderRadius:6,padding:"4px 16px",fontWeight:700},children:"Save"}),e.jsx("button",{onClick:()=>c(!1),style:{marginLeft:8,borderRadius:6,padding:"4px 16px"},children:"Cancel"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{marginBottom:8},children:[e.jsx("b",{children:"Nickname:"})," ",o.nickname||"(none)"]}),e.jsxs("div",{style:{marginBottom:8,display:"flex",alignItems:"center",gap:8},children:[e.jsx("b",{children:"Badges:"})," ",o.badges&&o.badges.length?o.badges.map(n=>{const p=ds.find(u=>u.label===n);return p?e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:2,background:"#fffbe6",borderRadius:4,padding:"2px 6px",fontSize:11,border:"1px solid #ffe259"},children:[e.jsx("img",{src:p.icon,alt:p.label,style:{width:14,verticalAlign:"middle"}}),p.label]},n):n}):e.jsx("span",{style:{fontSize:11},children:"(none)"})]}),e.jsx("button",{onClick:()=>c(!0),style:{background:"#ffe259",borderRadius:6,padding:"4px 16px",fontWeight:700},children:"Edit Profile"})]})]}):e.jsx("div",{children:"Profile not found."})};async function us(s=50,o="chat"){const{data:i}=await Q.from("messages").select("*").eq("type",o).order("created_at",{ascending:!1}).limit(s);return i||[]}const Fr=({userId:s})=>{const[o,i]=t.useState([]),[f,x]=t.useState(""),[I,c]=t.useState(!0),[v,m]=t.useState(!1),[j,A]=t.useState({}),k=t.useRef(null);t.useEffect(()=>{const B=async()=>{c(!0);const w=await us(50,"chat");i(w.reverse()),c(!1);const D=Array.from(new Set(w.map(p=>p.userid))),n={};await Promise.all(D.map(async p=>{const u=await $n(p);u&&(n[p]={nickname:u.nickname,avatar_url:u.avatar_url})})),A(n)};B();const _=setInterval(B,4e3);return()=>clearInterval(_)},[]),t.useEffect(()=>{var B;(B=k.current)==null||B.scrollIntoView({behavior:"smooth"})},[o]);const L=async()=>{if(!f.trim())return;m(!0),await ya({userId:s,message:f.trim()}),x(""),m(!1);const B=await us(50,"chat");i(B.reverse())};return e.jsxs("div",{style:{maxWidth:400,margin:"24px auto",background:"#f8fafc",borderRadius:12,padding:12,boxShadow:"0 2px 8px #24308a11",display:"flex",flexDirection:"column",height:420},children:[e.jsxs("h3",{style:{color:"#24308a",fontWeight:800,fontSize:16,marginBottom:8,display:"flex",alignItems:"center",gap:8},children:[e.jsx("img",{src:yn,alt:"Chat",style:{width:22,verticalAlign:"middle"}}),"Community Chat"]}),e.jsxs("div",{style:{flex:1,overflowY:"auto",marginBottom:8,background:"#fff",borderRadius:8,padding:8,border:"1px solid #eee"},children:[I?e.jsx("div",{children:"Loading..."}):o.length===0?e.jsx("div",{style:{color:"#888"},children:"No messages yet."}):o.map(B=>{var _,w,D;return e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:6},children:[e.jsx("img",{src:((_=j[B.userid])==null?void 0:_.avatar_url)||"/vite.svg",alt:"avatar",style:{width:28,height:28,borderRadius:"50%",marginRight:8,border:"1px solid #ffe259"}}),e.jsxs("div",{children:[e.jsx("span",{style:{fontWeight:700,color:"#24308a",fontSize:12},children:((w=j[B.userid])==null?void 0:w.nickname)||B.userid}),e.jsx("span",{style:{color:"#888",fontSize:10,marginLeft:8},children:(D=B.created_at)==null?void 0:D.slice(11,16)}),e.jsx("div",{style:{fontSize:13},children:B.content})]})]},B.id)}),e.jsx("div",{ref:k})]}),e.jsxs("div",{style:{display:"flex",gap:8},children:[e.jsx("input",{value:f,onChange:B=>x(B.target.value),onKeyDown:B=>{B.key==="Enter"&&L()},placeholder:"Type a message...",style:{flex:1,borderRadius:6,padding:6,border:"1px solid #ffe259"},disabled:v}),e.jsx("button",{onClick:L,disabled:v||!f.trim(),style:{background:"#ffe259",borderRadius:6,padding:"4px 16px",fontWeight:700},children:"Send"})]})]})};async function Vr(s=new Date().toISOString()){const{data:o}=await Q.from("events").select("*").lte("start_time",s).gte("end_time",s).order("start_time",{ascending:!0});return o||[]}async function Kr(s,o){await Q.from("event_participants").upsert([{event_id:s,userid:o}],{onConflict:"event_id,userid"})}const qr=({userId:s})=>{const[o,i]=t.useState([]),[f,x]=t.useState(!0),[I,c]=t.useState({});t.useEffect(()=>{Vr().then(m=>{i(m),x(!1)})},[]);const v=async m=>{await Kr(m,s),c(j=>({...j,[m]:!0}))};return e.jsxs("div",{style:{maxWidth:400,margin:"24px auto",background:"#f8fafc",borderRadius:12,padding:16,boxShadow:"0 2px 8px #24308a11"},children:[e.jsx("h3",{style:{color:"#24308a",fontWeight:800,fontSize:16,marginBottom:12},children:"Seasonal Events & Challenges"}),f?e.jsx("div",{children:"Loading events..."}):o.length===0?e.jsx("div",{style:{color:"#888"},children:"No active events right now."}):o.map(m=>{var j;return e.jsxs("div",{style:{background:"#fff",borderRadius:8,marginBottom:12,padding:12,boxShadow:"0 1px 4px #24308a08"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("img",{src:At,alt:"Trophy",style:{width:22,verticalAlign:"middle"}}),e.jsx("span",{style:{fontWeight:700,color:"#b88a00",fontSize:15},children:m.name})]}),e.jsx("div",{style:{fontSize:12,marginBottom:6},children:m.description}),e.jsxs("div",{style:{fontSize:11,color:"#888",marginBottom:6,display:"flex",alignItems:"center",gap:4},children:[e.jsx("img",{src:yn,alt:"End",style:{width:14,verticalAlign:"middle"}}),"Ends: ",(j=m.end_time)==null?void 0:j.slice(0,16).replace("T"," ")]}),I[m.id]?e.jsx("span",{style:{color:"#24308a",fontWeight:700},children:"In Progress"}):e.jsx("button",{onClick:()=>v(m.id),style:{background:"#ffe259",borderRadius:6,padding:"4px 16px",fontWeight:700},children:"Join"})]},m.id)})]})},ho=({userId:s})=>{const[o,i]=t.useState([]),[f,x]=t.useState(!0),[I,c]=t.useState(!1),[v,m]=t.useState(""),[j,A]=t.useState(""),[k,L]=t.useState(""),[B,_]=t.useState(null),w=t.useRef(null);t.useEffect(()=>{wa(s).then(n=>{i(n),x(!1)})},[s,I]);const D=async()=>{if(!(!v||!j&&!B)){if(c(!0),B){const n=B.name.split(".").pop()||"png",p=`nfts/${s}_${Date.now()}.${n}`,{error:u}=await uo("nfts",p,B);if(u){alert("Failed to upload NFT image."),c(!1);return}}await ma({userId:s,nftType:v}),m(""),A(""),L(""),_(null),w.current&&(w.current.value=""),c(!1)}};return e.jsxs("div",{style:{maxWidth:400,margin:"24px auto",background:"#f8fafc",borderRadius:12,padding:16,boxShadow:"0 2px 8px #24308a11"},children:[e.jsx("h3",{style:{color:"#24308a",fontWeight:800,fontSize:16,marginBottom:12},children:"Your NFTs"}),f?e.jsx("div",{children:"Loading NFTs..."}):o.length===0?e.jsx("div",{style:{color:"#888"},children:"No NFTs yet."}):e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:12},children:o.map(n=>e.jsxs("div",{style:{background:"#fff",borderRadius:8,padding:8,width:120,boxShadow:"0 1px 4px #24308a08"},children:[e.jsx("img",{src:n.image_url,alt:n.name,style:{width:100,height:100,borderRadius:8,objectFit:"cover",marginBottom:4}}),e.jsx("div",{style:{fontWeight:700,fontSize:13},children:n.name}),e.jsx("div",{style:{fontSize:11,color:"#888"},children:n.description})]},n.nft_id))}),e.jsxs("div",{style:{marginTop:16,borderTop:"1px solid #eee",paddingTop:12},children:[e.jsx("h4",{style:{fontSize:14,color:"#24308a",marginBottom:6},children:"Mint New NFT"}),e.jsx("input",{value:v,onChange:n=>m(n.target.value),placeholder:"Name",style:{borderRadius:4,padding:4,marginBottom:4,width:"100%"}}),e.jsx("input",{value:j,onChange:n=>A(n.target.value),placeholder:"Image URL (or upload below)",style:{borderRadius:4,padding:4,marginBottom:4,width:"100%"}}),e.jsx("input",{type:"file",accept:"image/*",ref:w,onChange:n=>{var p;return _(((p=n.target.files)==null?void 0:p[0])||null)},style:{marginBottom:4,width:"100%"}}),e.jsx("input",{value:k,onChange:n=>L(n.target.value),placeholder:"Description",style:{borderRadius:4,padding:4,marginBottom:4,width:"100%"}}),e.jsx("button",{onClick:D,disabled:I||!v||!j&&!B,style:{background:"#ffe259",borderRadius:6,padding:"4px 16px",fontWeight:700,width:"100%"},children:"Mint NFT"})]})]})};async function Xr(s){const{data:o}=await Q.from("analytics_events").select("details").eq("userid",s).eq("event","coin_earned"),i=(o==null?void 0:o.reduce((v,m)=>{var j;return v+(((j=m.details)==null?void 0:j.amount)||0)},0))||0,{count:f}=await Q.from("arcade_scores").select("id",{count:"exact",head:!0}).eq("userid",s),{count:x}=await Q.from("referrals").select("id",{count:"exact",head:!0}).eq("referrer_id",s),{count:I}=await Q.from("achievements").select("id",{count:"exact",head:!0}).eq("userid",s).eq("completed",!0),{count:c}=await Q.from("nfts").select("id",{count:"exact",head:!0}).eq("userid",s);return{totalCoins:i,gamesPlayed:f||0,referrals:x||0,achievements:I||0,nfts:c||0}}const Zr=({userId:s})=>{const[o,i]=t.useState(null),[f,x]=t.useState(!0);return t.useEffect(()=>{Xr(s).then(I=>{i(I),x(!1)})},[s]),f?e.jsx("div",{children:"Loading analytics..."}):o?e.jsxs("div",{style:{maxWidth:340,margin:"24px auto",background:"#f8fafc",borderRadius:12,padding:16,boxShadow:"0 2px 8px #24308a11"},children:[e.jsx("h3",{style:{color:"#24308a",fontWeight:800,fontSize:16,marginBottom:12},children:"Your Analytics"}),e.jsxs("div",{style:{fontSize:14,marginBottom:8},children:[e.jsx("b",{children:"Total Coins Earned:"})," ",o.totalCoins.toLocaleString()]}),e.jsxs("div",{style:{fontSize:14,marginBottom:8},children:[e.jsx("b",{children:"Games Played:"})," ",o.gamesPlayed]}),e.jsxs("div",{style:{fontSize:14,marginBottom:8},children:[e.jsx("b",{children:"Referrals:"})," ",o.referrals]}),e.jsxs("div",{style:{fontSize:14,marginBottom:8},children:[e.jsx("b",{children:"Achievements:"})," ",o.achievements]}),e.jsxs("div",{style:{fontSize:14,marginBottom:8},children:[e.jsx("b",{children:"NFTs Owned:"})," ",o.nfts]})]}):e.jsx("div",{children:"No analytics found."})},Qr="/assets/dollar-BVwGV8h8.png",Jr="/assets/mining-C0IUERmY.png",$r=[{key:"doubleCoins",name:"Double Coins",description:"Doubles all coins earned for 1 hour.",price:1e3,duration:60*60*1e3,icon:Qr},{key:"energyRefill",name:"Energy Refill",description:"Instantly refill your energy to max.",price:500,duration:0,icon:Ne},{key:"autoMiner",name:"Auto Miner",description:"Automatically mines coins for 1 hour.",price:2e3,duration:60*60*1e3,icon:Jr},{key:"passiveBoost",name:"Passive Boost",description:"Doubles passive income for 1 hour.",price:1500,duration:60*60*1e3,icon:Yt}],ei=({coinCount:s=0,onPurchase:o,activeBoosts:i={}})=>{const[f,x]=t.useState(i),I=c=>{if(s<c.price){alert("Not enough coins!");return}x(v=>({...v,[c.key]:Date.now()+c.duration})),o&&o(c.key)};return e.jsxs("div",{className:X.centerContent,children:[e.jsx("h2",{children:"Boosts"}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:24},children:$r.map(c=>e.jsxs("div",{style:{border:"1px solid #ccc",borderRadius:12,padding:16,minWidth:220,background:"#fff",position:"relative"},children:[e.jsx("img",{src:c.icon,alt:c.name,style:{width:38,position:"absolute",top:12,right:12,opacity:.85}}),e.jsx("h3",{children:c.name}),e.jsx("p",{children:c.description}),e.jsxs("p",{children:["Price: ",e.jsx("b",{children:c.price})," coins"]}),f[c.key]&&f[c.key]>Date.now()?e.jsxs("span",{style:{color:"green"},children:["Active (",Math.ceil((f[c.key]-Date.now())/6e4)," min left)"]}):e.jsx("button",{onClick:()=>I(c),disabled:s<c.price,children:"Purchase"})]},c.key))})]})},$=({game:s})=>{const[o,i]=t.useState([]);return t.useEffect(()=>{os(s).then(i);const f=setInterval(()=>os(s).then(i),5e3);return()=>clearInterval(f)},[s]),e.jsxs("div",{style:{background:"#222",borderRadius:8,padding:8,margin:"8px 0",color:"#fff",minWidth:180},children:[e.jsxs("b",{children:[s," Top 10"]}),e.jsxs("ol",{style:{margin:0,paddingLeft:18},children:[o.length===0&&e.jsx("li",{style:{color:"#888"},children:"No scores yet"}),o.map((f,x)=>e.jsxs("li",{children:[f.name,": ",f.score]},x))]})]})},Wt=[{icon:"ðŸŒ¸",color:"#ffb7e5",payout:3},{icon:"ðŸ…",color:"#ffb347",payout:8},{icon:"ðŸŽ­",color:"#e17055",payout:12},{icon:"ðŸª­",color:"#74b9ff",payout:6},{icon:"ðŸ’Ž",color:"#00b894",payout:20},{icon:"ðŸ‘˜",color:"#fd79a8",payout:10},{icon:"ðŸ—¡ï¸",color:"#636e72",payout:15}],xo=3,go=3,ti=.14,ni=8,si=()=>Wt[Math.floor(Math.random()*Wt.length)],po=()=>Array.from({length:go},si),oi=()=>Array.from({length:xo},po);function ai(s){var f,x,I;let o=0;const i=[];for(let c=0;c<go;c++){const v=s[0][c].icon;s.every(m=>m[c].icon===v)&&(o+=((f=Wt.find(m=>m.icon===v))==null?void 0:f.payout)||0,i.push(c))}return s[0][0].icon===s[1][1].icon&&s[1][1].icon===s[2][2].icon&&(o+=((x=Wt.find(c=>c.icon===s[0][0].icon))==null?void 0:x.payout)||0,i.push(3)),s[0][2].icon===s[1][1].icon&&s[1][1].icon===s[2][0].icon&&(o+=((I=Wt.find(c=>c.icon===s[0][2].icon))==null?void 0:I.payout)||0,i.push(4)),{win:o,winLines:i}}const ri=({userId:s,onBack:o,muted:i})=>{const[f,x]=t.useState(s||"");t.useEffect(()=>{var y,W,U;if(!s)try{const S=(y=window.Telegram)==null?void 0:y.WebApp;S&&((U=(W=S.initDataUnsafe)==null?void 0:W.user)!=null&&U.id)&&x(S.initDataUnsafe.user.id.toString())}catch{}},[s]);const[I,c]=t.useState(oi()),[v,m]=t.useState(!1),[j,A]=t.useState(""),[k,L]=t.useState("info"),[B,_]=t.useState(10),[w,D]=t.useState(500),[n,p]=t.useState(!1),[u,N]=t.useState([]),[R,M]=t.useState(!1),[b,d]=t.useState(!1),T=w>=B&&!v,h=()=>{T&&(!i&&!H()&&Y("spin"),m(!0),A("Spinning..."),L("info"),N([]),setTimeout(()=>{const y=Array.from({length:xo},po);c(y);const{win:W,winLines:U}=ai(y);N(U);const S=W*B;let l="",a="error";W>0?(l=`You win ${S} coins!`,a="success",D(r=>r+S),M(!0),!i&&!H()&&Y("win"),setTimeout(()=>M(!1),1200)):(l="No win. Try again!",a="error"),Math.random()<ti?(p(!0),d(!0),!i&&!H()&&Y("bonus"),setTimeout(()=>{const r=Math.floor(Math.random()*10+1)*ni*B;A(`Dangerous Beauty Bonus! You won ${r} coins!`),L("success"),D(C=>C+r),p(!1),d(!1)},1200)):(A(l),L(a)),m(!1),D(r=>r-B)},1200))};return e.jsxs("div",{style:{background:"linear-gradient(135deg,#ffb7e5 60%,#fd79a8 100%)",borderRadius:20,padding:28,color:"#222",boxShadow:"0 0 32px #e17055",maxWidth:420,margin:"0 auto",position:"relative",overflow:"hidden"},children:[e.jsxs("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",pointerEvents:"none",zIndex:0},children:[[...Array(18)].map((y,W)=>e.jsx("div",{style:{position:"absolute",left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,width:10+Math.random()*8,height:10+Math.random()*8,borderRadius:"50%",background:"linear-gradient(135deg,#ffb7e5,#fd79a8,#fff)",opacity:.13+Math.random()*.18,filter:"blur(1.5px)",animation:`floatPetal 7s ${Math.random()*4}s infinite alternate`}},W)),e.jsx("style",{children:`
          @keyframes floatPetal {
            0% { transform: translateY(0); }
            100% { transform: translateY(-30px); }
          }
        `})]}),e.jsx("button",{onClick:()=>{!i&&!H()&&Y("button"),o()},style:{position:"absolute",left:16,top:16,background:"linear-gradient(135deg,#fff,#e17055)",color:"#e17055",border:"none",borderRadius:10,padding:"4px 14px",fontWeight:700,cursor:"pointer",boxShadow:"0 0 6px #e17055",fontSize:18,zIndex:2,transition:"background 0.2s, color 0.2s"},onMouseDown:y=>y.currentTarget.style.background="#e17055",onMouseUp:y=>y.currentTarget.style.background="linear-gradient(135deg,#fff,#e17055)",children:"â† Back"}),e.jsx("h2",{style:{color:"#e17055",textShadow:"0 0 12px #fd79a8",fontSize:32,marginBottom:8,zIndex:2,position:"relative"},children:"ðŸŒ¸ Dangerous Beauty"}),e.jsxs("div",{style:{display:"flex",justifyContent:"center",marginBottom:8,zIndex:2,position:"relative"},children:[e.jsx("span",{style:{fontWeight:600,color:"#222"},children:"User ID:"})," ",e.jsx("span",{style:{marginLeft:8,color:"#e17055"},children:f||"Not connected"})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"center",marginBottom:8,zIndex:2,position:"relative"},children:[e.jsx("span",{style:{fontWeight:600,color:"#222"},children:"Balance:"})," ",e.jsx("span",{style:{marginLeft:8,color:"#00b894"},children:w})]}),e.jsxs("div",{style:{background:"#fff",borderRadius:14,padding:14,margin:"18px 0",boxShadow:"0 0 18px #fd79a8 inset",display:"flex",flexDirection:"column",alignItems:"center",zIndex:2,position:"relative"},children:[e.jsx("div",{style:{display:"flex",gap:10,marginBottom:10},children:I.map((y,W)=>e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:6},children:y.map((U,S)=>e.jsx("div",{style:{width:54,height:54,fontSize:36,background:u.includes(S)?"#fd79a8":U.color,borderRadius:10,display:"flex",alignItems:"center",justifyContent:"center",boxShadow:u.includes(S)?"0 0 18px #fff":"0 0 10px #000",border:"2.5px solid #fff",transition:"background 0.3s, box-shadow 0.3s",animation:v?"spin 0.6s linear infinite":void 0,filter:R&&u.includes(S)?"drop-shadow(0 0 16px #fd79a8)":void 0},children:U.icon},S))},W))}),e.jsxs("div",{style:{margin:"10px 0",color:"#222",fontWeight:600,fontSize:18},children:["Bet: ",e.jsx("input",{type:"number",min:1,max:w,value:B,onChange:y=>_(Math.max(1,Math.min(w,Number(y.target.value)))),style:{width:60,borderRadius:6,padding:4,fontSize:18}})]}),e.jsx("button",{onClick:()=>{!i&&!H()&&Y("button"),h()},disabled:!T,style:{background:T?"linear-gradient(135deg,#e17055,#fd79a8,#fff)":"#ccc",color:T?"#222":"#888",borderRadius:14,padding:"10px 38px",fontWeight:800,fontSize:24,boxShadow:T?"0 0 18px #fd79a8":"none",border:"none",marginTop:10,cursor:T?"pointer":"not-allowed",transition:"background 0.2s, color 0.2s",zIndex:2},onMouseDown:y=>y.currentTarget.style.background="#e17055",onMouseUp:y=>y.currentTarget.style.background="linear-gradient(135deg,#e17055,#fd79a8,#fff)",children:v?"Spinning...":"SPIN"}),n&&e.jsx("div",{style:{color:"#fd79a8",fontWeight:800,fontSize:22,marginTop:10,textShadow:"0 0 12px #fff",letterSpacing:1},children:"BONUS!"}),R&&e.jsx("div",{style:{position:"absolute",left:"50%",top:"30%",transform:"translate(-50%, -50%)",color:"#fd79a8",fontWeight:900,fontSize:38,textShadow:"0 0 24px #fff, 0 0 32px #fd79a8",pointerEvents:"none",zIndex:10,animation:"popSuccess 1.1s"},children:"ðŸŽ€ WIN!"}),b&&e.jsx("div",{style:{position:"absolute",left:"50%",top:"60%",transform:"translate(-50%, -50%)",color:"#fd79a8",fontWeight:900,fontSize:34,textShadow:"0 0 24px #fff, 0 0 32px #fd79a8",pointerEvents:"none",zIndex:10,animation:"popBonus 1.1s"},children:"âœ¨ DANGEROUS BEAUTY BONUS âœ¨"}),e.jsx("div",{style:{marginTop:14,minHeight:28,color:k==="success"?"#00b894":k==="error"?"#e17055":"#222",fontWeight:700,fontSize:18,textShadow:k==="success"?"0 0 10px #00b894":k==="error"?"0 0 10px #e17055":void 0,animation:k==="success"&&j?"popSuccess 0.5s":k==="error"&&j?"popError 0.5s":void 0,transition:"color 0.2s, text-shadow 0.2s"},children:j}),e.jsx("style",{children:`
          @keyframes popSuccess {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
          }
          @keyframes popError {
            0% { transform: scale(1); }
            50% { transform: scale(1.15); }
            100% { transform: scale(1); }
          }
          @keyframes popBonus {
            0% { opacity: 0; transform: scale(0.7); }
            30% { opacity: 1; transform: scale(1.2); }
            80% { opacity: 1; transform: scale(1); }
            100% { opacity: 0; transform: scale(0.8); }
          }
          @keyframes spin {
            0% { transform: rotateX(0deg); }
            100% { transform: rotateX(360deg); }
          }
        `})]}),e.jsx($,{game:"DangerousBeautySlot"})]})},ii=({userId:s,onBack:o})=>e.jsx(ri,{userId:s,onBack:o}),zt=[{icon:"ðŸŒ™",color:"#b2bec3",payout:4},{icon:"ðŸ¦‰",color:"#636e72",payout:8},{icon:"ðŸ‘¸",color:"#ffeaa7",payout:12},{icon:"ðŸ”®",color:"#6c5ce7",payout:10},{icon:"â­",color:"#fdcb6e",payout:6},{icon:"ðŸª",color:"#00b894",payout:20},{icon:"ðŸ¦‹",color:"#00bfff",payout:15}],yo=3,mo=3,li=.15,ci=9,fi=()=>zt[Math.floor(Math.random()*zt.length)],So=()=>Array.from({length:mo},fi),di=()=>Array.from({length:yo},So);function ui(s){var f,x,I;let o=0;const i=[];for(let c=0;c<mo;c++){const v=s[0][c].icon;s.every(m=>m[c].icon===v)&&(o+=((f=zt.find(m=>m.icon===v))==null?void 0:f.payout)||0,i.push(c))}return s[0][0].icon===s[1][1].icon&&s[1][1].icon===s[2][2].icon&&(o+=((x=zt.find(c=>c.icon===s[0][0].icon))==null?void 0:x.payout)||0,i.push(3)),s[0][2].icon===s[1][1].icon&&s[1][1].icon===s[2][0].icon&&(o+=((I=zt.find(c=>c.icon===s[0][2].icon))==null?void 0:I.payout)||0,i.push(4)),{win:o,winLines:i}}const hi=({userId:s,onBack:o,muted:i})=>{const[f,x]=t.useState(s||"");t.useEffect(()=>{var y,W,U;if(!s)try{const S=(y=window.Telegram)==null?void 0:y.WebApp;S&&((U=(W=S.initDataUnsafe)==null?void 0:W.user)!=null&&U.id)&&x(S.initDataUnsafe.user.id.toString())}catch{}},[s]);const[I,c]=t.useState(di()),[v,m]=t.useState(!1),[j,A]=t.useState(""),[k,L]=t.useState("info"),[B,_]=t.useState(10),[w,D]=t.useState(500),[n,p]=t.useState(!1),[u,N]=t.useState([]),[R,M]=t.useState(!1),[b,d]=t.useState(!1),T=w>=B&&!v,h=()=>{T&&(!i&&!H()&&Y("spin"),m(!0),A("Spinning..."),L("info"),N([]),setTimeout(()=>{const y=Array.from({length:yo},So);c(y);const{win:W,winLines:U}=ui(y);N(U);const S=W*B;let l="",a="error";W>0?(l=`You win ${S} coins!`,a="success",D(r=>r+S),M(!0),!i&&!H()&&Y("win"),setTimeout(()=>M(!1),1200)):(l="No win. Try again!",a="error"),Math.random()<li?(p(!0),d(!0),!i&&!H()&&Y("bonus"),setTimeout(()=>{const r=Math.floor(Math.random()*10+1)*ci*B;A(`Moon Maiden Bonus! You won ${r} coins!`),L("success"),D(C=>C+r),p(!1),d(!1)},1200)):(A(l),L(a)),m(!1),D(r=>r-B)},1200))};return e.jsxs("div",{style:{background:"linear-gradient(135deg,#b2bec3 60%,#6c5ce7 100%)",borderRadius:20,padding:28,color:"#222",boxShadow:"0 0 32px #6c5ce7",maxWidth:420,margin:"0 auto",position:"relative",overflow:"hidden"},children:[e.jsxs("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",pointerEvents:"none",zIndex:0},children:[[...Array(18)].map((y,W)=>e.jsx("div",{style:{position:"absolute",left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,width:8+Math.random()*10,height:8+Math.random()*10,borderRadius:"50%",background:"linear-gradient(135deg,#fff,#fdcb6e,#6c5ce7)",opacity:.1+Math.random()*.18,filter:"blur(2px)",animation:`floatCelestial 8s ${Math.random()*4}s infinite alternate`}},W)),e.jsx("style",{children:`
          @keyframes floatCelestial {
            0% { transform: translateY(0); }
            100% { transform: translateY(-40px); }
          }
        `})]}),e.jsx("button",{onClick:()=>{!i&&!H()&&Y("button"),o()},style:{position:"absolute",left:16,top:16,background:"linear-gradient(135deg,#fff,#6c5ce7)",color:"#6c5ce7",border:"none",borderRadius:10,padding:"4px 14px",fontWeight:700,cursor:"pointer",boxShadow:"0 0 6px #6c5ce7",fontSize:18,zIndex:2,transition:"background 0.2s, color 0.2s"},onMouseDown:y=>y.currentTarget.style.background="#6c5ce7",onMouseUp:y=>y.currentTarget.style.background="linear-gradient(135deg,#fff,#6c5ce7)",children:"â† Back"}),e.jsx("h2",{style:{color:"#6c5ce7",textShadow:"0 0 12px #fdcb6e",fontSize:32,marginBottom:8,zIndex:2,position:"relative"},children:"ðŸŒ™ Moon Maiden"}),e.jsxs("div",{style:{display:"flex",justifyContent:"center",marginBottom:8,zIndex:2,position:"relative"},children:[e.jsx("span",{style:{fontWeight:600,color:"#222"},children:"User ID:"})," ",e.jsx("span",{style:{marginLeft:8,color:"#6c5ce7"},children:f||"Not connected"})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"center",marginBottom:8,zIndex:2,position:"relative"},children:[e.jsx("span",{style:{fontWeight:600,color:"#222"},children:"Balance:"})," ",e.jsx("span",{style:{marginLeft:8,color:"#00b894"},children:w})]}),e.jsxs("div",{style:{background:"#fff",borderRadius:14,padding:14,margin:"18px 0",boxShadow:"0 0 18px #6c5ce7 inset",display:"flex",flexDirection:"column",alignItems:"center",zIndex:2,position:"relative"},children:[e.jsx("div",{style:{display:"flex",gap:10,marginBottom:10},children:I.map((y,W)=>e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:6},children:y.map((U,S)=>e.jsx("div",{style:{width:54,height:54,fontSize:36,background:u.includes(S)?"#fdcb6e":U.color,borderRadius:10,display:"flex",alignItems:"center",justifyContent:"center",boxShadow:u.includes(S)?"0 0 18px #fff":"0 0 10px #000",border:"2.5px solid #fff",transition:"background 0.3s, box-shadow 0.3s",animation:v?"spin 0.6s linear infinite":void 0,filter:R&&u.includes(S)?"drop-shadow(0 0 16px #fdcb6e)":void 0},children:U.icon},S))},W))}),e.jsxs("div",{style:{margin:"10px 0",color:"#222",fontWeight:600,fontSize:18},children:["Bet: ",e.jsx("input",{type:"number",min:1,max:w,value:B,onChange:y=>_(Math.max(1,Math.min(w,Number(y.target.value)))),style:{width:60,borderRadius:6,padding:4,fontSize:18}})]}),e.jsx("button",{onClick:()=>{!i&&!H()&&Y("button"),h()},disabled:!T,style:{background:T?"linear-gradient(135deg,#6c5ce7,#fdcb6e,#fff)":"#ccc",color:T?"#222":"#888",borderRadius:14,padding:"10px 38px",fontWeight:800,fontSize:24,boxShadow:T?"0 0 18px #fdcb6e":"none",border:"none",marginTop:10,cursor:T?"pointer":"not-allowed",transition:"background 0.2s, color 0.2s",zIndex:2},onMouseDown:y=>y.currentTarget.style.background="#6c5ce7",onMouseUp:y=>y.currentTarget.style.background="linear-gradient(135deg,#6c5ce7,#fdcb6e,#fff)",children:v?"Spinning...":"SPIN"}),n&&e.jsx("div",{style:{color:"#fdcb6e",fontWeight:800,fontSize:22,marginTop:10,textShadow:"0 0 12px #fff",letterSpacing:1},children:"BONUS!"}),R&&e.jsx("div",{style:{position:"absolute",left:"50%",top:"30%",transform:"translate(-50%, -50%)",color:"#fdcb6e",fontWeight:900,fontSize:38,textShadow:"0 0 24px #fff, 0 0 32px #fdcb6e",pointerEvents:"none",zIndex:10,animation:"popSuccess 1.1s"},children:"ðŸŒŸ WIN!"}),b&&e.jsx("div",{style:{position:"absolute",left:"50%",top:"60%",transform:"translate(-50%, -50%)",color:"#fdcb6e",fontWeight:900,fontSize:34,textShadow:"0 0 24px #fff, 0 0 32px #fdcb6e",pointerEvents:"none",zIndex:10,animation:"popBonus 1.1s"},children:"âœ¨ MOON MAIDEN BONUS âœ¨"}),e.jsx("div",{style:{marginTop:14,minHeight:28,color:k==="success"?"#00b894":k==="error"?"#6c5ce7":"#222",fontWeight:700,fontSize:18,textShadow:k==="success"?"0 0 10px #00b894":k==="error"?"0 0 10px #6c5ce7":void 0,animation:k==="success"&&j?"popSuccess 0.5s":k==="error"&&j?"popError 0.5s":void 0,transition:"color 0.2s, text-shadow 0.2s"},children:j}),e.jsx("style",{children:`
          @keyframes popSuccess {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
          }
          @keyframes popError {
            0% { transform: scale(1); }
            50% { transform: scale(1.15); }
            100% { transform: scale(1); }
          }
          @keyframes popBonus {
            0% { opacity: 0; transform: scale(0.7); }
            30% { opacity: 1; transform: scale(1.2); }
            80% { opacity: 1; transform: scale(1); }
            100% { opacity: 0; transform: scale(0.8); }
          }
          @keyframes spin {
            0% { transform: rotateX(0deg); }
            100% { transform: rotateX(360deg); }
          }
        `})]}),e.jsx($,{game:"MoonMaidenSlot"})]})},xi=({userId:s,onBack:o})=>e.jsx(hi,{userId:s,onBack:o}),Tt=480,Xe=320,lt=28,Te=28,An=8,hs=3.2,gi=6.2,pi=2.1,yi=1200,xs=3,mi=({userId:s})=>{const o=t.useRef(null),[i,f]=t.useState({x:60,y:Xe/2,health:xs}),[x,I]=t.useState([]),[c,v]=t.useState([]),[m,j]=t.useState(0),[A,k]=t.useState(!1),[L,B]=t.useState(!1),[_,w]=t.useState(0);t.useEffect(()=>{var p;const n=(p=o.current)==null?void 0:p.getContext("2d");n&&(n.clearRect(0,0,Tt,Xe),n.fillStyle="#001a33",n.fillRect(0,0,Tt,Xe),n.save(),n.translate(i.x,i.y),n.fillStyle="#fff",n.beginPath(),n.arc(0,0,lt/2,0,2*Math.PI),n.fill(),n.font="bold 24px sans-serif",n.fillStyle="#00eaff",n.fillText("ðŸš€",-14,10),n.restore(),x.forEach(u=>{n.save(),n.translate(u.x,u.y),n.fillStyle="#ff0",n.beginPath(),n.arc(0,0,An/2,0,2*Math.PI),n.fill(),n.restore()}),c.forEach(u=>{u.alive&&(n.save(),n.translate(u.x,u.y),n.fillStyle="#f55",n.beginPath(),n.arc(0,0,Te/2,0,2*Math.PI),n.fill(),n.font="bold 22px sans-serif",n.fillStyle="#fff",n.fillText("ðŸ‘¾",-12,10),n.restore())}),n.save(),n.font="bold 16px Arial",n.fillStyle="#fff",n.fillText(`Health: ${i.health}`,20,28),n.restore(),n.save(),n.font="20px Arial",n.fillStyle="#fff",n.fillText(`Score: ${m}`,340,28),n.restore(),A&&(n.save(),n.font="32px Arial",n.fillStyle="#f00",n.fillText("Game Over!",140,160),n.font="20px Arial",n.fillStyle="#fff",n.fillText("Press R to restart",150,200),n.restore()),L&&(n.save(),n.font="32px Arial",n.fillStyle="#0f0",n.fillText("You Win!",160,160),n.font="20px Arial",n.fillStyle="#fff",n.fillText("Press R to restart",150,200),n.restore()))},[i,x,c,m,A,L]),t.useEffect(()=>{if(A||L)return;const n=p=>{if(p.key==="r"||p.key==="R"){D();return}let u=0;p.key==="ArrowUp"||p.key==="w"?u=-hs:(p.key==="ArrowDown"||p.key==="s")&&(u=hs),u!==0&&f(N=>({...N,y:Math.max(lt/2,Math.min(Xe-lt/2,N.y+u))})),p.key===" "&&Date.now()-_>180&&(I(N=>[...N,{x:i.x+lt/2,y:i.y}]),w(Date.now()))};return window.addEventListener("keydown",n),()=>window.removeEventListener("keydown",n)},[i,A,L,_]),t.useEffect(()=>{if(A||L)return;const n=setInterval(()=>{I(p=>p.map(u=>({...u,x:u.x+gi})).filter(u=>u.x<Tt)),v(p=>p.map(u=>({...u,x:u.x-pi})).filter(u=>u.x>-Te)),v(p=>p.map(u=>{if(!u.alive)return u;for(const N of x)if(Math.abs(N.x-u.x)<(Te+An)/2&&Math.abs(N.y-u.y)<(Te+An)/2)return j(R=>R+200),{...u,alive:!1};return u})),v(p=>p.map(u=>u.alive&&Math.abs(i.x-u.x)<(lt+Te)/2&&Math.abs(i.y-u.y)<(lt+Te)/2?(f(N=>({...N,health:Math.max(0,N.health-1)})),{...u,alive:!1}):u)),i.health<=0&&(k(!0),J("RType",s,m)),m>=2e3&&(B(!0),J("RType",s,m+500),j(p=>p+500))},32);return()=>clearInterval(n)},[i,x,c,m,s,A,L]),t.useEffect(()=>{if(A||L)return;const n=setInterval(()=>{v(p=>[...p,{x:Tt-Te/2,y:Math.random()*(Xe-Te)+Te/2,alive:!0}])},yi);return()=>clearInterval(n)},[A,L]);function D(){f({x:60,y:Xe/2,health:xs}),I([]),v([]),j(0),k(!1),B(!1),w(0)}return e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("h2",{children:"R-Type"}),e.jsx("canvas",{ref:o,width:Tt,height:Xe,style:{background:"#001a33",border:"3px solid #00eaff",marginBottom:10}}),e.jsx("div",{style:{color:"#fff",marginBottom:8},children:"Arrow keys/W/S: Move up/down. Space: Shoot. Survive and score 2000 points!"}),e.jsx($,{game:"RType"}),e.jsx("button",{onClick:D,style:{margin:8},children:"Restart"})]})},Si=({userId:s})=>e.jsx(mi,{userId:s}),fe=400,Ze=480,Mt=36,bi=48,ct=36,vi=48,gs=40,wi=18,jn=32,ps=5,ys=5,ki=()=>{const s=t.useRef(null),[o,i]=t.useState(0),[f,x]=t.useState(!1),[I,c]=t.useState(!1),[v,m]=t.useState(!0),[j,A]=t.useState(!0),[k,L]=t.useState(!1),[B,_]=t.useState(fe/2-Mt/2),[w]=t.useState(Ze-100),[D,n]=t.useState(fe/2-ct/2),[p]=t.useState(80),[u,N]=t.useState(ys),[R,M]=t.useState(ps),[b,d]=t.useState(0),[T,h]=t.useState(jn),[y,W]=t.useState(!1),[U,S]=t.useState(!1),l=t.useRef({});t.useEffect(()=>{const P=z=>{l.current[z.key]=!0,(z.key===" "||z.key==="ArrowUp")&&A(!1)},g=z=>{l.current[z.key]=!1};return window.addEventListener("keydown",P),window.addEventListener("keyup",g),()=>{window.removeEventListener("keydown",P),window.removeEventListener("keyup",g)}},[]),t.useEffect(()=>{if(!v)return;let P,g=performance.now();function z(E){const O=Math.min((E-g)/16,2);g=E,a(O),r(),v&&(P=requestAnimationFrame(z))}return P=requestAnimationFrame(z),()=>cancelAnimationFrame(P)},[v,B,D,u,R,b,T,U,y,f,I]);function a(P){if(f||I)return;let g=B;l.current.ArrowLeft&&(g-=3.2*P),l.current.ArrowRight&&(g+=3.2*P),g=Math.max(40,Math.min(fe-Mt-40,g)),_(g),l.current[" "]&&b<=0&&(S(!0),d(wi),Math.abs(g+Mt/2-(D+ct/2))<gs&&Math.abs(w-p)<50&&R>0&&(M(E=>E-1),i(E=>E+200)),l.current[" "]=!1),b>0?d(b-1):S(!1);let z=D;z<g?z+=2.2*P:z>g&&(z-=2.2*P),z=Math.max(40,Math.min(fe-ct-40,z)),n(z),T<=0&&Math.abs(z-g)<gs&&Math.abs(w-p)<50&&u>0?(W(!0),h(jn),N(E=>E-1)):(W(!1),T>0&&h(T-1)),R<=0&&(c(!0),m(!1),i(E=>E+1e3)),u<=0&&(x(!0),m(!1))}function r(){var g;const P=(g=s.current)==null?void 0:g.getContext("2d");P&&(P.clearRect(0,0,fe,Ze),P.fillStyle="#222",P.fillRect(0,0,fe,Ze),P.strokeStyle="#fff",P.lineWidth=4,P.strokeRect(30,60,fe-60,Ze-120),P.save(),P.translate(D,p),P.fillStyle="#e53935",P.fillRect(0,0,ct,vi),P.font="bold 32px sans-serif",P.fillStyle="#fff",P.fillText("ðŸ¥Š",0,38),y&&(P.fillStyle="#fff",P.fillRect(ct-6,18,18,8)),P.restore(),P.save(),P.translate(B,w),P.fillStyle="#43a047",P.fillRect(0,0,Mt,bi),P.font="bold 32px sans-serif",P.fillStyle="#fff",P.fillText("ðŸ¥Š",0,38),U&&(P.fillStyle="#fff",P.fillRect(-12,18,18,8)),P.restore(),P.fillStyle="#fff",P.font="bold 16px sans-serif",P.fillText("You",60,Ze-20),P.fillText("Enemy",260,50),P.fillStyle="#43a047",P.fillRect(100,Ze-30,30*u,12),P.fillStyle="#e53935",P.fillRect(320,40,30*R,12),P.fillStyle="#fff",P.font="bold 16px sans-serif",P.fillText(`Score: ${o}`,10,24),j&&(P.fillStyle="rgba(0,0,0,0.7)",P.fillRect(30,120,340,120),P.fillStyle="#fff",P.font="bold 18px sans-serif",P.fillText("Punch Out (Mini)",120,150),P.font="14px sans-serif",P.fillText("Arrow keys: Move",80,180),P.fillText("Space: Punch",80,200),P.fillText("Defeat the enemy boxer!",80,220),P.fillText("Press any key to start",100,240)),f&&(P.fillStyle="rgba(0,0,0,0.7)",P.fillRect(60,180,280,80),P.fillStyle="#fff",P.font="bold 28px sans-serif",P.fillText("Game Over",120,220)),I&&(P.fillStyle="rgba(0,0,0,0.7)",P.fillRect(60,180,280,80),P.fillStyle="#fff",P.font="bold 28px sans-serif",P.fillText("You Win!",140,220)))}function C(){_(fe/2-Mt/2),n(fe/2-ct/2),N(ys),M(ps),i(0),x(!1),c(!1),m(!0),A(!0),d(0),h(jn),S(!1),W(!1)}async function G(){L(!0);try{const P=localStorage.getItem("userId")||"anon";await J("punchout",P,o)}catch{}L(!1)}return e.jsxs("div",{className:"arcade-game-container",style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx("h2",{children:"Punch Out"}),e.jsx("canvas",{ref:s,width:fe,height:Ze,style:{border:"2px solid #fff",background:"#222",marginBottom:16,maxWidth:"100%",height:"auto"},tabIndex:0}),(f||I)&&e.jsxs("div",{style:{margin:8},children:[e.jsx("button",{onClick:C,style:{marginRight:12},children:"Restart"}),e.jsx("button",{onClick:G,disabled:k,children:k?"Submitting...":"Submit Score"})]}),e.jsx("div",{style:{marginTop:24,width:"100%"},children:e.jsx($,{gameId:"punchout"})})]})},Ai=()=>{const s=co();return e.jsxs("div",{style:{background:"#222",minHeight:"100vh",color:"#fff"},children:[e.jsx("button",{onClick:()=>s("/arcade"),style:{margin:16},children:"â¬… Back to Arcade"}),e.jsx(ki,{})]})},be=40,ns=7,ji=16,Ei=14,Ii=180,Ti=2e3,En=["#f7c873","#f7e273","#f7a673","#f77373","#73f7b2"];function ms(){const s=[];for(let o=0;o<ns;o++)for(let i=0;i<=o;i++)s.push({row:o,col:i,color:0});return s}function In(s,o){const i=220+(o-s/2)*be,f=60+s*be*.85;return{x:i,y:f}}function Ss(s,o){return s>=0&&s<ns&&o>=0&&o<=s}function Mi(){if(Math.random()<.5)return{row:0,col:0};const s=Math.floor(Math.random()*(ns-1))+1;return{row:s,col:Math.random()<.5?0:s}}const bs=[{color:"#e74c3c",points:150},{color:"#2ecc40",points:200}],Ri=({userId:s})=>{const[o,i]=t.useState(ms()),[f,x]=t.useState({row:0,col:0,jumping:!1}),[I,c]=t.useState(0),[v,m]=t.useState(!1),[j,A]=t.useState([]),[k,L]=t.useState(!1),B=t.useRef(null);t.useEffect(()=>{var p;const w=(p=B.current)==null?void 0:p.getContext("2d");if(!w)return;w.clearRect(0,0,480,400),o.forEach(u=>{const{x:N,y:R}=In(u.row,u.col);w.save(),w.beginPath(),w.moveTo(N,R),w.lineTo(N+be/2,R+be*.85),w.lineTo(N,R+be*1.7),w.lineTo(N-be/2,R+be*.85),w.closePath(),w.fillStyle=En[u.color],w.fill(),w.strokeStyle="#333",w.stroke(),w.restore()});const{x:D,y:n}=In(f.row,f.col);w.save(),w.beginPath(),w.arc(D,n+be*.7,ji,0,2*Math.PI),w.fillStyle="#ffb347",w.fill(),w.strokeStyle="#333",w.stroke(),w.restore(),w.save(),w.beginPath(),w.arc(D,n+be*.7,6,0,Math.PI,!1),w.strokeStyle="#333",w.stroke(),w.restore(),j.forEach(u=>{const{x:N,y:R}=In(u.row,u.col);w.save(),w.beginPath(),w.arc(N,R+be*.7,Ei,0,2*Math.PI),w.fillStyle=u.type.color,w.fill(),w.strokeStyle="#222",w.stroke(),w.restore()}),w.save(),w.font="20px Arial",w.fillStyle="#fff",w.fillText(`Score: ${I}`,10,30),w.restore(),v&&(w.save(),w.font="32px Arial",w.fillStyle="#f00",w.fillText("Game Over!",140,200),w.font="20px Arial",w.fillStyle="#fff",w.fillText("Press R to restart",150,240),w.restore()),k&&(w.save(),w.font="32px Arial",w.fillStyle="#0f0",w.fillText("You Win!",160,200),w.font="20px Arial",w.fillStyle="#fff",w.fillText("Press R to restart",150,240),w.restore())},[o,f,j,I,v,k]),t.useEffect(()=>{if(v||k)return;const w=D=>{if(f.jumping)return;let n=0,p=0;if(D.key==="ArrowUp"||D.key==="w")n=-1;else if(D.key==="ArrowDown"||D.key==="s")n=1;else if(D.key==="ArrowLeft"||D.key==="a")p=-1;else if(D.key==="ArrowRight"||D.key==="d")p=1;else if(D.key==="r"||D.key==="R"){_();return}if(n!==0||p!==0){const u=f.row+n,N=f.col+p;Ss(u,N)&&(x(R=>({...R,jumping:!0})),x(R=>({...R,jumping:!0})),setTimeout(()=>{x({row:u,col:N,jumping:!1}),i(R=>R.map(M=>M.row===u&&M.col===N&&M.color<En.length-1?{...M,color:M.color+1}:M)),c(R=>R+25)},Ii))}};return window.addEventListener("keydown",w),()=>window.removeEventListener("keydown",w)},[f,v,k]),t.useEffect(()=>{if(v||k)return;const w=setInterval(()=>{A(D=>{const n=D.map(p=>{const u=Math.random()<.5?1:0,N=u===1?Math.random()<.5?0:1:Math.random()<.5?-1:1,R=p.row+u,M=p.col+N;return Ss(R,M)?{...p,row:R,col:M}:null}).filter(p=>p!==null);if(Math.random()<.7){const p=bs[Math.floor(Math.random()*bs.length)];n.push({...Mi(),type:p})}return n})},Ti);return()=>clearInterval(w)},[v,k]),t.useEffect(()=>{v||k||j.forEach(w=>{w.row===f.row&&w.col===f.col&&(m(!0),J("Qbert",s,I))})},[j,f,v,k,I,s]),t.useEffect(()=>{o.every(w=>w.color===En.length-1)&&(L(!0),J("Qbert",s,I+500),c(w=>w+500))},[o,s,I]);function _(){i(ms()),x({row:0,col:0,jumping:!1}),c(0),m(!1),A([]),L(!1)}return e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("h2",{children:"Q*bert"}),e.jsx("canvas",{ref:B,width:480,height:400,style:{background:"#222",border:"3px solid #f7c873",marginBottom:10}}),e.jsx("div",{style:{color:"#fff",marginBottom:8},children:"Use arrow keys or WASD to jump. Change all tiles' color. Avoid enemies!"}),e.jsx($,{game:"Qbert"}),e.jsx("button",{onClick:_,style:{margin:8},children:"Restart"})]})},Ci=({userId:s})=>e.jsx(Ri,{userId:s}),at=480,Kt=400,Rt=32,vs=48,ws=120,Tn=3,Bi=4,Ve=24,ks=1.2,As=3.2,js=36,Ni=400,Es=100;function Is(){const s=[];for(let o=0;o<Bi;o++)for(let i=0;i<Tn;i++)s.push({x:40+o*(vs+18),y:220+i*(ws/Tn),w:vs,h:ws/Tn,destroyed:!1,col:o,row:i});return s}function Mn(){return{x:Math.random()*(at-Ve),y:0,vx:(Math.random()-.5)*ks*2,vy:ks+Math.random()*.7,alive:!0}}const Pi=({userId:s})=>{const o=t.useRef(null),[i,f]=t.useState({x:80,y:320,health:Es,punching:!1,punchDir:1}),[x,I]=t.useState(Is()),[c,v]=t.useState(0),[m,j]=t.useState(!1),[A,k]=t.useState(!1),[L,B]=t.useState([Mn()]),[_,w]=t.useState(0);t.useEffect(()=>{var p;const n=(p=o.current)==null?void 0:p.getContext("2d");n&&(n.clearRect(0,0,at,Kt),n.fillStyle="#7ec0ee",n.fillRect(0,0,at,Kt),x.forEach(u=>{n.save(),n.globalAlpha=u.destroyed?.2:1,n.fillStyle=u.destroyed?"#bbb":"#444",n.fillRect(u.x,u.y,u.w,u.h),n.strokeStyle="#222",n.strokeRect(u.x,u.y,u.w,u.h),n.restore()}),n.save(),n.translate(i.x,i.y),n.fillStyle="#b5651d",n.beginPath(),n.arc(0,0,Rt/2,0,2*Math.PI),n.fill(),n.font="bold 28px sans-serif",n.fillStyle="#fff",n.fillText("ðŸ¦",-18,14),n.restore(),i.punching&&(n.save(),n.strokeStyle="#f00",n.lineWidth=6,n.beginPath(),n.moveTo(i.x,i.y),n.lineTo(i.x+i.punchDir*js,i.y),n.stroke(),n.restore()),L.forEach(u=>{u.alive&&(n.save(),n.translate(u.x,u.y),n.fillStyle="#222",n.beginPath(),n.arc(0,0,Ve/2,0,2*Math.PI),n.fill(),n.font="bold 20px sans-serif",n.fillStyle="#fff",n.fillText("ðŸš",-14,10),n.restore())}),n.save(),n.fillStyle="#fff",n.fillRect(10,10,104,18),n.fillStyle="#f00",n.fillRect(12,12,i.health,14),n.strokeStyle="#222",n.strokeRect(10,10,104,18),n.font="bold 14px Arial",n.fillStyle="#222",n.fillText("Health",40,24),n.restore(),n.save(),n.font="20px Arial",n.fillStyle="#fff",n.fillText(`Score: ${c}`,340,28),n.restore(),m&&(n.save(),n.font="32px Arial",n.fillStyle="#f00",n.fillText("Game Over!",140,200),n.font="20px Arial",n.fillStyle="#fff",n.fillText("Press R to restart",150,240),n.restore()),A&&(n.save(),n.font="32px Arial",n.fillStyle="#0f0",n.fillText("You Win!",160,200),n.font="20px Arial",n.fillStyle="#fff",n.fillText("Press R to restart",150,240),n.restore()))},[i,x,L,c,m,A]),t.useEffect(()=>{if(m||A)return;const n=p=>{if(p.key==="r"||p.key==="R"){D();return}if(i.punching)return;let u=0;p.key==="ArrowLeft"||p.key==="a"?u=-As:(p.key==="ArrowRight"||p.key==="d")&&(u=As),u!==0&&f(N=>({...N,x:Math.max(Rt/2,Math.min(at-Rt/2,N.x+u)),punchDir:u>0?1:-1})),(p.key===" "||p.key==="z")&&Date.now()-_>Ni&&(f(N=>({...N,punching:!0})),w(Date.now()),setTimeout(()=>f(N=>({...N,punching:!1})),120))};return window.addEventListener("keydown",n),()=>window.removeEventListener("keydown",n)},[i,m,A,_]),t.useEffect(()=>{if(m||A)return;const n=setInterval(()=>{i.punching&&I(p=>p.map(u=>!u.destroyed&&Math.abs(i.x+i.punchDir*js-(u.x+u.w/2))<u.w/2&&Math.abs(i.y-(u.y+u.h/2))<u.h/2?(v(N=>N+100),{...u,destroyed:!0}):u)),B(p=>p.map(u=>{if(!u.alive)return u;let N=u.x+u.vx,R=u.y+u.vy;return(N<Ve/2||N>at-Ve/2)&&(u.vx*=-1),R>Kt-Ve/2&&(R=0,N=Math.random()*(at-Ve)),Math.abs(N-i.x)<(Rt+Ve)/2&&Math.abs(R-i.y)<(Rt+Ve)/2&&f(M=>({...M,health:Math.max(0,M.health-18)})),{...u,x:N,y:R}})),Math.random()<.04&&L.length<6&&B(p=>[...p,Mn()]),i.health<=0&&(j(!0),J("Rampage",s,c)),x.every(p=>p.destroyed)&&(k(!0),J("Rampage",s,c+500),v(p=>p+500))},32);return()=>clearInterval(n)},[i,x,L,c,s,m,A]);function D(){f({x:80,y:320,health:Es,punching:!1,punchDir:1}),I(Is()),B([Mn()]),v(0),j(!1),k(!1),w(0)}return e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("h2",{children:"Rampage"}),e.jsx("canvas",{ref:o,width:at,height:Kt,style:{background:"#7ec0ee",border:"3px solid #b5651d",marginBottom:10}}),e.jsx("div",{style:{color:"#222",marginBottom:8},children:"Arrow keys/A/D: Move. Space/Z: Punch. Destroy all buildings. Avoid helicopters!"}),e.jsx($,{game:"Rampage"}),e.jsx("button",{onClick:D,style:{margin:8},children:"Restart"})]})},Li=({userId:s})=>e.jsx(Pi,{userId:s}),de=480,qt=320,ft=38,Ct=38,ue=240,Xt=3.2,Ts=-7.5,Ms=.5,Bt=44,Rs=400,Zt=100,Di=32,Cs={player:"ðŸ¥‹",enemy:"ðŸ¥Š"},_i=({userId:s})=>{const o=t.useRef(null),[i,f]=t.useState({x:100,y:ue,vx:0,vy:0,health:Zt,attacking:!1,facing:1,onGround:!0}),[x,I]=t.useState({x:340,y:ue,vx:0,vy:0,health:Zt,attacking:!1,facing:-1,onGround:!0}),[c,v]=t.useState(0),[m,j]=t.useState(!1),[A,k]=t.useState(!1),[L,B]=t.useState(0),[_,w]=t.useState(0);t.useEffect(()=>{var p;const n=(p=o.current)==null?void 0:p.getContext("2d");n&&(n.clearRect(0,0,de,qt),n.fillStyle="#b3e0ff",n.fillRect(0,0,de,qt),n.fillStyle="#4caf50",n.fillRect(0,ue+ft/2,de,qt-ue),n.save(),n.fillStyle="#fff",n.fillRect(30,20,104,16),n.fillRect(de-134,20,104,16),n.fillStyle="#f00",n.fillRect(32,22,i.health,12),n.fillRect(de-132,22,x.health,12),n.strokeStyle="#222",n.strokeRect(30,20,104,16),n.strokeRect(de-134,20,104,16),n.font="bold 13px Arial",n.fillStyle="#222",n.fillText("You",60,32),n.fillText("Enemy",de-104,32),n.restore(),n.save(),n.translate(i.x,i.y),n.fillStyle="#fff",n.beginPath(),n.arc(0,0,ft/2,0,2*Math.PI),n.fill(),n.font="bold 32px sans-serif",n.fillStyle="#222",n.fillText(Cs.player,-18,14),n.restore(),i.attacking&&(n.save(),n.strokeStyle="#f00",n.lineWidth=6,n.beginPath(),n.moveTo(i.x,i.y),n.lineTo(i.x+i.facing*Bt,i.y),n.stroke(),n.restore()),n.save(),n.translate(x.x,x.y),n.fillStyle="#fff",n.beginPath(),n.arc(0,0,Ct/2,0,2*Math.PI),n.fill(),n.font="bold 32px sans-serif",n.fillStyle="#222",n.fillText(Cs.enemy,-18,14),n.restore(),x.attacking&&(n.save(),n.strokeStyle="#00f",n.lineWidth=6,n.beginPath(),n.moveTo(x.x,x.y),n.lineTo(x.x+x.facing*Bt,x.y),n.stroke(),n.restore()),n.save(),n.font="20px Arial",n.fillStyle="#222",n.fillText(`Score: ${c}`,200,28),n.restore(),m&&(n.save(),n.font="32px Arial",n.fillStyle="#f00",n.fillText("Game Over!",150,160),n.font="20px Arial",n.fillStyle="#222",n.fillText("Press R to restart",150,200),n.restore()),A&&(n.save(),n.font="32px Arial",n.fillStyle="#0f0",n.fillText("You Win!",160,160),n.font="20px Arial",n.fillStyle="#222",n.fillText("Press R to restart",150,200),n.restore()))},[i,x,c,m,A]),t.useEffect(()=>{if(m||A)return;const n=p=>{if(p.key==="r"||p.key==="R"){D();return}if(i.attacking)return;let u=0;p.key==="ArrowLeft"||p.key==="a"?u=-Xt:(p.key==="ArrowRight"||p.key==="d")&&(u=Xt),u!==0&&f(N=>({...N,x:Math.max(ft/2,Math.min(de-ft/2,N.x+u)),facing:u>0?1:-1})),(p.key==="ArrowUp"||p.key==="w")&&i.onGround&&f(N=>({...N,vy:Ts,onGround:!1})),(p.key===" "||p.key==="z")&&Date.now()-L>Rs&&(f(N=>({...N,attacking:!0})),B(Date.now()),setTimeout(()=>f(N=>({...N,attacking:!1})),120))};return window.addEventListener("keydown",n),()=>window.removeEventListener("keydown",n)},[i,m,A,L]),t.useEffect(()=>{if(m||A)return;const n=setInterval(()=>{f(p=>{let u=p.vy+Ms,N=p.y+u;const R=N>=ue;return R&&(N=ue,u=0),{...p,y:N,vy:u,onGround:R}}),I(p=>{const u=i.x>p.x?Xt:-Xt,N=u>0?1:-1,R=u;let M=p.vy+Ms,b=p.y+M;const d=b>=ue;d&&(b=ue,M=0),d&&Math.random()<.04&&(M=Ts);let T=!1;return Math.abs(i.x-p.x)<Bt&&Date.now()-_>Rs&&(T=!0,w(Date.now()),setTimeout(()=>I(h=>({...h,attacking:!1})),120)),{...p,x:Math.max(Ct/2,Math.min(de-Ct/2,p.x+R)),y:b,vy:M,onGround:d,facing:N,attacking:T}}),i.attacking&&Math.abs(i.x+i.facing*Bt-x.x)<Ct/2&&Math.abs(i.y-x.y)<Ct/2&&(I(p=>({...p,health:Math.max(0,p.health-18)})),v(p=>p+200)),x.attacking&&Math.abs(x.x+x.facing*Bt-i.x)<ft/2&&Math.abs(x.y-i.y)<ft/2&&f(p=>({...p,health:Math.max(0,p.health-18)})),i.health<=0&&(j(!0),J("StreetFighter",s,c)),x.health<=0&&(k(!0),J("StreetFighter",s,c+500),v(p=>p+500))},Di);return()=>clearInterval(n)},[i,x,c,s,m,A,_]);function D(){f({x:100,y:ue,vx:0,vy:0,health:Zt,attacking:!1,facing:1,onGround:!0}),I({x:340,y:ue,vx:0,vy:0,health:Zt,attacking:!1,facing:-1,onGround:!0}),v(0),j(!1),k(!1),B(0),w(0)}return e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("h2",{children:"Street Fighter"}),e.jsx("canvas",{ref:o,width:de,height:qt,style:{background:"#b3e0ff",border:"3px solid #222",marginBottom:10}}),e.jsx("div",{style:{color:"#222",marginBottom:8},children:"Arrow keys/A/D: Move. Up/W: Jump. Space/Z: Attack. Defeat the enemy!"}),e.jsx($,{game:"StreetFighter"}),e.jsx("button",{onClick:D,style:{margin:8},children:"Restart"})]})},Wi=s=>e.jsx(_i,{userId:s.userId}),zi="data:image/png;base64,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",Oi="/assets/shape-CORa6uGx.png",Rn="/assets/vecteezy_crown-slot-machine_58273750-B1lA6sIg.png",Ui="_memoryMatchGame_1kxvg_1",Gi="_memoryGrid_1kxvg_11",Hi="_memoryCard_1kxvg_19",Yi="_flipped_1kxvg_31",Qt={memoryMatchGame:Ui,memoryGrid:Gi,memoryCard:Hi,flipped:Yi},hn=["ðŸŽ","ðŸŒ","ðŸ‡","ðŸ‰","ðŸ’","ðŸ‹","ðŸ","ðŸ¥"],Bs=[...hn,...hn];function Ns(s){return s.map(o=>[Math.random(),o]).sort((o,i)=>o[0]-i[0]).map(([,o])=>o)}const Fi=({onScore:s,userid:o,muted:i})=>{const[f,x]=t.useState(o||"");t.useEffect(()=>{var M,b,d;if(!o)try{const T=(M=window.Telegram)==null?void 0:M.WebApp;T&&((d=(b=T.initDataUnsafe)==null?void 0:b.user)!=null&&d.id)&&x(T.initDataUnsafe.user.id.toString())}catch{}},[o]);const[I,c]=t.useState(()=>Ns(Bs)),[v,m]=t.useState([]),[j,A]=t.useState([]),[k,L]=t.useState(0),[B,_]=t.useState(!1),[w,D]=t.useState(!1),[n,p]=t.useState(!1),u=M=>{v.length===2||v.includes(M)||j.includes(M)||B||(m(b=>[...b,M]),!i&&!H()&&Y("button"))};t.useEffect(()=>{if(v.length===2){L(d=>d+1);const[M,b]=v;I[M]===I[b]?(A(d=>[...d,M,b]),m([]),!i&&!H()&&Y("win"),p(!0),setTimeout(()=>p(!1),700)):(setTimeout(()=>m([]),800),!i&&!H()&&Y("spin"))}},[v,I,i]),t.useEffect(()=>{j.length===I.length&&I.length>0&&(_(!0),D(!0),!i&&!H()&&Y("bonus"),s(1e3-k*10),setTimeout(()=>D(!1),1200))},[j,I,k,s,i]);const N=()=>{c(Ns(Bs)),m([]),A([]),L(0),_(!1),D(!1),!i&&!H()&&Y("button")},R=Array.from({length:10},(M,b)=>({x:Math.random()*320,y:Math.random()*320,emoji:hn[b%hn.length],opacity:.1+Math.random()*.18}));return e.jsxs("div",{className:Qt.memoryMatchGame,style:{background:"radial-gradient(ellipse at 60% 40%, #23234a 70%, #18182a 100%)",borderRadius:18,boxShadow:"0 0 32px #ffe259",padding:24,maxWidth:340,margin:"0 auto",position:"relative",overflow:"hidden"},children:[e.jsx("svg",{width:340,height:340,style:{position:"absolute",left:0,top:0,zIndex:0},children:R.map((M,b)=>e.jsx("text",{x:M.x,y:M.y+Math.sin(Date.now()/800+b)*10,fontSize:"32",opacity:M.opacity,children:M.emoji},b))}),e.jsx("h4",{style:{color:"#ffe259",textShadow:"0 0 8px #fff",marginBottom:8,zIndex:2,position:"relative"},children:"Memory Match"}),e.jsx("div",{className:Qt.memoryGrid,style:{zIndex:2,position:"relative"},children:I.map((M,b)=>e.jsx("button",{className:Qt.memoryCard+(v.includes(b)||j.includes(b)?" "+Qt.flipped:""),onClick:()=>u(b),disabled:v.length===2||j.includes(b)||B,style:{boxShadow:v.includes(b)||j.includes(b)?"0 0 12px #ffe259":"0 0 4px #fff",background:v.includes(b)||j.includes(b)?"linear-gradient(135deg,#ffe259,#fff)":"#23234a",color:v.includes(b)||j.includes(b)?"#23234a":"#ffe259",fontWeight:700,fontSize:24,borderRadius:10,transition:"all 0.2s"},children:e.jsx("span",{children:v.includes(b)||j.includes(b)?M:"â“"})},b))}),e.jsxs("div",{style:{color:"#fff",fontWeight:700,fontSize:18,margin:"10px 0 2px",textShadow:"0 0 8px #ffe259",zIndex:2,position:"relative",animation:n?"popSuccess 0.5s":void 0},children:["Moves: ",k]}),B&&e.jsxs("div",{style:{color:"#1bbf4c",fontWeight:700,margin:"8px 0",fontSize:22,textShadow:"0 0 18px #fff, 0 0 24px #1bbf4c",animation:w?"popError 1.1s":void 0,zIndex:3,position:"relative"},children:["ðŸŽ‰ You matched all cards!",e.jsx("button",{onClick:N,style:{marginLeft:12,background:"#ffe259",borderRadius:6,padding:"4px 14px",fontWeight:700,color:"#23234a",boxShadow:"0 0 8px #ffe259",border:"none",fontSize:16,cursor:"pointer",transition:"background 0.2s, color 0.2s"},children:"Play Again"})]}),e.jsxs("div",{style:{color:"#ffe259",fontWeight:600,fontSize:14,marginTop:8,textShadow:"0 0 6px #fff"},children:["User: ",f||"Not connected"]}),e.jsx("style",{children:`
        @keyframes popSuccess {
          0% { transform: scale(1); }
          50% { transform: scale(1.2); }
          100% { transform: scale(1); }
        }
        @keyframes popError {
          0% { transform: scale(1); }
          50% { transform: scale(1.15); }
          100% { transform: scale(1); }
        }
      `})]})},dt=400,ut=480,Qe=24,ze=24,he=20,Cn=12,Bn=16,Vi=.7,Ki=-10,Jt=3.2,qi=2.2,Oe=[{y:420,left:20,right:380,ladders:[60,200,340]},{y:340,left:40,right:360,ladders:[120,300]},{y:260,left:20,right:380,ladders:[60,200,340]},{y:180,left:40,right:360,ladders:[120,300]},{y:100,left:20,right:380,ladders:[200]}],Nn=200,Pn=80;function Xi(s,o){return s.x<o.x+o.w&&s.x+s.w>o.x&&s.y<o.y+o.h&&s.y+s.h>o.y}const Zi=({userid:s,muted:o})=>{const[i,f]=t.useState(s||"");t.useEffect(()=>{var a,r,C;if(!s)try{const G=(a=window.Telegram)==null?void 0:a.WebApp;G&&((C=(r=G.initDataUnsafe)==null?void 0:r.user)!=null&&C.id)&&f(G.initDataUnsafe.user.id.toString())}catch{}},[s]);const x=t.useRef(null),[I,c]=t.useState(0),[v,m]=t.useState(!1),[j,A]=t.useState(!1),[k,L]=t.useState(!0),[B,_]=t.useState(!0),[w,D]=t.useState(!1),[n,p]=t.useState({x:40,y:Oe[0].y-ze,vx:0,vy:0,onGround:!0,climbing:!1,dir:1,lives:3}),[u,N]=t.useState([]),R=t.useRef({}),M=t.useRef(0);t.useEffect(()=>{const a=C=>{R.current[C.key]=!0,(C.key===" "||C.key==="ArrowUp")&&_(!1),!o&&!H()&&Y("button")},r=C=>{R.current[C.key]=!1};return window.addEventListener("keydown",a),window.addEventListener("keyup",r),()=>{window.removeEventListener("keydown",a),window.removeEventListener("keyup",r)}},[o]),t.useEffect(()=>{if(!k)return;let a,r=performance.now();function C(G){const P=Math.min((G-r)/16,2);r=G,y(P),W(),k&&(a=requestAnimationFrame(C))}return a=requestAnimationFrame(C),()=>cancelAnimationFrame(a)},[k,n,u,v,j]);const[b,d]=t.useState(!1),[T,h]=t.useState(!1);function y(a){if(v||j)return;const r={...n};r.climbing||(R.current.ArrowLeft?(r.vx=-Jt,r.dir=-1):R.current.ArrowRight?(r.vx=Jt,r.dir=1):r.vx=0),R.current[" "]&&r.onGround&&!r.climbing&&(r.vy=Ki,r.onGround=!1,!o&&!H()&&Y("spin"));let C=!1,G=0;for(let z=0;z<Oe.length;++z){const E=Oe[z];for(const O of E.ladders)Math.abs(r.x+Qe/2-O)<Bn&&Math.abs(r.y+ze-E.y)<32&&(C=!0,G=O)}C&&(R.current.ArrowUp||R.current.ArrowDown)?(r.climbing=!0,r.vx=0,R.current.ArrowUp?r.vy=-Jt:R.current.ArrowDown?r.vy=Jt:r.vy=0,r.x=G-Qe/2):C||(r.climbing=!1),r.climbing||(r.vy+=Vi*a),r.x+=r.vx*a,r.y+=r.vy*a,r.x=Math.max(0,Math.min(dt-Qe,r.x));let P=!1;for(const z of Oe)if(r.y+ze>=z.y&&r.y+ze<=z.y+Cn+4&&r.x+Qe>z.left&&r.x<z.right){P=!0,r.y=z.y-ze,r.vy=0,r.onGround=!0;break}if(!P&&!r.climbing&&(r.onGround=!1),Math.abs(r.x+Qe/2-Nn)<24&&Math.abs(r.y-Pn)<24){A(!0),c(z=>z+1e3),L(!1),d(!0),!o&&!H()&&Y("bonus"),setTimeout(()=>d(!1),1200);return}let g=u.map(z=>({...z}));for(const z of g){z.x+=z.vx*a;for(let E=0;E<Oe.length;++E){const O=Oe[E];z.y+he>=O.y&&z.y+he<=O.y+Cn+4&&z.x+he>O.left&&z.x<O.right&&(z.y=O.y-he,z.vy=0,(z.x<=O.left||z.x+he>=O.right)&&(z.vy=4))}if(z.y+=z.vy*a,z.y>ut&&(z.remove=!0),Xi({x:z.x,y:z.y,w:he,h:he},{x:r.x,y:r.y,w:Qe,h:ze})){c(E=>Math.max(0,E-100)),p(E=>({...E,lives:E.lives-1})),m(!0),L(!1),d(!0),!o&&!H()&&Y("die"),setTimeout(()=>d(!1),1200);return}}g=g.filter(z=>!z.remove),M.current+=1*a,M.current>60&&(g.push({x:40,y:80,vx:qi,vy:0}),M.current=0),N(g),p(r),c(z=>z+1),h(!0),setTimeout(()=>h(!1),300)}function W(){var r;const a=(r=x.current)==null?void 0:r.getContext("2d");if(a){a.clearRect(0,0,dt,ut),a.fillStyle="#222",a.fillRect(0,0,dt,ut);for(const C of Oe){a.fillStyle="#a0522d",a.fillRect(C.left,C.y,C.right-C.left,Cn);for(const G of C.ladders)a.fillStyle="#8ecae6",a.fillRect(G-Bn/2,C.y-40,Bn,40)}a.fillStyle="#ffb6c1",a.beginPath(),a.arc(Nn,Pn,14,0,Math.PI*2),a.fill(),a.fillStyle="#fff",a.font="bold 14px sans-serif",a.fillText("ðŸ‘¸",Nn-10,Pn+6);for(const C of u)a.fillStyle="#b5651d",a.beginPath(),a.arc(C.x+he/2,C.y+he/2,he/2,0,Math.PI*2),a.fill(),a.strokeStyle="#fff",a.stroke();a.fillStyle="#ffd700",a.fillRect(n.x,n.y,Qe,ze),a.fillStyle="#fff",a.font="bold 18px sans-serif",a.fillText("ðŸ§‘â€ðŸ”§",n.x+1,n.y+20),a.fillStyle="#fff",a.font="bold 16px sans-serif",a.save(),T&&(a.shadowColor="#ffe259",a.shadowBlur=16),a.fillText(`Score: ${I}`,10,20),a.restore(),a.fillText(`Lives: ${n.lives}`,300,20),B&&(a.fillStyle="rgba(0,0,0,0.7)",a.fillRect(30,120,340,120),a.fillStyle="#fff",a.font="bold 18px sans-serif",a.fillText("Donkey Kong (Mini)",110,150),a.font="14px sans-serif",a.fillText("Arrow keys: Move/jump/climb",80,180),a.fillText("Space: Jump",80,200),a.fillText("Reach the princess, avoid barrels!",80,220),a.fillText("Press any key to start",100,240)),v&&(a.save(),a.globalAlpha=.9,a.fillStyle="#18182a",a.fillRect(60,180,280,80),a.globalAlpha=1,a.fillStyle="#fd79a8",a.font="bold 28px sans-serif",a.shadowColor="#fff",a.shadowBlur=b?24:0,a.fillText("Game Over",120,220),a.restore()),j&&(a.save(),a.globalAlpha=.9,a.fillStyle="#18182a",a.fillRect(60,180,280,80),a.globalAlpha=1,a.fillStyle="#ffe259",a.font="bold 28px sans-serif",a.shadowColor="#fff",a.shadowBlur=b?24:0,a.fillText("You Win!",140,220),a.restore())}}function U(){p({x:40,y:Oe[0].y-ze,vx:0,vy:0,onGround:!0,climbing:!1,dir:1,lives:3}),N([]),c(0),m(!1),A(!1),L(!0),_(!0),d(!1),!o&&!H()&&Y("button")}async function S(){D(!0);try{const a=i||localStorage.getItem("userId")||"anon";await J("donkey_kong",a,I)}catch{}D(!1)}const l=Array.from({length:18},()=>({x:Math.random()*dt,y:Math.random()*ut,r:3+Math.random()*2,opacity:.1+Math.random()*.18}));return e.jsxs("div",{className:"arcade-game-container",style:{display:"flex",flexDirection:"column",alignItems:"center",background:"radial-gradient(ellipse at 60% 40%, #23234a 70%, #18182a 100%)",borderRadius:18,boxShadow:"0 0 32px #fd79a8",padding:24,maxWidth:440,margin:"0 auto",position:"relative",overflow:"hidden"},children:[e.jsx("svg",{width:dt,height:ut,style:{position:"absolute",left:0,top:0,zIndex:0},children:l.map((a,r)=>e.jsx("circle",{cx:a.x,cy:a.y+Math.sin(Date.now()/800+r)*10,r:a.r,fill:"#fd79a8",opacity:a.opacity},r))}),e.jsx("h2",{style:{color:"#fd79a8",textShadow:"0 0 8px #fff",marginBottom:8,zIndex:2,position:"relative"},children:"Donkey Kong"}),e.jsx("canvas",{ref:x,width:dt,height:ut,style:{border:"2px solid #fff",background:"transparent",marginBottom:16,maxWidth:"100%",height:"auto",zIndex:2,position:"relative"},tabIndex:0}),(v||j)&&e.jsxs("div",{style:{margin:8},children:[e.jsx("button",{onClick:U,style:{marginRight:12,background:"#fd79a8",color:"#fff",borderRadius:10,padding:"8px 28px",fontWeight:700,fontSize:18,boxShadow:"0 0 8px #fd79a8",border:"none",cursor:"pointer",transition:"background 0.2s, color 0.2s"},children:"Restart"}),e.jsx("button",{onClick:S,disabled:w,style:{background:"#ffe259",color:"#23234a",borderRadius:10,padding:"8px 28px",fontWeight:700,fontSize:18,boxShadow:"0 0 8px #ffe259",border:"none",cursor:"pointer",transition:"background 0.2s, color 0.2s"},children:w?"Submitting...":"Submit Score"})]}),e.jsxs("div",{style:{color:"#fd79a8",fontWeight:600,fontSize:14,marginTop:8,textShadow:"0 0 6px #fff"},children:["User: ",i||"Not connected"]}),e.jsx("div",{style:{marginTop:24,width:"100%"},children:e.jsx($,{gameId:"donkey_kong"})}),e.jsx("style",{children:`
        @keyframes popSuccess {
          0% { transform: scale(1); }
          50% { transform: scale(1.2); }
          100% { transform: scale(1); }
        }
        @keyframes popError {
          0% { transform: scale(1); }
          50% { transform: scale(1.15); }
          100% { transform: scale(1); }
        }
      `})]})},Qi=({onBack:s})=>e.jsxs("div",{style:{padding:24},children:[e.jsx("button",{onClick:s,style:{marginBottom:16},children:"â† Back to Arcade"}),e.jsx(Zi,{})]}),Me=400,rt=480,Je=40,Ln=18,Nt=rt-40,Pt=4,Lt=12,Ps=5,Ls=10,ht=28,xt=18,Ds=8,_s=18,Ws=60,Ji=.7,zs=18,$i=2.2,el=.008,tl=()=>{const s=t.useRef(null),[o,i]=t.useState(0),[f,x]=t.useState(!1),[I,c]=t.useState(!1),[v,m]=t.useState(!0),[j,A]=t.useState(!0),[k,L]=t.useState(!1),[B,_]=t.useState(Me/2-Je/2),[w,D]=t.useState(3),[n,p]=t.useState([]),[u,N]=t.useState([]),[R,M]=t.useState(1),[b,d]=t.useState(0),T=t.useRef({});t.useEffect(()=>{const S=[];for(let l=0;l<Ps;++l)for(let a=0;a<Ls;++a)S.push({x:30+a*(ht+Ds),y:Ws+l*(xt+_s),alive:!0});N(S)},[]),t.useEffect(()=>{const S=a=>{T.current[a.key]=!0,(a.key===" "||a.key==="ArrowUp")&&A(!1)},l=a=>{T.current[a.key]=!1};return window.addEventListener("keydown",S),window.addEventListener("keyup",l),()=>{window.removeEventListener("keydown",S),window.removeEventListener("keyup",l)}},[]),t.useEffect(()=>{if(!v)return;let S,l=performance.now();function a(r){const C=Math.min((r-l)/16,2);l=r,h(C),y(),v&&(S=requestAnimationFrame(a))}return S=requestAnimationFrame(a),()=>cancelAnimationFrame(S)},[v,B,n,u,f,I]);function h(S){if(f||I)return;let l=B;T.current.ArrowLeft&&(l-=4*S),T.current.ArrowRight&&(l+=4*S),l=Math.max(0,Math.min(Me-Je,l)),_(l),T.current[" "]&&n.filter(g=>!g.fromEnemy).length<2&&(p(g=>[...g,{x:l+Je/2-Pt/2,y:Nt,vy:-5.5,fromEnemy:!1}]),T.current[" "]=!1);let a=n.map(g=>({...g,y:g.y+g.vy*S}));a=a.filter(g=>g.y>-Lt&&g.y<rt+Lt);const r=Math.min(...u.filter(g=>g.alive).map(g=>g.x),Me),C=Math.max(...u.filter(g=>g.alive).map(g=>g.x+ht),0);let G=R,P=b;if(r<=10&&G===-1){G=1,P++;for(const g of u)g.alive&&(g.y+=zs)}else if(C>=Me-10&&G===1){G=-1,P++;for(const g of u)g.alive&&(g.y+=zs)}for(const g of u)g.alive&&(g.x+=G*Ji*S*(1+P*.1));M(G),d(P);for(const g of u)g.alive&&Math.random()<el*S&&p(z=>[...z,{x:g.x+ht/2-Pt/2,y:g.y+xt,vy:$i,fromEnemy:!0}]);for(const g of a)if(g.fromEnemy)g.x<l+Je&&g.x+Pt>l&&g.y<Nt+Ln&&g.y+Lt>Nt&&(D(z=>z-1),g.y=rt+1e3);else for(const z of u)z.alive&&g.x<z.x+ht&&g.x+Pt>z.x&&g.y<z.y+xt&&g.y+Lt>z.y&&(z.alive=!1,g.y=-1e3,i(E=>E+100));p(a),N([...u]),u.every(g=>!g.alive)&&(c(!0),m(!1),i(g=>g+1e3)),(w<=0||u.some(g=>g.alive&&g.y+xt>=Nt))&&(x(!0),m(!1))}function y(){var l;const S=(l=s.current)==null?void 0:l.getContext("2d");if(S){S.clearRect(0,0,Me,rt),S.fillStyle="#000",S.fillRect(0,0,Me,rt);for(let a=0;a<60;++a)S.fillStyle="#fff",S.globalAlpha=.2+.8*Math.random(),S.beginPath(),S.arc(Math.random()*Me,Math.random()*rt,Math.random()*1.5,0,Math.PI*2),S.fill();S.globalAlpha=1;for(const a of u)a.alive&&(S.save(),S.translate(a.x+ht/2,a.y+xt/2),S.scale(1.2,1.2),S.fillStyle="#39f",S.beginPath(),S.arc(0,0,10,0,Math.PI*2),S.fill(),S.fillStyle="#fff",S.font="bold 16px sans-serif",S.fillText("ðŸ‘¾",-10,7),S.restore());S.save(),S.translate(B+Je/2,Nt+Ln/2),S.fillStyle="#0f0",S.beginPath(),S.ellipse(0,0,Je/2,Ln/2,0,0,Math.PI*2),S.fill(),S.fillStyle="#fff",S.font="bold 18px sans-serif",S.fillText("ðŸš€",-12,8),S.restore();for(const a of n)S.fillStyle=a.fromEnemy?"#f33":"#ff0",S.fillRect(a.x,a.y,Pt,Lt);S.fillStyle="#fff",S.font="bold 16px sans-serif",S.fillText(`Score: ${o}`,10,20),S.fillText(`Lives: ${w}`,320,20),j&&(S.fillStyle="rgba(0,0,0,0.7)",S.fillRect(30,120,340,120),S.fillStyle="#fff",S.font="bold 18px sans-serif",S.fillText("Space Invaders (Mini)",90,150),S.font="14px sans-serif",S.fillText("Arrow keys: Move",80,180),S.fillText("Space: Fire",80,200),S.fillText("Destroy all invaders!",80,220),S.fillText("Press any key to start",100,240)),f&&(S.fillStyle="rgba(0,0,0,0.7)",S.fillRect(60,180,280,80),S.fillStyle="#fff",S.font="bold 28px sans-serif",S.fillText("Game Over",120,220)),I&&(S.fillStyle="rgba(0,0,0,0.7)",S.fillRect(60,180,280,80),S.fillStyle="#fff",S.font="bold 28px sans-serif",S.fillText("You Win!",140,220))}}function W(){_(Me/2-Je/2),D(3),p([]),i(0),x(!1),c(!1),m(!0),A(!0);const S=[];for(let l=0;l<Ps;++l)for(let a=0;a<Ls;++a)S.push({x:30+a*(ht+Ds),y:Ws+l*(xt+_s),alive:!0});N(S),M(1),d(0)}async function U(){L(!0);try{const S=localStorage.getItem("userId")||"anon";await J("space_invaders",S,o)}catch{}L(!1)}return e.jsxs("div",{className:"arcade-game-container",style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx("h2",{children:"Space Invaders"}),e.jsx("canvas",{ref:s,width:Me,height:rt,style:{border:"2px solid #fff",background:"#000",marginBottom:16,maxWidth:"100%",height:"auto"},tabIndex:0}),(f||I)&&e.jsxs("div",{style:{margin:8},children:[e.jsx("button",{onClick:W,style:{marginRight:12},children:"Restart"}),e.jsx("button",{onClick:U,disabled:k,children:k?"Submitting...":"Submit Score"})]}),e.jsx("div",{style:{marginTop:24,width:"100%"},children:e.jsx($,{gameId:"space_invaders"})})]})},nl=s=>{const{onBack:o}=s;return e.jsxs("div",{style:{padding:24},children:[e.jsx("button",{onClick:o,style:{marginBottom:16},children:"â† Back to Arcade"}),e.jsx(tl,{})]})},ee=400,te=480,Ue=16,Dn=18,Os=12,_n=4,Us=8,Gs=1.5,Hs=.18,Ys=.09,$t=5.5,sl=.01;function Wn(s,o,i,f){return Math.sqrt((s-i)**2+(o-f)**2)}const ol=()=>{const s=t.useRef(null),[o,i]=t.useState(0),[f,x]=t.useState(!1),[I,c]=t.useState(!1),[v,m]=t.useState(!0),[j,A]=t.useState(!0),[k,L]=t.useState(!1),[B,_]=t.useState({x:200,y:400,vx:0,vy:0,angle:-Math.PI/2,alive:!0}),[w,D]=t.useState([]),[n,p]=t.useState({x:200,y:80,vx:0,vy:0,angle:0,alive:!0}),[u,N]=t.useState(()=>{const h=[];for(let y=0;y<Us;++y)h.push({x:Math.random()*ee,y:Math.random()*(te-200)+60,vx:(Math.random()-.5)*1.2,vy:(Math.random()-.5)*1.2});return h}),R=t.useRef({});t.useEffect(()=>{const h=W=>{R.current[W.key]=!0,(W.key===" "||W.key==="ArrowUp")&&A(!1)},y=W=>{R.current[W.key]=!1};return window.addEventListener("keydown",h),window.addEventListener("keyup",y),()=>{window.removeEventListener("keydown",h),window.removeEventListener("keyup",y)}},[]),t.useEffect(()=>{if(!v)return;let h,y=performance.now();function W(U){const S=Math.min((U-y)/16,2);y=U,M(S),b(),v&&(h=requestAnimationFrame(W))}return h=requestAnimationFrame(W),()=>cancelAnimationFrame(h)},[v,B,w,n,u,f,I]);function M(h){if(f||I)return;const y={...B};R.current.ArrowLeft&&(y.angle-=Ys*h),R.current.ArrowRight&&(y.angle+=Ys*h),R.current.ArrowUp&&(y.vx+=Math.cos(y.angle)*Hs*h*2,y.vy+=Math.sin(y.angle)*Hs*h*2),y.vx*=.99,y.vy*=.99,y.x+=y.vx*h*2,y.y+=y.vy*h*2,y.x<0&&(y.x+=ee),y.x>ee&&(y.x-=ee),y.y<0&&(y.y+=te),y.y>te&&(y.y-=te),R.current[" "]&&w.length<3&&(D(l=>[...l,{x:y.x+Math.cos(y.angle)*Ue,y:y.y+Math.sin(y.angle)*Ue,vx:Math.cos(y.angle)*$t,vy:Math.sin(y.angle)*$t}]),R.current[" "]=!1);let W=w.map(l=>({...l,x:l.x+l.vx*h*2,y:l.y+l.vy*h*2}));W=W.filter(l=>l.x>0&&l.x<ee&&l.y>0&&l.y<te);const U=u.map(l=>({...l,x:l.x+l.vx*h,y:l.y+l.vy*h}));for(const l of U)l.x<0&&(l.x+=ee),l.x>ee&&(l.x-=ee),l.y<0&&(l.y+=te),l.y>te&&(l.y-=te);for(const l of W)for(const a of U)Wn(l.x,l.y,a.x,a.y)<Os+_n&&(a.x=Math.random()*ee,a.y=Math.random()*(te-200)+60,i(r=>r+100),l.x=-1e3);const S={...n};if(S.alive){const l=y.x-S.x,a=y.y-S.y,r=Math.sqrt(l*l+a*a);if(S.vx+=l/r*Gs*.04*h,S.vy+=a/r*Gs*.04*h,S.x+=S.vx*h*2,S.y+=S.vy*h*2,S.x<0&&(S.x+=ee),S.x>ee&&(S.x-=ee),S.y<0&&(S.y+=te),S.y>te&&(S.y-=te),Wn(S.x,S.y,y.x,y.y)<Dn+Ue){_(C=>({...C,alive:!1})),x(!0),m(!1);return}Math.random()<sl*h&&D(C=>[...C,{x:S.x,y:S.y,vx:(y.x-S.x)/r*$t,vy:(y.y-S.y)/r*$t}])}for(const l of W)S.alive&&Wn(l.x,l.y,S.x,S.y)<Dn+_n&&(S.alive=!1,i(a=>a+2e3),c(!0),m(!1));_(y),D(W),N(U),p(S)}function b(){var y;const h=(y=s.current)==null?void 0:y.getContext("2d");if(h){h.clearRect(0,0,ee,te),h.fillStyle="#000",h.fillRect(0,0,ee,te);for(let W=0;W<60;++W)h.fillStyle="#fff",h.globalAlpha=.2+.8*Math.random(),h.beginPath(),h.arc(Math.random()*ee,Math.random()*te,Math.random()*1.5,0,Math.PI*2),h.fill();h.globalAlpha=1;for(const W of u)h.save(),h.translate(W.x,W.y),h.fillStyle="#888",h.beginPath(),h.arc(0,0,Os,0,Math.PI*2),h.fill(),h.font="bold 16px sans-serif",h.fillStyle="#fff",h.fillText("ðŸª¨",-10,7),h.restore();n.alive&&(h.save(),h.translate(n.x,n.y),h.rotate(Math.sin(Date.now()/200)*.1),h.fillStyle="#f00",h.beginPath(),h.arc(0,0,Dn,0,Math.PI*2),h.fill(),h.font="bold 22px sans-serif",h.fillStyle="#fff",h.fillText("ðŸ‘¹",-14,12),h.restore()),B.alive&&(h.save(),h.translate(B.x,B.y),h.rotate(B.angle),h.fillStyle="#0ff",h.beginPath(),h.moveTo(Ue,0),h.lineTo(-Ue/2,Ue/2),h.lineTo(-Ue/2,-Ue/2),h.closePath(),h.fill(),h.font="bold 18px sans-serif",h.fillStyle="#fff",h.fillText("ðŸš€",-12,8),h.restore());for(const W of w)h.save(),h.translate(W.x,W.y),h.fillStyle="#ff0",h.beginPath(),h.arc(0,0,_n,0,Math.PI*2),h.fill(),h.restore();h.fillStyle="#fff",h.font="bold 16px sans-serif",h.fillText(`Score: ${o}`,10,20),j&&(h.fillStyle="rgba(0,0,0,0.7)",h.fillRect(30,120,340,120),h.fillStyle="#fff",h.font="bold 18px sans-serif",h.fillText("Sinistar (Mini)",120,150),h.font="14px sans-serif",h.fillText("Arrow keys: Rotate/Thrust",80,180),h.fillText("Space: Fire",80,200),h.fillText("Destroy Sinistar and survive!",80,220),h.fillText("Press any key to start",100,240)),f&&(h.fillStyle="rgba(0,0,0,0.7)",h.fillRect(60,180,280,80),h.fillStyle="#fff",h.font="bold 28px sans-serif",h.fillText("Game Over",120,220)),I&&(h.fillStyle="rgba(0,0,0,0.7)",h.fillRect(60,180,280,80),h.fillStyle="#fff",h.font="bold 28px sans-serif",h.fillText("You Win!",140,220))}}function d(){_({x:200,y:400,vx:0,vy:0,angle:-Math.PI/2,alive:!0}),D([]),p({x:200,y:80,vx:0,vy:0,angle:0,alive:!0});const h=[];for(let y=0;y<Us;++y)h.push({x:Math.random()*ee,y:Math.random()*(te-200)+60,vx:(Math.random()-.5)*1.2,vy:(Math.random()-.5)*1.2});N(h),i(0),x(!1),c(!1),m(!0),A(!0)}async function T(){L(!0);try{const h=localStorage.getItem("userId")||"anon";await J("sinistar",h,o)}catch{}L(!1)}return e.jsxs("div",{className:"arcade-game-container",style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx("h2",{children:"Sinistar"}),e.jsx("canvas",{ref:s,width:ee,height:te,style:{border:"2px solid #fff",background:"#000",marginBottom:16,maxWidth:"100%",height:"auto"},tabIndex:0}),(f||I)&&e.jsxs("div",{style:{margin:8},children:[e.jsx("button",{onClick:d,style:{marginRight:12},children:"Restart"}),e.jsx("button",{onClick:T,disabled:k,children:k?"Submitting...":"Submit Score"})]}),e.jsx("div",{style:{marginTop:24,width:"100%"},children:e.jsx($,{gameId:"sinistar"})})]})},al=({onBack:s})=>e.jsxs("div",{style:{padding:24},children:[e.jsx("button",{onClick:s,style:{marginBottom:16},children:"â† Back to Arcade"}),e.jsx(ol,{})]}),$e=400,et=480,xe=24,Ge=22,ge=5,en=2.7,gt=1.5,rl=.01,il=2.5,Fs=[{x:120,y:200,w:40,h:20},{x:260,y:320,w:60,h:20}],ll=({userid:s,muted:o})=>{const[i,f]=t.useState(s||"");t.useEffect(()=>{var r,C,G;if(!s)try{const P=(r=window.Telegram)==null?void 0:r.WebApp;P&&((G=(C=P.initDataUnsafe)==null?void 0:C.user)!=null&&G.id)&&f(P.initDataUnsafe.user.id.toString())}catch{}},[s]);const x=t.useRef(null),[I,c]=t.useState(0),[v,m]=t.useState(!1),[j,A]=t.useState(!1),[k,L]=t.useState(!0),[B,_]=t.useState(!0),[w,D]=t.useState(!1),[n,p]=t.useState({x:200,y:420,vx:0,vy:0,alive:!0}),[u,N]=t.useState([]),[R,M]=t.useState([{x:80,y:80,vx:gt,vy:0,alive:!0},{x:320,y:160,vx:-gt,vy:0,alive:!0},{x:200,y:240,vx:gt,vy:0,alive:!0}]),b=t.useRef({});t.useEffect(()=>{const r=G=>{b.current[G.key]=!0,(G.key===" "||G.key==="ArrowUp")&&_(!1),!o&&!H()&&Y("button")},C=G=>{b.current[G.key]=!1};return window.addEventListener("keydown",r),window.addEventListener("keyup",C),()=>{window.removeEventListener("keydown",r),window.removeEventListener("keyup",C)}},[o]),t.useEffect(()=>{if(!k)return;let r,C=performance.now();function G(P){const g=Math.min((P-C)/16,2);C=P,W(g),U(),k&&(r=requestAnimationFrame(G))}return r=requestAnimationFrame(G),()=>cancelAnimationFrame(r)},[k,n,u,R,v,j]);const[d,T]=t.useState(!1),[h,y]=t.useState(!1);function W(r){if(v||j)return;const C={...n};C.vx=0,C.vy=0,b.current.ArrowLeft&&(C.vx=-en),b.current.ArrowRight&&(C.vx=en),b.current.ArrowUp&&(C.vy=-en),b.current.ArrowDown&&(C.vy=en);const G=C.x+C.vx*r*2,P=C.y+C.vy*r*2;let g=!1;for(const O of Fs)G<O.x+O.w&&G+xe>O.x&&P<O.y+O.h&&P+xe>O.y&&(g=!0);g||(C.x=Math.max(0,Math.min($e-xe,G)),C.y=Math.max(0,Math.min(et-xe,P))),p(C),b.current[" "]&&u.filter(O=>!O.fromEnemy).length<2&&(N(O=>[...O,{x:C.x+xe/2-ge/2,y:C.y,vx:0,vy:-6.5,fromEnemy:!1}]),b.current[" "]=!1,!o&&!H()&&Y("spin"));let z=u.map(O=>({...O,x:O.x+O.vx*r*2,y:O.y+O.vy*r*2}));z=z.filter(O=>O.y>-ge&&O.y<et+ge);const E=R.map(O=>({...O}));for(const O of E)O.alive&&(O.x+=O.vx*r*2,(O.x<0||O.x>$e-Ge)&&(O.vx*=-1),Math.random()<rl*r&&N(F=>[...F,{x:O.x+Ge/2-ge/2,y:O.y+Ge,vx:0,vy:il,fromEnemy:!0}]));M(E);for(const O of z)if(O.fromEnemy){if(O.x<C.x+xe&&O.x+ge>C.x&&O.y<C.y+xe&&O.y+ge>C.y){p(F=>({...F,alive:!1})),m(!0),L(!1),T(!0),!o&&!H()&&Y("die"),setTimeout(()=>T(!1),1200);return}}else for(const F of E)F.alive&&O.x<F.x+Ge&&O.x+ge>F.x&&O.y<F.y+Ge&&O.y+ge>F.y&&(F.alive=!1,O.y=-1e3,c(V=>V+500),!o&&!H()&&Y("win"),y(!0),setTimeout(()=>y(!1),500));N(z),E.every(O=>!O.alive)&&(A(!0),L(!1),c(O=>O+2e3),T(!0),!o&&!H()&&Y("bonus"),setTimeout(()=>T(!1),1200))}function U(){var C;const r=(C=x.current)==null?void 0:C.getContext("2d");if(r){r.clearRect(0,0,$e,et),r.fillStyle="#2e2e2e",r.fillRect(0,0,$e,et);for(const G of Fs)r.fillStyle="#8d5524",r.fillRect(G.x,G.y,G.w,G.h);for(const G of R)G.alive&&(r.save(),r.translate(G.x+Ge/2,G.y+Ge/2),r.fillStyle="#f00",r.beginPath(),r.arc(0,0,Ge/2,0,Math.PI*2),r.fill(),r.font="bold 16px sans-serif",r.fillStyle="#fff",r.fillText("ðŸ‘®",-10,7),r.restore());n.alive&&(r.save(),r.translate(n.x+xe/2,n.y+xe/2),r.fillStyle="#0ff",r.beginPath(),r.arc(0,0,xe/2,0,Math.PI*2),r.fill(),r.font="bold 18px sans-serif",r.fillStyle="#fff",r.fillText("ðŸª–",-12,8),r.restore());for(const G of u)r.fillStyle=G.fromEnemy?"#f33":"#ff0",r.fillRect(G.x,G.y,ge,ge);r.fillStyle="#fff",r.font="bold 16px sans-serif",r.save(),h&&(r.shadowColor="#ffe259",r.shadowBlur=16),r.fillText(`Score: ${I}`,10,20),r.restore(),B&&(r.fillStyle="rgba(0,0,0,0.7)",r.fillRect(30,120,340,120),r.fillStyle="#fff",r.font="bold 18px sans-serif",r.fillText("Commando (Mini)",120,150),r.font="14px sans-serif",r.fillText("Arrow keys: Move",80,180),r.fillText("Space: Fire",80,200),r.fillText("Defeat all enemies!",80,220),r.fillText("Press any key to start",100,240)),v&&(r.save(),r.globalAlpha=.9,r.fillStyle="#18182a",r.fillRect(60,180,280,80),r.globalAlpha=1,r.fillStyle="#fd79a8",r.font="bold 28px sans-serif",r.shadowColor="#fff",r.shadowBlur=d?24:0,r.fillText("Game Over",120,220),r.restore()),j&&(r.save(),r.globalAlpha=.9,r.fillStyle="#18182a",r.fillRect(60,180,280,80),r.globalAlpha=1,r.fillStyle="#ffe259",r.font="bold 28px sans-serif",r.shadowColor="#fff",r.shadowBlur=d?24:0,r.fillText("You Win!",140,220),r.restore())}}function S(){p({x:200,y:420,vx:0,vy:0,alive:!0}),N([]),c(0),m(!1),A(!1),L(!0),_(!0),T(!1),!o&&!H()&&Y("button"),M([{x:80,y:80,vx:gt,vy:0,alive:!0},{x:320,y:160,vx:-gt,vy:0,alive:!0},{x:200,y:240,vx:gt,vy:0,alive:!0}])}async function l(){D(!0);try{const r=i||localStorage.getItem("userId")||"anon";await J("commando",r,I)}catch{}D(!1)}const a=Array.from({length:18},()=>({x:Math.random()*$e,y:Math.random()*et,r:3+Math.random()*2,opacity:.1+Math.random()*.18}));return e.jsxs("div",{className:"arcade-game-container",style:{display:"flex",flexDirection:"column",alignItems:"center",background:"radial-gradient(ellipse at 60% 40%, #23234a 70%, #18182a 100%)",borderRadius:18,boxShadow:"0 0 32px #fd79a8",padding:24,maxWidth:440,margin:"0 auto",position:"relative",overflow:"hidden"},children:[e.jsx("svg",{width:$e,height:et,style:{position:"absolute",left:0,top:0,zIndex:0},children:a.map((r,C)=>e.jsx("circle",{cx:r.x,cy:r.y+Math.sin(Date.now()/800+C)*10,r:r.r,fill:"#fd79a8",opacity:r.opacity},C))}),e.jsx("h2",{style:{color:"#fd79a8",textShadow:"0 0 8px #fff",marginBottom:8,zIndex:2,position:"relative"},children:"Commando"}),e.jsx("canvas",{ref:x,width:$e,height:et,style:{border:"2px solid #fff",background:"transparent",marginBottom:16,maxWidth:"100%",height:"auto",zIndex:2,position:"relative"},tabIndex:0}),(v||j)&&e.jsxs("div",{style:{margin:8},children:[e.jsx("button",{onClick:S,style:{marginRight:12,background:"#fd79a8",color:"#fff",borderRadius:10,padding:"8px 28px",fontWeight:700,fontSize:18,boxShadow:"0 0 8px #fd79a8",border:"none",cursor:"pointer",transition:"background 0.2s, color 0.2s"},children:"Restart"}),e.jsx("button",{onClick:l,disabled:w,style:{background:"#ffe259",color:"#23234a",borderRadius:10,padding:"8px 28px",fontWeight:700,fontSize:18,boxShadow:"0 0 8px #ffe259",border:"none",cursor:"pointer",transition:"background 0.2s, color 0.2s"},children:w?"Submitting...":"Submit Score"})]}),e.jsxs("div",{style:{color:"#fd79a8",fontWeight:600,fontSize:14,marginTop:8,textShadow:"0 0 6px #fff"},children:["User: ",i||"Not connected"]}),e.jsx("div",{style:{marginTop:24,width:"100%"},children:e.jsx($,{gameId:"commando"})}),e.jsx("style",{children:`
        @keyframes popSuccess {
          0% { transform: scale(1); }
          50% { transform: scale(1.2); }
          100% { transform: scale(1); }
        }
        @keyframes popError {
          0% { transform: scale(1); }
          50% { transform: scale(1.15); }
          100% { transform: scale(1); }
        }
      `})]})},cl=()=>e.jsxs("div",{style:{maxWidth:420,margin:"0 auto"},children:[e.jsx("button",{onClick:()=>window.history.back(),style:{margin:"12px 0"},children:"â† Back to Arcade"}),e.jsx(ll,{})]}),Re=400,pe=480,tt=32,tn=16,oe=18,Vs=12,Ce=6,nn=3.2,nt=18,Ks=Array.from({length:24},(s,o)=>({x:20+o%8*45,y:80+Math.floor(o/8)*60,alive:!0})),fl=({userid:s,muted:o})=>{const[i,f]=t.useState(s||"");t.useEffect(()=>{var g,z,E;if(!s)try{const O=(g=window.Telegram)==null?void 0:g.WebApp;O&&((E=(z=O.initDataUnsafe)==null?void 0:z.user)!=null&&E.id)&&f(O.initDataUnsafe.user.id.toString())}catch{}},[s]);const x=t.useRef(null),[I,c]=t.useState(0),[v,m]=t.useState(!1),[j,A]=t.useState(!1),[k,L]=t.useState(!0),[B,_]=t.useState(!0),[w,D]=t.useState(!1),[n,p]=t.useState(Re/2-tt/2),[u,N]=t.useState(pe-40),[R,M]=t.useState([]),[b,d]=t.useState(()=>{const g=[];for(let z=0;z<Vs;++z)g.push({x:40+z*(oe+2),y:40,vx:1.2,vy:0,alive:!0});return g}),[T,h]=t.useState(Ks.map(g=>({...g}))),y=t.useRef({});t.useEffect(()=>{const g=E=>{y.current[E.key]=!0,(E.key===" "||E.key==="ArrowUp")&&_(!1),!o&&!H()&&Y("button")},z=E=>{y.current[E.key]=!1};return window.addEventListener("keydown",g),window.addEventListener("keyup",z),()=>{window.removeEventListener("keydown",g),window.removeEventListener("keyup",z)}},[o]),t.useEffect(()=>{if(!k)return;let g,z=performance.now();function E(O){const F=Math.min((O-z)/16,2);z=O,a(F),r(),k&&(g=requestAnimationFrame(E))}return g=requestAnimationFrame(E),()=>cancelAnimationFrame(g)},[k,n,u,R,b,T,v,j]);const[W,U]=t.useState(!1),[S,l]=t.useState(!1);function a(g){if(v||j)return;let z=n,E=u;y.current.ArrowLeft&&(z-=nn*g*2),y.current.ArrowRight&&(z+=nn*g*2),y.current.ArrowUp&&(E-=nn*g*2),y.current.ArrowDown&&(E+=nn*g*2),z=Math.max(0,Math.min(Re-tt,z)),E=Math.max(pe-120,Math.min(pe-tn,E)),p(z),N(E),y.current[" "]&&R.length<2&&(M(V=>[...V,{x:z+tt/2-Ce/2,y:E,vy:-7}]),y.current[" "]=!1,!o&&!H()&&Y("spin"));let O=R.map(V=>({...V,y:V.y+V.vy*g*2}));O=O.filter(V=>V.y>-Ce&&V.y<pe+Ce);const F=b.map(V=>({...V}));for(let V=0;V<F.length;++V){const q=F[V];if(!q.alive)continue;q.x+=q.vx*g*2;let re=!1;(q.x<0||q.x>Re-oe)&&(re=!0);for(const K of T)K.alive&&q.x<K.x+nt&&q.x+oe>K.x&&q.y<K.y+nt&&q.y+oe>K.y&&(re=!0);if(re&&(q.vx*=-1,q.y+=oe+2),q.x<z+tt&&q.x+oe>z&&q.y<E+tn&&q.y+oe>E){m(!0),L(!1);return}}for(const V of O){for(const q of F)q.alive&&V.x<q.x+oe&&V.x+Ce>q.x&&V.y<q.y+oe&&V.y+Ce>q.y&&(q.alive=!1,V.y=-1e3,c(re=>re+100),!o&&!H()&&Y("win"),l(!0),setTimeout(()=>l(!1),500));for(const q of T)q.alive&&V.x<q.x+nt&&V.x+Ce>q.x&&V.y<q.y+nt&&V.y+Ce>q.y&&(q.alive=!1,V.y=-1e3,c(re=>re+10),!o&&!H()&&Y("button"))}M(O),d(F),h([...T]),F.every(V=>!V.alive)&&(A(!0),L(!1),c(V=>V+1e3),U(!0),!o&&!H()&&Y("bonus"),setTimeout(()=>U(!1),1200))}function r(){var z;const g=(z=x.current)==null?void 0:z.getContext("2d");if(g){g.clearRect(0,0,Re,pe),g.fillStyle="#000",g.fillRect(0,0,Re,pe);for(const E of T)E.alive&&(g.save(),g.translate(E.x+nt/2,E.y+nt/2),g.fillStyle="#a52a2a",g.beginPath(),g.arc(0,0,nt/2,0,Math.PI*2),g.fill(),g.font="bold 16px sans-serif",g.fillStyle="#fff",g.fillText("ðŸ„",-10,7),g.restore());for(const E of b)E.alive&&(g.save(),g.translate(E.x+oe/2,E.y+oe/2),g.shadowColor="#0f0",g.shadowBlur=12,g.fillStyle="#0f0",g.beginPath(),g.arc(0,0,oe/2,0,Math.PI*2),g.fill(),g.shadowBlur=0,g.font="bold 16px sans-serif",g.fillStyle="#fff",g.fillText("ðŸ›",-10,7),g.restore());g.save(),g.translate(n+tt/2,u+tn/2),g.fillStyle="#0ff",g.beginPath(),g.ellipse(0,0,tt/2,tn/2,0,0,Math.PI*2),g.fill(),g.font="bold 18px sans-serif",g.fillStyle="#fff",g.fillText("ðŸ•¹ï¸",-12,8),g.restore();for(const E of R)g.fillStyle="#ff0",g.fillRect(E.x,E.y,Ce,Ce);g.fillStyle="#fff",g.font="bold 16px sans-serif",g.save(),S&&(g.shadowColor="#ffe259",g.shadowBlur=16),g.fillText(`Score: ${I}`,10,20),g.restore(),B&&(g.fillStyle="rgba(0,0,0,0.7)",g.fillRect(30,120,340,120),g.fillStyle="#fff",g.font="bold 18px sans-serif",g.fillText("Centipede (Mini)",120,150),g.font="14px sans-serif",g.fillText("Arrow keys: Move",80,180),g.fillText("Space: Fire",80,200),g.fillText("Destroy the centipede!",80,220),g.fillText("Press any key to start",100,240)),v&&(g.save(),g.globalAlpha=.9,g.fillStyle="#18182a",g.fillRect(60,180,280,80),g.globalAlpha=1,g.fillStyle="#fd79a8",g.font="bold 28px sans-serif",g.shadowColor="#fff",g.shadowBlur=W?24:0,g.fillText("Game Over",120,220),g.restore()),j&&(g.save(),g.globalAlpha=.9,g.fillStyle="#18182a",g.fillRect(60,180,280,80),g.globalAlpha=1,g.fillStyle="#ffe259",g.font="bold 28px sans-serif",g.shadowColor="#fff",g.shadowBlur=W?24:0,g.fillText("You Win!",140,220),g.restore())}}function C(){p(Re/2-tt/2),N(pe-40),M([]),c(0),m(!1),A(!1),L(!0),_(!0),U(!1),!o&&!H()&&Y("button"),d(()=>{const g=[];for(let z=0;z<Vs;++z)g.push({x:40+z*(oe+2),y:40,vx:1.2,vy:0,alive:!0});return g}),h(Ks.map(g=>({...g})))}async function G(){D(!0);try{const g=i||localStorage.getItem("userId")||"anon";await J("centipede",g,I)}catch{}D(!1)}const P=Array.from({length:18},()=>({x:Math.random()*Re,y:Math.random()*pe,r:3+Math.random()*2,opacity:.1+Math.random()*.18}));return e.jsxs("div",{className:"arcade-game-container",style:{display:"flex",flexDirection:"column",alignItems:"center",background:"radial-gradient(ellipse at 60% 40%, #23234a 70%, #18182a 100%)",borderRadius:18,boxShadow:"0 0 32px #fd79a8",padding:24,maxWidth:440,margin:"0 auto",position:"relative",overflow:"hidden"},children:[e.jsx("svg",{width:Re,height:pe,style:{position:"absolute",left:0,top:0,zIndex:0},children:P.map((g,z)=>e.jsx("circle",{cx:g.x,cy:g.y+Math.sin(Date.now()/800+z)*10,r:g.r,fill:"#fd79a8",opacity:g.opacity},z))}),e.jsx("h2",{style:{color:"#fd79a8",textShadow:"0 0 8px #fff",marginBottom:8,zIndex:2,position:"relative"},children:"Centipede"}),e.jsx("canvas",{ref:x,width:Re,height:pe,style:{border:"2px solid #fff",background:"transparent",marginBottom:16,maxWidth:"100%",height:"auto",zIndex:2,position:"relative"},tabIndex:0}),(v||j)&&e.jsxs("div",{style:{margin:8},children:[e.jsx("button",{onClick:C,style:{marginRight:12,background:"#fd79a8",color:"#fff",borderRadius:10,padding:"8px 28px",fontWeight:700,fontSize:18,boxShadow:"0 0 8px #fd79a8",border:"none",cursor:"pointer",transition:"background 0.2s, color 0.2s"},children:"Restart"}),e.jsx("button",{onClick:G,disabled:w,style:{background:"#ffe259",color:"#23234a",borderRadius:10,padding:"8px 28px",fontWeight:700,fontSize:18,boxShadow:"0 0 8px #ffe259",border:"none",cursor:"pointer",transition:"background 0.2s, color 0.2s"},children:w?"Submitting...":"Submit Score"})]}),e.jsxs("div",{style:{color:"#fd79a8",fontWeight:600,fontSize:14,marginTop:8,textShadow:"0 0 6px #fff"},children:["User: ",i||"Not connected"]}),e.jsx("div",{style:{marginTop:24,width:"100%"},children:e.jsx($,{gameId:"centipede"})}),e.jsx("style",{children:`
        @keyframes popSuccess {
          0% { transform: scale(1); }
          50% { transform: scale(1.2); }
          100% { transform: scale(1); }
        }
        @keyframes popError {
          0% { transform: scale(1); }
          50% { transform: scale(1.15); }
          100% { transform: scale(1); }
        }
      `})]})},dl=()=>e.jsxs("div",{style:{maxWidth:420,margin:"0 auto"},children:[e.jsx("button",{onClick:()=>window.history.back(),style:{margin:"12px 0"},children:"â† Back to Arcade"}),e.jsx(fl,{})]}),st=400,Dt=480,ln=32,vt=32,cn=32,_t=32,zn=12,qs=.5,Xs=-7.5,Zs=2.5,pt=1.7,On=[{y:440,left:0,right:400},{y:340,left:40,right:360},{y:260,left:0,right:400},{y:180,left:40,right:360},{y:100,left:0,right:400}];function ul(s,o){return s.x<o.x+cn&&s.x+ln>o.x&&s.y<o.y+_t&&s.y+vt>o.y}const hl=({userid:s,muted:o})=>{const[i,f]=t.useState(s||"");t.useEffect(()=>{var l,a,r;if(!s)try{const C=(l=window.Telegram)==null?void 0:l.WebApp;C&&((r=(a=C.initDataUnsafe)==null?void 0:a.user)!=null&&r.id)&&f(C.initDataUnsafe.user.id.toString())}catch{}},[s]);const x=t.useRef(null),[I,c]=t.useState(0),[v,m]=t.useState(!1),[j,A]=t.useState(!1),[k,L]=t.useState(!0),[B,_]=t.useState(!0),[w,D]=t.useState(!1),[n,p]=t.useState({x:60,y:400,vx:0,vy:0,alive:!0}),[u,N]=t.useState([{x:300,y:400,vx:-pt,vy:0,alive:!0,ai:!0},{x:200,y:340,vx:pt,vy:0,alive:!0,ai:!0},{x:100,y:180,vx:pt,vy:0,alive:!0,ai:!0}]),R=t.useRef({});t.useEffect(()=>{const l=r=>{R.current[r.key]=!0,(r.key===" "||r.key==="ArrowUp")&&_(!1),!o&&!H()&&Y("button")},a=r=>{R.current[r.key]=!1};return window.addEventListener("keydown",l),window.addEventListener("keyup",a),()=>{window.removeEventListener("keydown",l),window.removeEventListener("keyup",a)}},[o]),t.useEffect(()=>{if(!k)return;let l,a=performance.now();function r(C){const G=Math.min((C-a)/16,2);a=C,h(G),y(),k&&(l=requestAnimationFrame(r))}return l=requestAnimationFrame(r),()=>cancelAnimationFrame(l)},[k,n,u,v,j]);const[M,b]=t.useState(!1),[d,T]=t.useState(!1);function h(l){if(v||j)return;const a={...n};R.current.ArrowLeft?a.vx=-Zs:R.current.ArrowRight?a.vx=Zs:a.vx=0,R.current[" "]&&a.vy>-2&&(a.vy=Xs,!o&&!H()&&Y("spin")),a.vy+=qs*l,a.x+=a.vx*l*2,a.y+=a.vy*l*2,a.x=Math.max(0,Math.min(st-ln,a.x));for(const C of On)if(a.y+vt>=C.y&&a.y+vt<=C.y+zn+4&&a.x+ln>C.left&&a.x<C.right){a.y=C.y-vt,a.vy=0;break}const r=u.map(C=>({...C}));for(const C of r)if(C.alive){if(C.ai){Math.random()<.02&&(C.vy=Xs*(.7+Math.random()*.6)),C.x+=C.vx*l*2,C.y+=C.vy*l*2,C.vy+=qs*l,(C.x<0||C.x>st-cn)&&(C.vx*=-1);for(const G of On)if(C.y+_t>=G.y&&C.y+_t<=G.y+zn+4&&C.x+cn>G.left&&C.x<G.right){C.y=G.y-_t,C.vy=0;break}}if(ul(a,C)&&C.alive&&a.alive)if(a.y+vt-8<C.y+8)C.alive=!1,c(G=>G+500),!o&&!H()&&Y("win"),T(!0),setTimeout(()=>T(!1),500);else{p(G=>({...G,alive:!1})),m(!0),L(!1),b(!0),!o&&!H()&&Y("die"),setTimeout(()=>b(!1),1200);return}}r.every(C=>!C.alive)&&(A(!0),L(!1),c(C=>C+1e3),b(!0),!o&&!H()&&Y("bonus"),setTimeout(()=>b(!1),1200)),p(a),N(r)}function y(){var a;const l=(a=x.current)==null?void 0:a.getContext("2d");if(l){l.clearRect(0,0,st,Dt),l.fillStyle="#1a1a2e",l.fillRect(0,0,st,Dt);for(const r of On)l.fillStyle="#ffd700",l.fillRect(r.left,r.y,r.right-r.left,zn);n.alive&&(l.save(),l.translate(n.x+ln/2,n.y+vt/2),l.rotate(Math.sin(Date.now()/120)*.1),l.fillStyle="#0ff",l.beginPath(),l.ellipse(0,0,16,16,0,0,Math.PI*2),l.fill(),l.font="bold 20px sans-serif",l.fillStyle="#fff",l.fillText("ðŸ¦…",-14,10),l.restore());for(const r of u)r.alive&&(l.save(),l.translate(r.x+cn/2,r.y+_t/2),l.rotate(Math.sin(Date.now()/100+r.x)*.1),l.fillStyle="#f55",l.beginPath(),l.ellipse(0,0,16,16,0,0,Math.PI*2),l.fill(),l.font="bold 20px sans-serif",l.fillStyle="#fff",l.fillText("ðŸ¦…",-14,10),l.restore());l.fillStyle="#fff",l.font="bold 16px sans-serif",l.save(),d&&(l.shadowColor="#ffe259",l.shadowBlur=16),l.fillText(`Score: ${I}`,10,20),l.restore(),B&&(l.fillStyle="rgba(0,0,0,0.7)",l.fillRect(30,120,340,120),l.fillStyle="#fff",l.font="bold 18px sans-serif",l.fillText("Joust (Mini)",140,150),l.font="14px sans-serif",l.fillText("Arrow keys: Move",80,180),l.fillText("Space: Flap",80,200),l.fillText("Land on enemies to defeat them!",80,220),l.fillText("Press any key to start",100,240)),v&&(l.save(),l.globalAlpha=.9,l.fillStyle="#18182a",l.fillRect(60,180,280,80),l.globalAlpha=1,l.fillStyle="#fd79a8",l.font="bold 28px sans-serif",l.shadowColor="#fff",l.shadowBlur=M?24:0,l.fillText("Game Over",120,220),l.restore()),j&&(l.save(),l.globalAlpha=.9,l.fillStyle="#18182a",l.fillRect(60,180,280,80),l.globalAlpha=1,l.fillStyle="#ffe259",l.font="bold 28px sans-serif",l.shadowColor="#fff",l.shadowBlur=M?24:0,l.fillText("You Win!",140,220),l.restore())}}function W(){p({x:60,y:400,vx:0,vy:0,alive:!0}),N([{x:300,y:400,vx:-pt,vy:0,alive:!0,ai:!0},{x:200,y:340,vx:pt,vy:0,alive:!0,ai:!0},{x:100,y:180,vx:pt,vy:0,alive:!0,ai:!0}]),c(0),m(!1),A(!1),L(!0),_(!0),b(!1),!o&&!H()&&Y("button")}async function U(){D(!0);try{const l=i||localStorage.getItem("userId")||"anon";await J("joust",l,I)}catch{}D(!1)}const S=Array.from({length:18},()=>({x:Math.random()*st,y:Math.random()*Dt,r:3+Math.random()*2,opacity:.1+Math.random()*.18}));return e.jsxs("div",{className:"arcade-game-container",style:{display:"flex",flexDirection:"column",alignItems:"center",background:"radial-gradient(ellipse at 60% 40%, #23234a 70%, #18182a 100%)",borderRadius:18,boxShadow:"0 0 32px #fd79a8",padding:24,maxWidth:440,margin:"0 auto",position:"relative",overflow:"hidden"},children:[e.jsx("svg",{width:st,height:Dt,style:{position:"absolute",left:0,top:0,zIndex:0},children:S.map((l,a)=>e.jsx("circle",{cx:l.x,cy:l.y+Math.sin(Date.now()/800+a)*10,r:l.r,fill:"#fd79a8",opacity:l.opacity},a))}),e.jsx("h2",{style:{color:"#fd79a8",textShadow:"0 0 8px #fff",marginBottom:8,zIndex:2,position:"relative"},children:"Joust"}),e.jsx("canvas",{ref:x,width:st,height:Dt,style:{border:"2px solid #fff",background:"transparent",marginBottom:16,maxWidth:"100%",height:"auto",zIndex:2,position:"relative"},tabIndex:0}),(v||j)&&e.jsxs("div",{style:{margin:8},children:[e.jsx("button",{onClick:W,style:{marginRight:12,background:"#fd79a8",color:"#fff",borderRadius:10,padding:"8px 28px",fontWeight:700,fontSize:18,boxShadow:"0 0 8px #fd79a8",border:"none",cursor:"pointer",transition:"background 0.2s, color 0.2s"},children:"Restart"}),e.jsx("button",{onClick:U,disabled:w,style:{background:"#ffe259",color:"#23234a",borderRadius:10,padding:"8px 28px",fontWeight:700,fontSize:18,boxShadow:"0 0 8px #ffe259",border:"none",cursor:"pointer",transition:"background 0.2s, color 0.2s"},children:w?"Submitting...":"Submit Score"})]}),e.jsxs("div",{style:{color:"#fd79a8",fontWeight:600,fontSize:14,marginTop:8,textShadow:"0 0 6px #fff"},children:["User: ",i||"Not connected"]}),e.jsx("div",{style:{marginTop:24,width:"100%"},children:e.jsx($,{gameId:"joust"})}),e.jsx("style",{children:`
        @keyframes popSuccess {
          0% { transform: scale(1); }
          50% { transform: scale(1.2); }
          100% { transform: scale(1); }
        }
        @keyframes popError {
          0% { transform: scale(1); }
          50% { transform: scale(1.15); }
          100% { transform: scale(1); }
        }
      `})]})},xl=({onBack:s})=>e.jsxs("div",{style:{padding:24},children:[e.jsx("button",{onClick:s,style:{marginBottom:16},children:"â† Back to Arcade"}),e.jsx(hl,{})]}),wt=400,kt=480,ae=20,Kn=wt/ae,qn=kt/ae,sn=[{x:10,y:12},{x:9,y:12},{x:8,y:12}],on={x:1,y:0},gl=90;function Un(s){let o;do o={x:Math.floor(Math.random()*Kn),y:Math.floor(Math.random()*qn)};while(s.some(i=>i.x===o.x&&i.y===o.y));return o}const pl=({userid:s,muted:o})=>{const[i,f]=t.useState(s||"");t.useEffect(()=>{var a,r,C;if(!s)try{const G=(a=window.Telegram)==null?void 0:a.WebApp;G&&((C=(r=G.initDataUnsafe)==null?void 0:r.user)!=null&&C.id)&&f(G.initDataUnsafe.user.id.toString())}catch{}},[s]);const x=t.useRef(null),[I,c]=t.useState(sn),[v,m]=t.useState(on),[j,A]=t.useState(on),[k,L]=t.useState(Un(sn)),[B,_]=t.useState(0),[w,D]=t.useState(!1),[n,p]=t.useState(!1),[u,N]=t.useState(!0),[R,M]=t.useState(!0),[b,d]=t.useState(!1);t.useEffect(()=>{const a=r=>{r.key==="ArrowUp"&&v.y!==1?A({x:0,y:-1}):r.key==="ArrowDown"&&v.y!==-1?A({x:0,y:1}):r.key==="ArrowLeft"&&v.x!==1?A({x:-1,y:0}):r.key==="ArrowRight"&&v.x!==-1&&A({x:1,y:0}),["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(r.key)&&(M(!1),!o&&!H()&&Y("button"))};return window.addEventListener("keydown",a),()=>window.removeEventListener("keydown",a)},[v,o]);const[T,h]=t.useState(!1),[y,W]=t.useState(!1);t.useEffect(()=>{if(!u||w||n)return;const a=setInterval(()=>{m(j),c(r=>{const C={x:r[0].x+j.x,y:r[0].y+j.y};if(C.x<0||C.x>=Kn||C.y<0||C.y>=qn||r.some(P=>P.x===C.x&&P.y===C.y))return D(!0),N(!1),h(!0),!o&&!H()&&Y("die"),setTimeout(()=>h(!1),1200),r;const G=[C,...r];return C.x===k.x&&C.y===k.y?(_(P=>P+100),L(Un(G)),!o&&!H()&&Y("win"),W(!0),setTimeout(()=>W(!1),500)):G.pop(),G.length===Kn*qn&&(p(!0),N(!1),h(!0),!o&&!H()&&Y("bonus"),setTimeout(()=>h(!1),1200)),G})},gl);return()=>clearInterval(a)},[u,j,k,w,n,o]),t.useEffect(()=>{var r;const a=(r=x.current)==null?void 0:r.getContext("2d");if(a){a.clearRect(0,0,wt,kt),a.fillStyle="#111",a.fillRect(0,0,wt,kt),a.save(),a.translate(k.x*ae+ae/2,k.y*ae+ae/2),a.fillStyle="#f00",a.beginPath(),a.arc(0,0,ae/2-2,0,Math.PI*2),a.fill(),a.font="bold 18px sans-serif",a.fillStyle="#fff",a.fillText("ðŸŽ",-10,8),a.restore();for(let C=0;C<I.length;++C){const G=I[C];a.save(),a.translate(G.x*ae+ae/2,G.y*ae+ae/2),a.fillStyle=C===0?"#0f0":"#0ff",a.beginPath(),a.arc(0,0,ae/2-2,0,Math.PI*2),a.fill(),a.font="bold 16px sans-serif",a.fillStyle="#fff",a.fillText(C===0?"ðŸ":"â—",-8,7),a.restore()}a.fillStyle="#fff",a.font="bold 16px sans-serif",a.save(),y&&(a.shadowColor="#ffe259",a.shadowBlur=16),a.fillText(`Score: ${B}`,10,20),a.restore(),R&&(a.fillStyle="rgba(0,0,0,0.7)",a.fillRect(30,120,340,120),a.fillStyle="#fff",a.font="bold 18px sans-serif",a.fillText("Snake (Mini)",140,150),a.font="14px sans-serif",a.fillText("Arrow keys: Move",80,180),a.fillText("Eat apples, avoid yourself!",80,200),a.fillText("Press any key to start",100,240)),w&&(a.save(),a.globalAlpha=.9,a.fillStyle="#18182a",a.fillRect(60,180,280,80),a.globalAlpha=1,a.fillStyle="#fd79a8",a.font="bold 28px sans-serif",a.shadowColor="#fff",a.shadowBlur=T?24:0,a.fillText("Game Over",120,220),a.restore()),n&&(a.save(),a.globalAlpha=.9,a.fillStyle="#18182a",a.fillRect(60,180,280,80),a.globalAlpha=1,a.fillStyle="#ffe259",a.font="bold 28px sans-serif",a.shadowColor="#fff",a.shadowBlur=T?24:0,a.fillText("You Win!",140,220),a.restore())}},[I,k,B,R,w,n,T,y]);function U(){c(sn),m(on),A(on),L(Un(sn)),_(0),D(!1),p(!1),N(!0),M(!0),h(!1),!o&&!H()&&Y("button")}async function S(){d(!0);try{const a=i||localStorage.getItem("userId")||"anon";await J("snake",a,B)}catch{}d(!1)}const l=Array.from({length:18},()=>({x:Math.random()*wt,y:Math.random()*kt,r:3+Math.random()*2,opacity:.1+Math.random()*.18}));return e.jsxs("div",{className:"arcade-game-container",style:{display:"flex",flexDirection:"column",alignItems:"center",background:"radial-gradient(ellipse at 60% 40%, #23234a 70%, #18182a 100%)",borderRadius:18,boxShadow:"0 0 32px #fd79a8",padding:24,maxWidth:440,margin:"0 auto",position:"relative",overflow:"hidden"},children:[e.jsx("svg",{width:wt,height:kt,style:{position:"absolute",left:0,top:0,zIndex:0},children:l.map((a,r)=>e.jsx("circle",{cx:a.x,cy:a.y+Math.sin(Date.now()/800+r)*10,r:a.r,fill:"#fd79a8",opacity:a.opacity},r))}),e.jsx("h2",{style:{color:"#fd79a8",textShadow:"0 0 8px #fff",marginBottom:8,zIndex:2,position:"relative"},children:"Snake"}),e.jsx("canvas",{ref:x,width:wt,height:kt,style:{border:"2px solid #fff",background:"transparent",marginBottom:16,maxWidth:"100%",height:"auto",zIndex:2,position:"relative"},tabIndex:0}),(w||n)&&e.jsxs("div",{style:{margin:8},children:[e.jsx("button",{onClick:U,style:{marginRight:12,background:"#fd79a8",color:"#fff",borderRadius:10,padding:"8px 28px",fontWeight:700,fontSize:18,boxShadow:"0 0 8px #fd79a8",border:"none",cursor:"pointer",transition:"background 0.2s, color 0.2s"},children:"Restart"}),e.jsx("button",{onClick:S,disabled:b,style:{background:"#ffe259",color:"#23234a",borderRadius:10,padding:"8px 28px",fontWeight:700,fontSize:18,boxShadow:"0 0 8px #ffe259",border:"none",cursor:"pointer",transition:"background 0.2s, color 0.2s"},children:b?"Submitting...":"Submit Score"})]}),e.jsxs("div",{style:{color:"#fd79a8",fontWeight:600,fontSize:14,marginTop:8,textShadow:"0 0 6px #fff"},children:["User: ",i||"Not connected"]}),e.jsx("div",{style:{marginTop:24,width:"100%"},children:e.jsx($,{gameId:"snake"})}),e.jsx("style",{children:`
        @keyframes popSuccess {
          0% { transform: scale(1); }
          50% { transform: scale(1.2); }
          100% { transform: scale(1); }
        }
        @keyframes popError {
          0% { transform: scale(1); }
          50% { transform: scale(1.15); }
          100% { transform: scale(1); }
        }
      `})]})},yl=()=>e.jsxs("div",{style:{maxWidth:420,margin:"0 auto"},children:[e.jsx("button",{onClick:()=>window.history.back(),style:{margin:"12px 0"},children:"â† Back to Arcade"}),e.jsx(pl,{})]}),Xn=400,Zn=480,se=24,Ke=Math.floor(Xn/se),De=Math.floor(Zn/se),ml=20,Sl=20,Qs=3;function an(){const s=Array.from({length:De},()=>Array(Ke).fill(0));for(let o=De-2;o<De;++o)for(let i=0;i<Ke;++i)s[o][i]=1;return s}function Js(s){let o,i;do o=Math.floor(Math.random()*Ke),i=Math.floor(Math.random()*(De-4))+2;while(s[i][o]!==0);return{x:o,y:i}}const bl=()=>{const s=t.useRef(null),[o,i]=t.useState(0),[f,x]=t.useState(!1),[I,c]=t.useState(!1),[v,m]=t.useState(!0),[j,A]=t.useState(!0),[k,L]=t.useState(!1),[B,_]=t.useState(an()),[w,D]=t.useState({x:Math.floor(Ke/2),y:De-2,alive:!0}),[n,p]=t.useState(()=>{const d=[];for(let T=0;T<Qs;++T)d.push({...Js(an()),alive:!0});return d}),u=t.useRef({});t.useEffect(()=>{const d=h=>{u.current[h.key]=!0,["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"," "].includes(h.key)&&A(!1)},T=h=>{u.current[h.key]=!1};return window.addEventListener("keydown",d),window.addEventListener("keyup",T),()=>{window.removeEventListener("keydown",d),window.removeEventListener("keyup",T)}},[]),t.useEffect(()=>{if(!v)return;let d;function T(){N(),R(),v&&(d=requestAnimationFrame(T))}return d=requestAnimationFrame(T),()=>cancelAnimationFrame(d)},[v,w,n,B,f,I]);function N(){if(f||I)return;const d={...w},T=B.map(S=>[...S]);let h=0,y=0;u.current.ArrowLeft&&(h=-1),u.current.ArrowRight&&(h=1),u.current.ArrowUp&&(y=-1),u.current.ArrowDown&&(y=1);const W=d.x+h,U=d.y+y;W>=0&&W<Ke&&U>=0&&U<De&&(d.x=W,d.y=U,T[U][W]=1),D(d),_(T),u.current[" "]&&n.some(S=>S.alive&&Math.abs(S.x-d.x)+Math.abs(S.y-d.y)===1)&&(p(S=>S.map(l=>l.alive&&Math.abs(l.x-d.x)+Math.abs(l.y-d.y)===1?(i(a=>a+500),{...l,alive:!1}):l)),u.current[" "]=!1),p(S=>S.map(l=>{if(!l.alive)return l;const a=[{x:l.x+1,y:l.y},{x:l.x-1,y:l.y},{x:l.x,y:l.y+1},{x:l.x,y:l.y-1}].filter(r=>r.x>=0&&r.x<Ke&&r.y>=0&&r.y<De&&T[r.y][r.x]===1);return a.length>0?(a.sort((r,C)=>Math.abs(r.x-d.x)+Math.abs(r.y-d.y)-(Math.abs(C.x-d.x)+Math.abs(C.y-d.y))),{...l,x:a[0].x,y:a[0].y}):l}));for(const S of n)if(S.alive&&S.x===d.x&&S.y===d.y){D(l=>({...l,alive:!1})),x(!0),m(!1);return}n.every(S=>!S.alive)&&(c(!0),m(!1),i(S=>S+1e3))}function R(){var T;const d=(T=s.current)==null?void 0:T.getContext("2d");if(d){d.clearRect(0,0,Xn,Zn);for(let h=0;h<De;++h)for(let y=0;y<Ke;++y)d.fillStyle=B[h][y]===0?"#a0522d":"#222",d.fillRect(y*se,h*se,se,se);w.alive&&(d.save(),d.translate(w.x*se+se/2,w.y*se+se/2),d.fillStyle="#0ff",d.beginPath(),d.arc(0,0,ml/2,0,Math.PI*2),d.fill(),d.font="bold 18px sans-serif",d.fillStyle="#fff",d.fillText("ðŸ‘·",-12,8),d.restore());for(const h of n)h.alive&&(d.save(),d.translate(h.x*se+se/2,h.y*se+se/2),d.fillStyle="#f00",d.beginPath(),d.arc(0,0,Sl/2,0,Math.PI*2),d.fill(),d.font="bold 16px sans-serif",d.fillStyle="#fff",d.fillText("ðŸ‘¾",-10,7),d.restore());d.fillStyle="#fff",d.font="bold 16px sans-serif",d.fillText(`Score: ${o}`,10,20),j&&(d.fillStyle="rgba(0,0,0,0.7)",d.fillRect(30,120,340,120),d.fillStyle="#fff",d.font="bold 18px sans-serif",d.fillText("Dig Dug (Mini)",120,150),d.font="14px sans-serif",d.fillText("Arrow keys: Move",80,180),d.fillText("Space: Pump enemy",80,200),d.fillText("Defeat all enemies!",80,220),d.fillText("Press any key to start",100,240)),f&&(d.fillStyle="rgba(0,0,0,0.7)",d.fillRect(60,180,280,80),d.fillStyle="#fff",d.font="bold 28px sans-serif",d.fillText("Game Over",120,220)),I&&(d.fillStyle="rgba(0,0,0,0.7)",d.fillRect(60,180,280,80),d.fillStyle="#fff",d.font="bold 28px sans-serif",d.fillText("You Win!",140,220))}}function M(){D({x:Math.floor(Ke/2),y:De-2,alive:!0}),_(an()),p(()=>{const d=[];for(let T=0;T<Qs;++T)d.push({...Js(an()),alive:!0});return d}),i(0),x(!1),c(!1),m(!0),A(!0)}async function b(){L(!0);try{const d=localStorage.getItem("userId")||"anon";await J("dig_dug",d,o)}catch{}L(!1)}return e.jsxs("div",{className:"arcade-game-container",style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx("h2",{children:"Dig Dug"}),e.jsx("canvas",{ref:s,width:Xn,height:Zn,style:{border:"2px solid #fff",background:"#222",marginBottom:16,maxWidth:"100%",height:"auto"},tabIndex:0}),(f||I)&&e.jsxs("div",{style:{margin:8},children:[e.jsx("button",{onClick:M,style:{marginRight:12},children:"Restart"}),e.jsx("button",{onClick:b,disabled:k,children:k?"Submitting...":"Submit Score"})]}),e.jsx("div",{style:{marginTop:24,width:"100%"},children:e.jsx($,{gameId:"dig_dug"})})]})},vl=()=>e.jsxs("div",{style:{maxWidth:420,margin:"0 auto"},children:[e.jsx("button",{onClick:()=>window.history.back(),style:{margin:"12px 0"},children:"â† Back to Arcade"}),e.jsx(bl,{})]}),Be=400,yt=480,rn=28,Gn=28,Hn=40,Yn=60,mt=10,He=320,St=24,$s=5,wl=({userid:s,muted:o})=>{const[i,f]=t.useState(s||"");t.useEffect(()=>{var E,O,F;if(!s)try{const V=(E=window.Telegram)==null?void 0:E.WebApp;V&&((F=(O=V.initDataUnsafe)==null?void 0:O.user)!=null&&F.id)&&f(V.initDataUnsafe.user.id.toString())}catch{}},[s]);const x=t.useRef(null),[I,c]=t.useState(0),[v,m]=t.useState(!1),[j,A]=t.useState(!1),[k,L]=t.useState(!0),[B,_]=t.useState(!0),[w,D]=t.useState(!1),[n,p]=t.useState(60),[u,N]=t.useState(He),[R,M]=t.useState([]),[b,d]=t.useState([]),[T,h]=t.useState([]),[y,W]=t.useState($s),U=t.useRef({});t.useEffect(()=>{d([{x:120,y:180,delivered:!1},{x:220,y:120,delivered:!1},{x:320,y:200,delivered:!1}]),h([{x:400,y:He+10,vx:-2.2},{x:600,y:He+10,vx:-2.7}])},[]),t.useEffect(()=>{const E=F=>{U.current[F.key]=!0,(F.key===" "||F.key==="ArrowUp")&&_(!1),!o&&!H()&&Y("button")},O=F=>{U.current[F.key]=!1};return window.addEventListener("keydown",E),window.addEventListener("keyup",O),()=>{window.removeEventListener("keydown",E),window.removeEventListener("keyup",O)}},[o]),t.useEffect(()=>{if(!k)return;let E,O=performance.now();function F(V){const q=Math.min((V-O)/16,2);O=V,C(q),G(),k&&(E=requestAnimationFrame(F))}return E=requestAnimationFrame(F),()=>cancelAnimationFrame(E)},[k,n,u,R,b,T,v,j,y]);const[S,l]=t.useState(!1),[a,r]=t.useState(!1);function C(E){if(v||j)return;let O=n,F=u;U.current.ArrowLeft&&(O-=3.2*E),U.current.ArrowRight&&(O+=3.2*E),U.current.ArrowUp&&(F-=3.2*E),U.current.ArrowDown&&(F+=3.2*E),O=Math.max(0,Math.min(Be-rn,O)),F=Math.max(He,Math.min(yt-Gn,F)),p(O),N(F),U.current[" "]&&y>0&&(M(K=>[...K,{x:O+rn,y:F+8,vx:5.5,vy:-2.2,active:!0}]),W(K=>K-1),U.current[" "]=!1,!o&&!H()&&Y("spin"));let V=R.map(K=>({...K,x:K.x+K.vx*E,y:K.y+K.vy*E}));V=V.filter(K=>K.x<Be&&K.y>0&&K.active);const q=b.map(K=>({...K}));for(const K of V)for(const it of q)!it.delivered&&K.x+mt>it.x&&K.x<it.x+Hn&&K.y+mt>it.y&&K.y<it.y+Yn&&(it.delivered=!0,K.active=!1,c(Mo=>Mo+500),!o&&!H()&&Y("win"),r(!0),setTimeout(()=>r(!1),500));M(V),d(q);const re=T.map(K=>({...K,x:K.x+K.vx*E}));for(const K of re)K.x<-St&&(K.x=Be+Math.random()*200);h(re);for(const K of re)O+rn>K.x&&O<K.x+St&&F+Gn>K.y&&F<K.y+St&&(m(!0),L(!1));q.every(K=>K.delivered)&&(A(!0),L(!1),c(K=>K+1e3),l(!0),!o&&!H()&&Y("bonus"),setTimeout(()=>l(!1),1200)),y===0&&V.length===0&&!q.every(K=>K.delivered)&&(m(!0),L(!1),l(!0),!o&&!H()&&Y("die"),setTimeout(()=>l(!1),1200))}function G(){var O;const E=(O=x.current)==null?void 0:O.getContext("2d");if(E){E.clearRect(0,0,Be,yt),E.fillStyle="#b3e5fc",E.fillRect(0,0,Be,yt),E.fillStyle="#888",E.fillRect(0,He,Be,60);for(const F of b)E.save(),E.translate(F.x,F.y),E.fillStyle=F.delivered?"#8bc34a":"#fff",E.fillRect(0,0,Hn,Yn),E.strokeStyle="#333",E.strokeRect(0,0,Hn,Yn),E.font="bold 18px sans-serif",E.fillStyle="#333",E.fillText("ðŸ ",6,36),E.restore();for(const F of T)E.save(),E.translate(F.x,F.y),E.fillStyle="#f44336",E.beginPath(),E.arc(St/2,St/2,St/2,0,Math.PI*2),E.fill(),E.font="bold 18px sans-serif",E.fillStyle="#fff",E.fillText("ðŸš—",0,20),E.restore();E.save(),E.translate(n,u),E.fillStyle="#1976d2",E.fillRect(0,0,rn,Gn),E.font="bold 20px sans-serif",E.fillStyle="#fff",E.fillText("ðŸš´",0,24),E.restore();for(const F of R)E.save(),E.translate(F.x,F.y),E.fillStyle="#fffde7",E.fillRect(0,0,mt,mt),E.strokeStyle="#333",E.strokeRect(0,0,mt,mt),E.font="bold 12px sans-serif",E.fillStyle="#333",E.fillText("ðŸ“°",0,10),E.restore();E.fillStyle="#333",E.font="bold 16px sans-serif",E.save(),a&&(E.shadowColor="#ffe259",E.shadowBlur=16),E.fillText(`Score: ${I}`,10,24),E.restore(),E.fillText(`Papers Left: ${y}`,280,24),B&&(E.fillStyle="rgba(0,0,0,0.7)",E.fillRect(30,120,340,120),E.fillStyle="#fff",E.font="bold 18px sans-serif",E.fillText("Paper Boy (Mini)",120,150),E.font="14px sans-serif",E.fillText("Arrow keys: Move",80,180),E.fillText("Space: Throw paper",80,200),E.fillText("Deliver to houses, avoid cars!",80,220),E.fillText("Press any key to start",100,240)),v&&(E.save(),E.globalAlpha=.9,E.fillStyle="#18182a",E.fillRect(60,180,280,80),E.globalAlpha=1,E.fillStyle="#fd79a8",E.font="bold 28px sans-serif",E.shadowColor="#fff",E.shadowBlur=S?24:0,E.fillText("Game Over",120,220),E.restore()),j&&(E.save(),E.globalAlpha=.9,E.fillStyle="#18182a",E.fillRect(60,180,280,80),E.globalAlpha=1,E.fillStyle="#ffe259",E.font="bold 28px sans-serif",E.shadowColor="#fff",E.shadowBlur=S?24:0,E.fillText("You Win!",140,220),E.restore())}}function P(){p(60),N(He),M([]),c(0),m(!1),A(!1),L(!0),_(!0),l(!1),!o&&!H()&&Y("button"),W($s),d([{x:120,y:180,delivered:!1},{x:220,y:120,delivered:!1},{x:320,y:200,delivered:!1}]),h([{x:400,y:He+10,vx:-2.2},{x:600,y:He+10,vx:-2.7}])}async function g(){D(!0);try{const E=i||localStorage.getItem("userId")||"anon";await J("paperboy",E,I)}catch{}D(!1)}const z=Array.from({length:18},()=>({x:Math.random()*Be,y:Math.random()*yt,r:3+Math.random()*2,opacity:.1+Math.random()*.18}));return e.jsxs("div",{className:"arcade-game-container",style:{display:"flex",flexDirection:"column",alignItems:"center",background:"radial-gradient(ellipse at 60% 40%, #23234a 70%, #18182a 100%)",borderRadius:18,boxShadow:"0 0 32px #fd79a8",padding:24,maxWidth:440,margin:"0 auto",position:"relative",overflow:"hidden"},children:[e.jsx("svg",{width:Be,height:yt,style:{position:"absolute",left:0,top:0,zIndex:0},children:z.map((E,O)=>e.jsx("circle",{cx:E.x,cy:E.y+Math.sin(Date.now()/800+O)*10,r:E.r,fill:"#fd79a8",opacity:E.opacity},O))}),e.jsx("h2",{style:{color:"#fd79a8",textShadow:"0 0 8px #fff",marginBottom:8,zIndex:2,position:"relative"},children:"Paper Boy"}),e.jsx("canvas",{ref:x,width:Be,height:yt,style:{border:"2px solid #fff",background:"transparent",marginBottom:16,maxWidth:"100%",height:"auto",zIndex:2,position:"relative"},tabIndex:0}),(v||j)&&e.jsxs("div",{style:{margin:8},children:[e.jsx("button",{onClick:P,style:{marginRight:12,background:"#fd79a8",color:"#fff",borderRadius:10,padding:"8px 28px",fontWeight:700,fontSize:18,boxShadow:"0 0 8px #fd79a8",border:"none",cursor:"pointer",transition:"background 0.2s, color 0.2s"},children:"Restart"}),e.jsx("button",{onClick:g,disabled:w,style:{background:"#ffe259",color:"#23234a",borderRadius:10,padding:"8px 28px",fontWeight:700,fontSize:18,boxShadow:"0 0 8px #ffe259",border:"none",cursor:"pointer",transition:"background 0.2s, color 0.2s"},children:w?"Submitting...":"Submit Score"})]}),e.jsxs("div",{style:{color:"#fd79a8",fontWeight:600,fontSize:14,marginTop:8,textShadow:"0 0 6px #fff"},children:["User: ",i||"Not connected"]}),e.jsx("div",{style:{marginTop:24,width:"100%"},children:e.jsx($,{gameId:"paperboy"})}),e.jsx("style",{children:`
        @keyframes popSuccess {
          0% { transform: scale(1); }
          50% { transform: scale(1.2); }
          100% { transform: scale(1); }
        }
        @keyframes popError {
          0% { transform: scale(1); }
          50% { transform: scale(1.15); }
          100% { transform: scale(1); }
        }
      `})]})},kl=()=>{const s=co();return e.jsxs("div",{style:{background:"#b3e5fc",minHeight:"100vh",color:"#333"},children:[e.jsx("button",{onClick:()=>s("/arcade"),style:{margin:16},children:"â¬… Back to Arcade"}),e.jsx(wl,{})]})},le=10,eo={x:1,y:1,dir:"right"},to={x:8,y:8},no=Array.from({length:le*le},(s,o)=>o);function Al(s,o){return o*le+s}const jl=({userid:s="",muted:o=!1})=>{const[i,f]=t.useState(s);t.useEffect(()=>{var M,b,d;if(!s)try{const T=(M=window.Telegram)==null?void 0:M.WebApp;T&&((d=(b=T.initDataUnsafe)==null?void 0:b.user)!=null&&d.id)&&f(T.initDataUnsafe.user.id.toString())}catch{}},[s]);const[x,I]=t.useState(eo),[c,v]=t.useState(to),[m,j]=t.useState(no),[A,k]=t.useState(0),[L,B]=t.useState(0),[_,w]=t.useState(!1),[D,n]=t.useState(!1),[p,u]=t.useState(!1);t.useEffect(()=>{if(_){n(!0),!o&&!H()&&Y("die");const M=setTimeout(()=>{I(eo),v(to),j(no),k(0),w(!1),n(!1)},2e3);return()=>clearTimeout(M)}},[_,o]),t.useEffect(()=>{const M=b=>{_||I(d=>{let{x:T,y:h,dir:y}=d;return b.key==="ArrowUp"&&(h=Math.max(0,h-1),y="up"),b.key==="ArrowDown"&&(h=Math.min(le-1,h+1),y="down"),b.key==="ArrowLeft"&&(T=Math.max(0,T-1),y="left"),b.key==="ArrowRight"&&(T=Math.min(le-1,T+1),y="right"),!o&&!H()&&Y("button"),{x:T,y:h,dir:y}})};return window.addEventListener("keydown",M),()=>window.removeEventListener("keydown",M)},[_,o]),t.useEffect(()=>{if(_)return;const M=setInterval(()=>{v(b=>{const d=[{x:b.x+1,y:b.y},{x:b.x-1,y:b.y},{x:b.x,y:b.y+1},{x:b.x,y:b.y-1}].filter(({x:T,y:h})=>T>=0&&T<le&&h>=0&&h<le);return d[Math.floor(Math.random()*d.length)]||b})},400);return()=>clearInterval(M)},[_]),t.useEffect(()=>{const M=Al(x.x,x.y);m.includes(M)&&(j(b=>b.filter(d=>d!==M)),k(b=>b+10),u(!0),!o&&!H()&&Y("win"),setTimeout(()=>u(!1),400)),x.x===c.x&&x.y===c.y&&(B(A),w(!0)),m.length===0&&(B(A),w(!0),!o&&!H()&&Y("bonus"))},[x,c,m,A,o]),t.useEffect(()=>{_&&L>0&&i&&J("Pacman",i,L)},[_,L,i]);const R=Array.from({length:22},()=>({x:Math.random()*200,y:Math.random()*200,r:2+Math.random()*2,opacity:.1+Math.random()*.18}));return e.jsxs("div",{className:"arcade-game",style:{background:"radial-gradient(ellipse at 60% 40%, #23234a 70%, #18182a 100%)",borderRadius:18,boxShadow:"0 0 32px #ffe600",padding:24,maxWidth:340,margin:"0 auto",position:"relative",overflow:"hidden"},children:[e.jsx("svg",{width:200,height:200,style:{position:"absolute",left:0,top:0,zIndex:0},children:R.map((M,b)=>e.jsx("circle",{cx:M.x,cy:M.y+Math.sin(Date.now()/800+b)*10,r:M.r,fill:"#ffe600",opacity:M.opacity},b))}),e.jsx("h4",{style:{color:"#ffe600",textShadow:"0 0 8px #fff",marginBottom:8,zIndex:2,position:"relative"},children:"Pacman"}),e.jsx("div",{className:"arcade-grid",style:{zIndex:2,position:"relative"},children:Array.from({length:le*le}).map((M,b)=>{const d=b%le,T=Math.floor(b/le);let h="";return x.x===d&&x.y===T?h="ðŸ˜‹":c.x===d&&c.y===T?h="ðŸ‘»":m.includes(b)&&(h="â€¢"),e.jsx("div",{className:"arcade-cell",children:h},b)})}),e.jsxs("div",{style:{color:"#fff",fontWeight:700,fontSize:18,margin:"10px 0 2px",textShadow:"0 0 8px #ffe600",zIndex:2,position:"relative",animation:p?"popSuccess 0.5s":void 0},children:["Score: ",A]}),_&&e.jsx("div",{style:{color:"#ffe600",fontWeight:900,fontSize:28,marginTop:10,textShadow:"0 0 18px #fff, 0 0 24px #ffe600",animation:D?"popError 1.1s":void 0,zIndex:3,position:"relative"},children:m.length===0?"ðŸ† YOU WIN!":"ðŸ’€ GAME OVER"}),e.jsxs("div",{style:{color:"#ffe600",fontWeight:600,fontSize:14,marginTop:8,textShadow:"0 0 6px #fff"},children:["User: ",i||"Not connected"]}),e.jsx("style",{children:`
        @keyframes popSuccess {
          0% { transform: scale(1); }
          50% { transform: scale(1.2); }
          100% { transform: scale(1); }
        }
        @keyframes popError {
          0% { transform: scale(1); }
          50% { transform: scale(1.15); }
          100% { transform: scale(1); }
        }
      `})]})},El=({onBack:s,userId:o})=>e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:16},children:[e.jsx("button",{onClick:s,style:{alignSelf:"flex-start",margin:8},children:" Back to Arcade"}),e.jsx(jl,{userid:o}),e.jsx($,{game:"Pacman"})]}),me=200,Se=200,so=5;function oo(){return{x:Math.random()*me,y:Math.random()*Se,dx:(Math.random()-.5)*2,dy:(Math.random()-.5)*2,r:10+Math.random()*10}}const Il=({userid:s="",muted:o=!1})=>{const[i,f]=t.useState(s||"");t.useEffect(()=>{var n,p,u;if(!s)try{const N=(n=window.Telegram)==null?void 0:n.WebApp;N&&((u=(p=N.initDataUnsafe)==null?void 0:p.user)!=null&&u.id)&&f(N.initDataUnsafe.user.id.toString())}catch{}},[s]);const[x,I]=t.useState({x:me/2,y:Se/2,angle:0}),[c,v]=t.useState(Array.from({length:so},oo)),[m,j]=t.useState(0),[A,k]=t.useState(!1),[L,B]=t.useState(!1),_=t.useRef(!1);t.useEffect(()=>{if(A){B(!0),!o&&!H()&&Y("die");const n=setTimeout(()=>{I({x:me/2,y:Se/2,angle:0}),v(Array.from({length:so},oo)),j(0),k(!1),B(!1)},2e3);return()=>clearTimeout(n)}},[A,o]),t.useEffect(()=>{const n=p=>{A||I(u=>{let{x:N,y:R,angle:M}=u;return p.key==="ArrowLeft"&&(M-=.2),p.key==="ArrowRight"&&(M+=.2),p.key==="ArrowUp"?(N+=Math.cos(M)*5,R+=Math.sin(M)*5,_.current=!0,!o&&!H()&&Y("button")):_.current=!1,N=(N+me)%me,R=(R+Se)%Se,{x:N,y:R,angle:M}})};return window.addEventListener("keydown",n),()=>window.removeEventListener("keydown",n)},[A,o]),t.useEffect(()=>{if(A)return;const n=setInterval(()=>{v(p=>p.map(u=>({...u,x:(u.x+u.dx+me)%me,y:(u.y+u.dy+Se)%Se}))),c.forEach(p=>{Math.hypot(p.x-x.x,p.y-x.y)<p.r+5&&k(!0)})},50);return()=>clearInterval(n)},[x,c,A]),t.useEffect(()=>{A||j(n=>n+1)},[c,A]),t.useEffect(()=>{A&&m>0&&i&&J("Asteroids",i,m)},[A,m,i]);const D=Array.from({length:32},()=>({x:Math.random()*me,y:Math.random()*Se,r:.7+Math.random()*1.2,opacity:.2+Math.random()*.5}));return e.jsxs("div",{className:"arcade-game",style:{background:"radial-gradient(ellipse at 60% 40%, #18182a 70%, #23234a 100%)",borderRadius:18,boxShadow:"0 0 32px #ffe600",padding:24,maxWidth:340,margin:"0 auto",position:"relative",overflow:"hidden"},children:[e.jsx("svg",{width:me,height:Se,style:{position:"absolute",left:0,top:0,zIndex:0},children:D.map((n,p)=>e.jsx("circle",{cx:n.x,cy:n.y,r:n.r,fill:"#fff",opacity:n.opacity},p))}),e.jsx("h4",{style:{color:"#ffe600",textShadow:"0 0 8px #fff",marginBottom:8,zIndex:2,position:"relative"},children:"Asteroids"}),e.jsxs("svg",{width:me,height:Se,style:{background:"transparent",zIndex:2,position:"relative",borderRadius:10,boxShadow:"0 0 12px #ffe600 inset"},children:[e.jsx("circle",{cx:x.x,cy:x.y,r:7,fill:"yellow",stroke:"#fff",strokeWidth:2}),c.map((n,p)=>e.jsx("circle",{cx:n.x,cy:n.y,r:n.r,fill:"#888",stroke:"#fff",strokeWidth:1.5},p))]}),e.jsxs("div",{style:{color:"#fff",fontWeight:700,fontSize:18,margin:"10px 0 2px",textShadow:"0 0 8px #ffe600"},children:["Score: ",m]}),A&&e.jsx("div",{style:{color:"#ffe600",fontWeight:900,fontSize:28,marginTop:10,textShadow:"0 0 18px #fff, 0 0 24px #ffe600",animation:L?"popError 1.1s":void 0,zIndex:3,position:"relative"},children:"ðŸ’¥ GAME OVER"}),e.jsxs("div",{style:{color:"#ffe600",fontWeight:600,fontSize:14,marginTop:8,textShadow:"0 0 6px #fff"},children:["User: ",i||"Not connected"]}),e.jsx("style",{children:`
        @keyframes popError {
          0% { transform: scale(1); }
          50% { transform: scale(1.15); }
          100% { transform: scale(1); }
        }
      `})]})},Tl=({onBack:s,userId:o})=>e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:16},children:[e.jsx("button",{onClick:s,style:{alignSelf:"flex-start",margin:8},children:" Back to Arcade"}),e.jsx(Il,{userid:o}),e.jsx($,{game:"Asteroids"})]}),Ye=16,Fe=10,ao=[[[1,1,1,1]],[[1,1],[1,1]],[[0,1,0],[1,1,1]],[[1,1,0],[0,1,1]],[[0,1,1],[1,1,0]],[[1,0,0],[1,1,1]],[[0,0,1],[1,1,1]]];function Fn(){return{shape:ao[Math.floor(Math.random()*ao.length)],x:3,y:0}}const Ml=({userid:s="",muted:o=!1})=>{const[i,f]=t.useState(s);t.useEffect(()=>{var R,M,b;if(!s)try{const d=(R=window.Telegram)==null?void 0:R.WebApp;d&&((b=(M=d.initDataUnsafe)==null?void 0:M.user)!=null&&b.id)&&f(d.initDataUnsafe.user.id.toString())}catch{}},[s]);const[x,I]=t.useState(Array.from({length:Ye},()=>Array(Fe).fill(0))),[c,v]=t.useState(Fn()),[m,j]=t.useState(0),[A,k]=t.useState(!1),[L,B]=t.useState(!1),[_,w]=t.useState(!1);t.useEffect(()=>{if(A){B(!0),!o&&!H()&&Y("die");const R=setTimeout(()=>{I(Array.from({length:Ye},()=>Array(Fe).fill(0))),v(Fn()),j(0),k(!1),B(!1)},2e3);return()=>clearTimeout(R)}},[A,o]);const D=(R,M)=>{const b=R.map(d=>[...d]);return M.shape.forEach((d,T)=>d.forEach((h,y)=>{if(h){const W=M.x+y,U=M.y+T;U>=0&&U<Ye&&W>=0&&W<Fe&&(b[U][W]=1)}})),b},n=t.useCallback((R,M,b=c.shape)=>{for(let d=0;d<b.length;d++)for(let T=0;T<b[d].length;T++)if(b[d][T]){const h=c.x+R+T,y=c.y+M+d;if(h<0||h>=Fe||y>=Ye||y>=0&&x[y][h])return!1}return!0},[c,x]);t.useEffect(()=>{if(A)return;const R=setInterval(()=>{n(0,1)?(v(M=>({...M,y:M.y+1})),!o&&!H()&&Y("button")):(I(M=>D(M,c)),I(M=>{const b=M.filter(T=>T.some(h=>!h)),d=Ye-b.length;return d>0&&(j(T=>T+d*100),w(!0),!o&&!H()&&Y("win"),setTimeout(()=>w(!1),800)),[...Array.from({length:d},()=>Array(Fe).fill(0)),...b]}),v(Fn()),n(0,0)||k(!0))},400);return()=>clearInterval(R)},[c,x,A,n,o]),t.useEffect(()=>{A&&m>0&&i&&J("Tetris",i,m)},[A,m,i]),t.useEffect(()=>{const R=M=>{if(!A&&(M.key==="ArrowLeft"&&n(-1,0)&&(v(b=>({...b,x:b.x-1})),!o&&!H()&&Y("button")),M.key==="ArrowRight"&&n(1,0)&&(v(b=>({...b,x:b.x+1})),!o&&!H()&&Y("button")),M.key==="ArrowDown"&&n(0,1)&&(v(b=>({...b,y:b.y+1})),!o&&!H()&&Y("button")),M.key==="ArrowUp")){const b=c.shape[0].map((d,T)=>c.shape.map(h=>h[T]).reverse());n(0,0,b)&&(v(d=>({...d,shape:b})),!o&&!H()&&Y("bonus"))}};return window.addEventListener("keydown",R),()=>window.removeEventListener("keydown",R)},[c,x,A,n,o]);const p=()=>{const R=x.map(M=>[...M]);return c.shape.forEach((M,b)=>M.forEach((d,T)=>{if(d){const h=c.x+T,y=c.y+b;y>=0&&y<Ye&&h>=0&&h<Fe&&(R[y][h]=2)}})),R.map((M,b)=>M.map((d,T)=>e.jsx("div",{className:d===2?"arcade-cell tetris-active":d?"arcade-cell tetris-filled":"arcade-cell"},T+"-"+b)))},N=Array.from({length:18},()=>({x:Math.random()*Fe,y:Math.random()*Ye,color:`hsl(${Math.random()*360}, 80%, 60%)`,size:.7+Math.random()*.7,opacity:.13+Math.random()*.18}));return e.jsxs("div",{className:"arcade-game",style:{background:"radial-gradient(ellipse at 60% 40%, #23234a 70%, #18182a 100%)",borderRadius:18,boxShadow:"0 0 32px #00fff7",padding:24,maxWidth:340,margin:"0 auto",position:"relative",overflow:"hidden"},children:[e.jsx("svg",{width:Fe*20,height:Ye*20,style:{position:"absolute",left:0,top:0,zIndex:0},children:N.map((R,M)=>e.jsx("rect",{x:R.x*20,y:R.y*20+Math.sin(Date.now()/800+M)*10,width:R.size*18,height:R.size*18,fill:R.color,opacity:R.opacity,rx:4},M))}),e.jsx("h4",{style:{color:"#00fff7",textShadow:"0 0 8px #fff",marginBottom:8,zIndex:2,position:"relative"},children:"Tetris"}),e.jsx("div",{className:"arcade-grid tetris-grid",style:{zIndex:2,position:"relative"},children:p()}),e.jsxs("div",{style:{color:"#fff",fontWeight:700,fontSize:18,margin:"10px 0 2px",textShadow:"0 0 8px #00fff7",zIndex:2,position:"relative",animation:_?"popSuccess 0.5s":void 0},children:["Score: ",m]}),A&&e.jsx("div",{style:{color:"#00fff7",fontWeight:900,fontSize:28,marginTop:10,textShadow:"0 0 18px #fff, 0 0 24px #00fff7",animation:L?"popError 1.1s":void 0,zIndex:3,position:"relative"},children:"ðŸ§± GAME OVER"}),e.jsxs("div",{style:{color:"#00fff7",fontWeight:600,fontSize:14,marginTop:8,textShadow:"0 0 6px #fff"},children:["User: ",i||"Not connected"]}),e.jsx("style",{children:`
        @keyframes popSuccess {
          0% { transform: scale(1); }
          50% { transform: scale(1.2); }
          100% { transform: scale(1); }
        }
        @keyframes popError {
          0% { transform: scale(1); }
          50% { transform: scale(1.15); }
          100% { transform: scale(1); }
        }
      `})]})},Rl=({onBack:s,userId:o})=>e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:16},children:[e.jsx("button",{onClick:s,style:{alignSelf:"flex-start",margin:8},children:" Back to Arcade"}),e.jsx(Ml,{userid:o}),e.jsx($,{game:"Tetris"})]}),bt=8,ye=7,Cl=({userid:s,muted:o})=>{const[i,f]=t.useState(s||"");t.useEffect(()=>{var R,M,b;if(!s)try{const d=(R=window.Telegram)==null?void 0:R.WebApp;d&&((b=(M=d.initDataUnsafe)==null?void 0:M.user)!=null&&b.id)&&f(d.initDataUnsafe.user.id.toString())}catch{}},[s]);const[x,I]=t.useState(Math.floor(ye/2)),[c,v]=t.useState(0),[m,j]=t.useState(0),[A,k]=t.useState(!1),[L,B]=t.useState(!1),[_,w]=t.useState(!1);t.useEffect(()=>{if(A){B(!0),!o&&!H()&&Y("die");const R=setTimeout(()=>{I(Math.floor(ye/2)),v(0),j(0),k(!1),B(!1)},2e3);return()=>clearTimeout(R)}},[A,o]);const D=()=>{if(A)return;!o&&!H()&&Y("spin");let R=x;for(let b=0;b<bt;b++)R+=Math.random()<.5?-1:1,R=Math.max(0,Math.min(ye-1,R)),!o&&!H()&&Y("button");v(bt),I(R);const M=[10,20,50,100,50,20,10][R];j(M),w(!0),!o&&!H()&&Y("win"),setTimeout(()=>w(!1),800),k(!0)};t.useEffect(()=>{A&&m>0&&i&&J("Plinko",i,m)},[A,m,i]);const n=()=>{const R=[];for(let M=1;M<bt;M++)for(let b=0;b<ye;b++)(M+b)%2===1&&R.push(e.jsx("div",{className:"plinko-peg",style:{gridColumn:b+1,gridRow:M+1},children:"â—"},`peg-${b}-${M}`));return R},p=()=>e.jsx("div",{style:{display:"flex",width:ye*20,margin:"0 auto"},children:[10,20,50,100,50,20,10].map((R,M)=>e.jsx("div",{className:"plinko-bucket",style:{width:20},children:R},M))}),N=Array.from({length:18},()=>({x:Math.random()*ye*20,y:Math.random()*bt*20,r:3+Math.random()*2,opacity:.1+Math.random()*.18}));return e.jsxs("div",{className:"arcade-game",style:{background:"radial-gradient(ellipse at 60% 40%, #23234a 70%, #18182a 100%)",borderRadius:18,boxShadow:"0 0 32px #fd79a8",padding:24,maxWidth:340,margin:"0 auto",position:"relative",overflow:"hidden"},children:[e.jsx("svg",{width:ye*20,height:bt*20,style:{position:"absolute",left:0,top:0,zIndex:0},children:N.map((R,M)=>e.jsx("circle",{cx:R.x,cy:R.y+Math.sin(Date.now()/800+M)*10,r:R.r,fill:"#fd79a8",opacity:R.opacity},M))}),e.jsx("h4",{style:{color:"#fd79a8",textShadow:"0 0 8px #fff",marginBottom:8,zIndex:2,position:"relative"},children:"Plinko"}),e.jsxs("div",{className:"arcade-grid plinko-grid",style:{position:"relative",zIndex:2},children:[Array.from({length:bt*ye}).map((R,M)=>{const b=M%ye,d=Math.floor(M/ye);let T="";return d===c&&b===x&&(T="âšª"),e.jsx("div",{className:"arcade-cell",children:T},M)}),n()]}),p(),e.jsx("button",{onClick:()=>{!o&&!H()&&Y("button"),D()},disabled:A,style:{background:A?"#888":"linear-gradient(135deg,#fd79a8,#fff)",color:A?"#fff":"#fd79a8",borderRadius:10,padding:"8px 28px",fontWeight:700,fontSize:18,boxShadow:"0 0 8px #fd79a8",border:"none",margin:"12px 0 4px",cursor:A?"not-allowed":"pointer",transition:"background 0.2s, color 0.2s"},children:"Drop Ball"}),e.jsxs("div",{style:{color:"#fff",fontWeight:700,fontSize:18,margin:"10px 0 2px",textShadow:"0 0 8px #fd79a8",zIndex:2,position:"relative",animation:_?"popSuccess 0.5s":void 0},children:["Score: ",m]}),A&&e.jsx("div",{style:{color:"#fd79a8",fontWeight:900,fontSize:28,marginTop:10,textShadow:"0 0 18px #fff, 0 0 24px #fd79a8",animation:L?"popError 1.1s":void 0,zIndex:3,position:"relative"},children:"ðŸŽ¯ GAME OVER"}),e.jsxs("div",{style:{color:"#fd79a8",fontWeight:600,fontSize:14,marginTop:8,textShadow:"0 0 6px #fff"},children:["User: ",i||"Not connected"]}),e.jsx("style",{children:`
        @keyframes popSuccess {
          0% { transform: scale(1); }
          50% { transform: scale(1.2); }
          100% { transform: scale(1); }
        }
        @keyframes popError {
          0% { transform: scale(1); }
          50% { transform: scale(1.15); }
          100% { transform: scale(1); }
        }
      `})]})},Bl=({onBack:s,userId:o})=>e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:16},children:[e.jsx("button",{onClick:s,style:{alignSelf:"flex-start",margin:8},children:" Back to Arcade"}),e.jsx(Cl,{userid:o}),e.jsx($,{game:"Plinko"})]}),Ot=[{icon:"ðŸ’",color:"#e74c3c",payout:2},{icon:"ðŸ‹",color:"#f1c40f",payout:3},{icon:"ðŸ””",color:"#f39c12",payout:5},{icon:"ðŸ’Ž",color:"#00bfff",payout:10},{icon:"7ï¸âƒ£",color:"#e67e22",payout:20},{icon:"â­",color:"#f9e79f",payout:15},{icon:"ðŸ€",color:"#27ae60",payout:8}],bo=3,vo=3,Nl=.1,Pl=5,Ll=()=>Ot[Math.floor(Math.random()*Ot.length)],wo=()=>Array.from({length:vo},Ll),Dl=()=>Array.from({length:bo},wo);function _l(s){var f,x,I;let o=0;const i=[];for(let c=0;c<vo;c++){const v=s[0][c].icon;s.every(m=>m[c].icon===v)&&(o+=((f=Ot.find(m=>m.icon===v))==null?void 0:f.payout)||0,i.push(c))}return s[0][0].icon===s[1][1].icon&&s[1][1].icon===s[2][2].icon&&(o+=((x=Ot.find(c=>c.icon===s[0][0].icon))==null?void 0:x.payout)||0,i.push(3)),s[0][2].icon===s[1][1].icon&&s[1][1].icon===s[2][0].icon&&(o+=((I=Ot.find(c=>c.icon===s[0][2].icon))==null?void 0:I.payout)||0,i.push(4)),{win:o,winLines:i}}const Wl=({userId:s,coinBalance:o,onDeposit:i,onWithdraw:f,onScore:x,onBack:I})=>{const[c,v]=t.useState(Dl()),[m,j]=t.useState(!1),[A,k]=t.useState(""),[L,B]=t.useState("info"),[_,w]=t.useState(10),[D,n]=t.useState(!1),[p,u]=t.useState([]),[N,R]=t.useState(!1),[M,b]=t.useState(null),[d,T]=t.useState(""),[h,y]=t.useState(!1),[W,U]=t.useState(""),[S]=xn(),l=Qn(),a=o>=_&&!m,r=async()=>{if(!a)return;j(!0),k("Spinning..."),B("info"),u([]);const P=localStorage.getItem("userId")||"unknown";await Le(P,"arcade_spin",{game:"SlotMachine",bet:_}),setTimeout(()=>{const g=Array.from({length:bo},wo);v(g);const{win:z,winLines:E}=_l(g);u(E);const O=z*_;let F="",V="error";z>0?(F=`You win ${O} coins!`,V="success",x(O),Le(P,"arcade_win",{game:"SlotMachine",win:O})):(F="No win. Try again!",V="error"),Math.random()<Nl?(n(!0),setTimeout(()=>{const q=Math.floor(Math.random()*10+1)*Pl*_;k(`Bonus Game! You won ${q} coins!`),B("success"),x(q),Le(P,"arcade_bonus",{game:"SlotMachine",bonus:q}),n(!1)},1200)):(k(F),B(V)),j(!1)},1200),f(_)},C=async()=>{if(!l){k("Please connect your TON wallet first."),B("error");return}R(!0),k("Awaiting TON payment..."),B("info");try{const z=await S.sendTransaction({validUntil:Math.floor(Date.now()/1e3)+360,messages:[{address:vn,amount:"100000000"}]});b(z.boc||"");const E=l.account.address;try{await pa({userId:E,txHash:z.boc}),await as({userId:E,amount:100,action:"deposit"}),i(100),k("Deposit verified! +100 coins."),B("success"),await Le(l.account.address,"arcade_deposit",{game:"SlotMachine",tonAmount:.1,coinAmount:100})}catch{k("Deposit not verified. Please contact support."),B("error")}}catch(P){let g="Deposit cancelled or failed.";typeof P=="object"&&P&&"message"in P&&typeof P.message=="string"&&(g+=`
${P.message}`),k(g),B("error")}R(!1)},G=async()=>{var P;if(!d){U("Enter your TON wallet address."),B("error");return}y(!0),U("Processing withdrawal..."),B("info");try{const E=((P=l==null?void 0:l.account)==null?void 0:P.address)||"unknown";try{await as({userId:E,amount:100,action:"withdraw"}),U("Withdrawal request accepted! TON will be sent soon."),B("success"),f(100),await Le(E,"arcade_withdraw",{game:"SlotMachine",tonAmount:.1,coinAmount:100,withdrawAddress:d})}catch{U("Withdrawal failed. Please contact support."),B("error")}}catch(g){let z="Withdrawal failed.";typeof g=="object"&&g&&"message"in g&&typeof g.message=="string"&&(z+=`
${g.message}`),U(z),B("error")}y(!1)};return e.jsxs("div",{style:{background:"#222",borderRadius:16,padding:24,color:"#fff",boxShadow:"0 0 24px #f39c12",maxWidth:400,margin:"0 auto",position:"relative"},children:[e.jsx("button",{onClick:I,style:{position:"absolute",left:16,top:16,background:"#fff",color:"#f39c12",border:"none",borderRadius:8,padding:"2px 10px",fontWeight:700,cursor:"pointer",boxShadow:"0 0 4px #000"},children:"â† Back"}),e.jsx("h2",{style:{color:"#f39c12",textShadow:"0 0 8px #fff"},children:"ðŸŽ° Slot Machine"}),e.jsxs("div",{style:{display:"flex",justifyContent:"center",marginBottom:8},children:[e.jsx("span",{style:{fontWeight:600,color:"#fff"},children:"User ID:"})," ",e.jsx("span",{style:{marginLeft:8,color:"#f9e79f"},children:s})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"center",marginBottom:8},children:[e.jsx("span",{style:{fontWeight:600,color:"#fff"},children:"Balance:"})," ",e.jsx("span",{style:{marginLeft:8,color:"#00ff99"},children:o})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:8,marginBottom:8},children:[e.jsx(gn,{style:{marginBottom:8}}),e.jsx("button",{onClick:C,disabled:N,style:{background:"#27ae60",color:"#fff",borderRadius:8,padding:"4px 12px",border:"none",fontWeight:600,marginBottom:4},children:N?"Processing...":"Deposit 0.1 TON â†’ 100 coins"}),M&&e.jsx("div",{style:{color:"#00ff99",fontSize:10},children:"Tx sent!"}),e.jsxs("div",{style:{marginTop:8,width:"100%"},children:[e.jsx("input",{type:"text",placeholder:"Your TON wallet address",value:d,onChange:P=>T(P.target.value),style:{width:220,borderRadius:4,padding:4,marginRight:8},disabled:h}),e.jsx("button",{onClick:G,disabled:h||!o,style:{background:"#c0392b",color:"#fff",borderRadius:8,padding:"4px 12px",border:"none",fontWeight:600},children:h?"Processing...":"Withdraw 100 coins â†’ 0.1 TON"}),W&&e.jsx("div",{style:{color:"#00ff99",fontSize:10},children:W})]})]}),e.jsxs("div",{style:{background:"#111",borderRadius:12,padding:12,margin:"16px 0",boxShadow:"0 0 12px #f39c12 inset",display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx("div",{style:{display:"flex",gap:8,marginBottom:8},children:c.map((P,g)=>e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:4},children:P.map((z,E)=>e.jsx("div",{style:{width:48,height:48,fontSize:32,background:p.includes(E)?"#f9e79f":z.color,borderRadius:8,display:"flex",alignItems:"center",justifyContent:"center",boxShadow:p.includes(E)?"0 0 16px #fff":"0 0 8px #000",border:"2px solid #fff",transition:"background 0.3s, box-shadow 0.3s",animation:m?"spin 0.6s linear infinite":void 0},children:z.icon},E))},g))}),e.jsxs("div",{style:{margin:"8px 0",color:"#fff",fontWeight:600},children:["Bet: ",e.jsx("input",{type:"number",min:1,max:o,value:_,onChange:P=>w(Math.max(1,Math.min(o,Number(P.target.value)))),style:{width:60,borderRadius:4,padding:2}})]}),e.jsx("button",{onClick:r,disabled:!a,style:{background:"#f39c12",color:"#fff",borderRadius:12,padding:"8px 32px",fontWeight:700,fontSize:20,boxShadow:"0 0 16px #f9e79f",border:"none",marginTop:8,cursor:a?"pointer":"not-allowed",transition:"background 0.2s"},children:m?"Spinning...":"SPIN"}),D&&e.jsx("div",{style:{color:"#00ff99",fontWeight:700,fontSize:18,marginTop:8,textShadow:"0 0 8px #fff"},children:"BONUS GAME!"}),e.jsx("div",{style:{marginTop:12,minHeight:24,color:L==="success"?"#00ff99":L==="error"?"#ff4d4f":"#fff",fontWeight:600,textShadow:L==="success"?"0 0 8px #00ff99":L==="error"?"0 0 8px #ff4d4f":void 0,animation:L==="success"&&A?"popSuccess 0.5s":L==="error"&&A?"popError 0.5s":void 0,transition:"color 0.2s, text-shadow 0.2s"},children:A}),e.jsx("style",{children:`
          @keyframes popSuccess {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
          }
          @keyframes popError {
            0% { transform: scale(1); }
            50% { transform: scale(1.15); }
            100% { transform: scale(1); }
          }
        `})]}),e.jsx($,{game:"SlotMachine"}),e.jsx("style",{children:`
        @keyframes spin {
          0% { transform: rotateX(0deg); }
          100% { transform: rotateX(360deg); }
        }
      `})]})},Ut=[{icon:"ðŸ›¸",color:"#00fff7",payout:3},{icon:"ðŸ¤–",color:"#ff00ea",payout:5},{icon:"ðŸ’¾",color:"#00ff85",payout:7},{icon:"âš¡",color:"#ffe600",payout:10},{icon:"ðŸ’Ž",color:"#ff00c8",payout:20},{icon:"ðŸ¦¾",color:"#00e1ff",payout:15},{icon:"ðŸ‘¾",color:"#ff5e00",payout:25}],ko=3,Ao=3,zl=.12,Ol=7,Ul=()=>Ut[Math.floor(Math.random()*Ut.length)],jo=()=>Array.from({length:Ao},Ul),Gl=()=>Array.from({length:ko},jo);function Hl(s){var f,x,I;let o=0;const i=[];for(let c=0;c<Ao;c++){const v=s[0][c].icon;s.every(m=>m[c].icon===v)&&(o+=((f=Ut.find(m=>m.icon===v))==null?void 0:f.payout)||0,i.push(c))}return s[0][0].icon===s[1][1].icon&&s[1][1].icon===s[2][2].icon&&(o+=((x=Ut.find(c=>c.icon===s[0][0].icon))==null?void 0:x.payout)||0,i.push(3)),s[0][2].icon===s[1][1].icon&&s[1][1].icon===s[2][0].icon&&(o+=((I=Ut.find(c=>c.icon===s[0][2].icon))==null?void 0:I.payout)||0,i.push(4)),{win:o,winLines:i}}const Yl=({userId:s,onBack:o,theme:i="cyberpunk",muted:f})=>{const[x,I]=t.useState(s||""),[c,v]=t.useState(!0);t.useEffect(()=>{const S=setTimeout(()=>v(!1),1200);return x&&Le(x,"slotmachine2_opened"),v(!0),()=>clearTimeout(S)},[x]),t.useEffect(()=>{var S,l,a;if(!s)try{const r=(S=window.Telegram)==null?void 0:S.WebApp;r&&((a=(l=r.initDataUnsafe)==null?void 0:l.user)!=null&&a.id)&&I(r.initDataUnsafe.user.id.toString())}catch{}},[s]);const[m,j]=t.useState(Gl()),[A,k]=t.useState(!1),[L,B]=t.useState(""),[_,w]=t.useState("info"),[D,n]=t.useState(10),[p,u]=t.useState(500),[N,R]=t.useState(!1),[M,b]=t.useState([]),[d,T]=t.useState(!1),[h,y]=t.useState(!1),W=p>=D&&!A,U=()=>{W&&(!f&&!H()&&Y("spin"),k(!0),B("Spinning..."),w("info"),b([]),setTimeout(()=>{const S=Array.from({length:ko},jo);j(S);const{win:l,winLines:a}=Hl(S);b(a);const r=l*D;let C="",G="error";l>0?(C=`You win ${r} coins!`,G="success",u(P=>P+r),T(!0),!f&&!H()&&Y("win"),setTimeout(()=>T(!1),1200)):(C="No win. Try again!",G="error"),Math.random()<zl?(R(!0),y(!0),!f&&!H()&&Y("bonus"),setTimeout(()=>{const P=Math.floor(Math.random()*10+1)*Ol*D;B(`Bonus! You won ${P} coins!`),w("success"),u(g=>g+P),R(!1),y(!1)},1200)):(B(C),w(G)),k(!1),u(P=>P-D)},1200))};return c?e.jsxs("div",{style:{background:i==="cyberpunk"?"radial-gradient(ellipse at 60% 40%, #23234a 70%, #18182a 100%)":"#18182a",borderRadius:20,padding:28,color:"#fff",boxShadow:"0 0 32px #00fff7",maxWidth:420,margin:"0 auto",position:"relative",overflow:"hidden",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:420},children:[e.jsx("div",{style:{fontSize:38,color:"#00fff7",marginBottom:18},children:"ðŸ›¸"}),e.jsx("div",{style:{fontWeight:700,fontSize:24,color:"#00fff7",marginBottom:8},children:"Deploying Cyberpunk Slot..."}),e.jsx("div",{style:{color:"#fff",fontSize:16,opacity:.7},children:"Initializing game engine..."}),e.jsx("div",{className:"loader",style:{marginTop:24},children:e.jsx("div",{style:{width:48,height:48,border:"6px solid #00fff7",borderTop:"6px solid #23234a",borderRadius:"50%",animation:"spin 1s linear infinite"}})}),e.jsx("style",{children:"@keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }"})]}):e.jsxs("div",{style:{background:i==="cyberpunk"?"radial-gradient(ellipse at 60% 40%, #23234a 70%, #18182a 100%)":"#18182a",borderRadius:20,padding:28,color:"#fff",boxShadow:"0 0 32px #00fff7",maxWidth:420,margin:"0 auto",position:"relative",overflow:"hidden"},children:[e.jsxs("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",pointerEvents:"none",zIndex:0},children:[[...Array(18)].map((S,l)=>e.jsx("div",{style:{position:"absolute",left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,width:8+Math.random()*8,height:8+Math.random()*8,borderRadius:"50%",background:"linear-gradient(135deg,#00fff7,#ff00ea,#ffe600,#00ff85)",opacity:.12+Math.random()*.18,filter:"blur(1.5px)",animation:`floatParticle 6s ${Math.random()*4}s infinite alternate`}},l)),e.jsx("style",{children:`
          @keyframes floatParticle {
            0% { transform: translateY(0); }
            100% { transform: translateY(-30px); }
          }
        `})]}),e.jsx("button",{onClick:()=>{!f&&!H()&&Y("button"),o()},style:{position:"absolute",left:16,top:16,background:"linear-gradient(135deg,#fff,#00fff7)",color:"#00fff7",border:"none",borderRadius:10,padding:"4px 14px",fontWeight:700,cursor:"pointer",boxShadow:"0 0 6px #00fff7",fontSize:18,zIndex:2,transition:"background 0.2s, color 0.2s"},onMouseDown:S=>S.currentTarget.style.background="#00fff7",onMouseUp:S=>S.currentTarget.style.background="linear-gradient(135deg,#fff,#00fff7)",children:"â† Back"}),e.jsx("h2",{style:{color:"#00fff7",textShadow:"0 0 12px #ff00ea",fontSize:32,marginBottom:8,zIndex:2,position:"relative"},children:"ðŸ›¸ Cyberpunk Slot"}),e.jsxs("div",{style:{display:"flex",justifyContent:"center",marginBottom:8,zIndex:2,position:"relative"},children:[e.jsx("span",{style:{fontWeight:600,color:"#fff"},children:"User ID:"})," ",e.jsx("span",{style:{marginLeft:8,color:"#ffe600"},children:x||"Not connected"})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"center",marginBottom:8,zIndex:2,position:"relative"},children:[e.jsx("span",{style:{fontWeight:600,color:"#fff"},children:"Balance:"})," ",e.jsx("span",{style:{marginLeft:8,color:"#00ff85"},children:p})]}),e.jsxs("div",{style:{background:"#23234a",borderRadius:14,padding:14,margin:"18px 0",boxShadow:"0 0 18px #00fff7 inset",display:"flex",flexDirection:"column",alignItems:"center",zIndex:2,position:"relative"},children:[e.jsx("div",{style:{display:"flex",gap:10,marginBottom:10},children:m.map((S,l)=>e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:6},children:S.map((a,r)=>e.jsx("div",{style:{width:54,height:54,fontSize:36,background:M.includes(r)?"#ffe600":a.color,borderRadius:10,display:"flex",alignItems:"center",justifyContent:"center",boxShadow:M.includes(r)?"0 0 18px #fff":"0 0 10px #000",border:"2.5px solid #fff",transition:"background 0.3s, box-shadow 0.3s",animation:A?"spin 0.6s linear infinite":void 0,filter:d&&M.includes(r)?"drop-shadow(0 0 16px #ffe600)":void 0},children:a.icon},r))},l))}),e.jsxs("div",{style:{margin:"10px 0",color:"#fff",fontWeight:600,fontSize:18},children:["Bet: ",e.jsx("input",{type:"number",min:1,max:p,value:D,onChange:S=>n(Math.max(1,Math.min(p,Number(S.target.value)))),style:{width:60,borderRadius:6,padding:4,fontSize:18}})]}),e.jsx("button",{onClick:()=>{!f&&!H()&&Y("button"),U()},disabled:!W,style:{background:W?"linear-gradient(135deg,#00fff7,#ff00ea,#ffe600,#00ff85)":"#333",color:W?"#18182a":"#888",borderRadius:14,padding:"10px 38px",fontWeight:800,fontSize:24,boxShadow:W?"0 0 18px #ff00ea":"none",border:"none",marginTop:10,cursor:W?"pointer":"not-allowed",transition:"background 0.2s, color 0.2s",zIndex:2},onMouseDown:S=>S.currentTarget.style.background="#00fff7",onMouseUp:S=>S.currentTarget.style.background="linear-gradient(135deg,#00fff7,#ff00ea,#ffe600,#00ff85)",children:A?"Spinning...":"SPIN"}),N&&e.jsx("div",{style:{color:"#ffe600",fontWeight:800,fontSize:22,marginTop:10,textShadow:"0 0 12px #fff",letterSpacing:1},children:"BONUS!"}),d&&e.jsx("div",{style:{position:"absolute",left:"50%",top:"30%",transform:"translate(-50%, -50%)",color:"#ffe600",fontWeight:900,fontSize:38,textShadow:"0 0 24px #fff, 0 0 32px #ffe600",pointerEvents:"none",zIndex:10,animation:"popSuccess 1.1s"},children:"ðŸŽ‰ WIN!"}),h&&e.jsx("div",{style:{position:"absolute",left:"50%",top:"60%",transform:"translate(-50%, -50%)",color:"#ffe600",fontWeight:900,fontSize:34,textShadow:"0 0 24px #fff, 0 0 32px #ffe600",pointerEvents:"none",zIndex:10,animation:"popBonus 1.1s"},children:"âœ¨ BONUS âœ¨"}),e.jsx("div",{style:{marginTop:14,minHeight:28,color:_==="success"?"#00ff85":_==="error"?"#ff5e00":"#fff",fontWeight:700,fontSize:18,textShadow:_==="success"?"0 0 10px #00ff85":_==="error"?"0 0 10px #ff5e00":void 0,animation:_==="success"&&L?"popSuccess 0.5s":_==="error"&&L?"popError 0.5s":void 0,transition:"color 0.2s, text-shadow 0.2s"},children:L}),e.jsx("style",{children:`
          @keyframes popSuccess {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
          }
          @keyframes popError {
            0% { transform: scale(1); }
            50% { transform: scale(1.15); }
            100% { transform: scale(1); }
          }
          @keyframes popBonus {
            0% { opacity: 0; transform: scale(0.7); }
            30% { opacity: 1; transform: scale(1.2); }
            80% { opacity: 1; transform: scale(1); }
            100% { opacity: 0; transform: scale(0.8); }
          }
          @keyframes spin {
            0% { transform: rotateX(0deg); }
            100% { transform: rotateX(360deg); }
          }
        `})]}),e.jsx($,{game:"SlotMachine2"})]})},Fl=({userId:s,onBack:o})=>e.jsx(Yl,{userId:s,onBack:o}),Gt=[{icon:"ðŸ¦‚",color:"#e1b12c",payout:3},{icon:"ðŸ",color:"#44bd32",payout:5},{icon:"ðŸ‘‘",color:"#fbc531",payout:8},{icon:"ðŸ¦…",color:"#273c75",payout:12},{icon:"ðŸ’Ž",color:"#00a8ff",payout:20},{icon:"âš±ï¸",color:"#718093",payout:15},{icon:"ðŸ¦š",color:"#9c88ff",payout:25}],Eo=3,Io=3,Vl=.13,Kl=6,ql=()=>Gt[Math.floor(Math.random()*Gt.length)],To=()=>Array.from({length:Io},ql),Xl=()=>Array.from({length:Eo},To);function Zl(s){var f,x,I;let o=0;const i=[];for(let c=0;c<Io;c++){const v=s[0][c].icon;s.every(m=>m[c].icon===v)&&(o+=((f=Gt.find(m=>m.icon===v))==null?void 0:f.payout)||0,i.push(c))}return s[0][0].icon===s[1][1].icon&&s[1][1].icon===s[2][2].icon&&(o+=((x=Gt.find(c=>c.icon===s[0][0].icon))==null?void 0:x.payout)||0,i.push(3)),s[0][2].icon===s[1][1].icon&&s[1][1].icon===s[2][0].icon&&(o+=((I=Gt.find(c=>c.icon===s[0][2].icon))==null?void 0:I.payout)||0,i.push(4)),{win:o,winLines:i}}const Ql=({userId:s,onBack:o,muted:i})=>{const[f,x]=t.useState(s||"");t.useEffect(()=>{var y,W,U;if(!s)try{const S=(y=window.Telegram)==null?void 0:y.WebApp;S&&((U=(W=S.initDataUnsafe)==null?void 0:W.user)!=null&&U.id)&&x(S.initDataUnsafe.user.id.toString())}catch{}},[s]);const[I,c]=t.useState(Xl()),[v,m]=t.useState(!1),[j,A]=t.useState(""),[k,L]=t.useState("info"),[B,_]=t.useState(10),[w,D]=t.useState(500),[n,p]=t.useState(!1),[u,N]=t.useState([]),[R,M]=t.useState(!1),[b,d]=t.useState(!1),T=w>=B&&!v,h=()=>{T&&(!i&&!H()&&Y("spin"),m(!0),A("Spinning..."),L("info"),N([]),setTimeout(()=>{const y=Array.from({length:Eo},To);c(y);const{win:W,winLines:U}=Zl(y);N(U);const S=W*B;let l="",a="error";W>0?(l=`You win ${S} coins!`,a="success",D(r=>r+S),M(!0),!i&&!H()&&Y("win"),setTimeout(()=>M(!1),1200)):(l="No win. Try again!",a="error"),Math.random()<Vl?(p(!0),d(!0),!i&&!H()&&Y("bonus"),setTimeout(()=>{const r=Math.floor(Math.random()*10+1)*Kl*B;A(`Bonus! You won ${r} coins!`),L("success"),D(C=>C+r),p(!1),d(!1)},1200)):(A(l),L(a)),m(!1),D(r=>r-B)},1200))};return e.jsxs("div",{style:{background:"radial-gradient(ellipse at 60% 40%, #f5e6c4 70%, #e1b12c 100%)",borderRadius:20,padding:28,color:"#222",boxShadow:"0 0 32px #e1b12c",maxWidth:420,margin:"0 auto",position:"relative",overflow:"hidden"},children:[e.jsxs("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",pointerEvents:"none",zIndex:0},children:[[...Array(16)].map((y,W)=>e.jsx("div",{style:{position:"absolute",left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,width:8+Math.random()*8,height:8+Math.random()*8,borderRadius:"50%",background:"linear-gradient(135deg,#e1b12c,#fbc531,#fffbe6)",opacity:.13+Math.random()*.18,filter:"blur(1.5px)",animation:`floatGold 7s ${Math.random()*4}s infinite alternate`}},W)),e.jsx("style",{children:`
          @keyframes floatGold {
            0% { transform: translateY(0); }
            100% { transform: translateY(-30px); }
          }
        `})]}),e.jsx("button",{onClick:()=>{!i&&!H()&&Y("button"),o()},style:{position:"absolute",left:16,top:16,background:"linear-gradient(135deg,#fff,#e1b12c)",color:"#e1b12c",border:"none",borderRadius:10,padding:"4px 14px",fontWeight:700,cursor:"pointer",boxShadow:"0 0 6px #e1b12c",fontSize:18,zIndex:2,transition:"background 0.2s, color 0.2s"},onMouseDown:y=>y.currentTarget.style.background="#e1b12c",onMouseUp:y=>y.currentTarget.style.background="linear-gradient(135deg,#fff,#e1b12c)",children:"â† Back"}),e.jsx("h2",{style:{color:"#e1b12c",textShadow:"0 0 12px #44bd32",fontSize:32,marginBottom:8,zIndex:2,position:"relative"},children:"ðŸ‘‘ Egypt Slot"}),e.jsxs("div",{style:{display:"flex",justifyContent:"center",marginBottom:8,zIndex:2,position:"relative"},children:[e.jsx("span",{style:{fontWeight:600,color:"#222"},children:"User ID:"})," ",e.jsx("span",{style:{marginLeft:8,color:"#44bd32"},children:f||"Not connected"})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"center",marginBottom:8,zIndex:2,position:"relative"},children:[e.jsx("span",{style:{fontWeight:600,color:"#222"},children:"Balance:"})," ",e.jsx("span",{style:{marginLeft:8,color:"#00a8ff"},children:w})]}),e.jsxs("div",{style:{background:"#f7d794",borderRadius:14,padding:14,margin:"18px 0",boxShadow:"0 0 18px #e1b12c inset",display:"flex",flexDirection:"column",alignItems:"center",zIndex:2,position:"relative"},children:[e.jsx("div",{style:{display:"flex",gap:10,marginBottom:10},children:I.map((y,W)=>e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:6},children:y.map((U,S)=>e.jsx("div",{style:{width:54,height:54,fontSize:36,background:u.includes(S)?"#fbc531":U.color,borderRadius:10,display:"flex",alignItems:"center",justifyContent:"center",boxShadow:u.includes(S)?"0 0 18px #fff":"0 0 10px #000",border:"2.5px solid #fff",transition:"background 0.3s, box-shadow 0.3s",animation:v?"spin 0.6s linear infinite":void 0,filter:R&&u.includes(S)?"drop-shadow(0 0 16px #fbc531)":void 0},children:U.icon},S))},W))}),e.jsxs("div",{style:{margin:"10px 0",color:"#222",fontWeight:600,fontSize:18},children:["Bet: ",e.jsx("input",{type:"number",min:1,max:w,value:B,onChange:y=>_(Math.max(1,Math.min(w,Number(y.target.value)))),style:{width:60,borderRadius:6,padding:4,fontSize:18}})]}),e.jsx("button",{onClick:()=>{!i&&!H()&&Y("button"),h()},disabled:!T,style:{background:T?"linear-gradient(135deg,#e1b12c,#fbc531,#fffbe6)":"#ccc",color:T?"#222":"#888",borderRadius:14,padding:"10px 38px",fontWeight:800,fontSize:24,boxShadow:T?"0 0 18px #e1b12c":"none",border:"none",marginTop:10,cursor:T?"pointer":"not-allowed",transition:"background 0.2s, color 0.2s",zIndex:2},onMouseDown:y=>y.currentTarget.style.background="#e1b12c",onMouseUp:y=>y.currentTarget.style.background="linear-gradient(135deg,#e1b12c,#fbc531,#fffbe6)",children:v?"Spinning...":"SPIN"}),n&&e.jsx("div",{style:{color:"#44bd32",fontWeight:800,fontSize:22,marginTop:10,textShadow:"0 0 12px #fff",letterSpacing:1},children:"BONUS!"}),R&&e.jsx("div",{style:{position:"absolute",left:"50%",top:"30%",transform:"translate(-50%, -50%)",color:"#fbc531",fontWeight:900,fontSize:38,textShadow:"0 0 24px #fff, 0 0 32px #fbc531",pointerEvents:"none",zIndex:10,animation:"popSuccess 1.1s"},children:"ðŸŽ‰ WIN!"}),b&&e.jsx("div",{style:{position:"absolute",left:"50%",top:"60%",transform:"translate(-50%, -50%)",color:"#fbc531",fontWeight:900,fontSize:34,textShadow:"0 0 24px #fff, 0 0 32px #fbc531",pointerEvents:"none",zIndex:10,animation:"popBonus 1.1s"},children:"âœ¨ BONUS âœ¨"}),e.jsx("div",{style:{marginTop:14,minHeight:28,color:k==="success"?"#44bd32":k==="error"?"#c23616":"#222",fontWeight:700,fontSize:18,textShadow:k==="success"?"0 0 10px #44bd32":k==="error"?"0 0 10px #c23616":void 0,animation:k==="success"&&j?"popSuccess 0.5s":k==="error"&&j?"popError 0.5s":void 0,transition:"color 0.2s, text-shadow 0.2s"},children:j}),e.jsx("style",{children:`
          @keyframes popSuccess {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
          }
          @keyframes popError {
            0% { transform: scale(1); }
            50% { transform: scale(1.15); }
            100% { transform: scale(1); }
          }
          @keyframes popBonus {
            0% { opacity: 0; transform: scale(0.7); }
            30% { opacity: 1; transform: scale(1.2); }
            80% { opacity: 1; transform: scale(1); }
            100% { opacity: 0; transform: scale(0.8); }
          }
          @keyframes spin {
            0% { transform: rotateX(0deg); }
            100% { transform: rotateX(360deg); }
          }
        `})]}),e.jsx($,{game:"SlotMachine3"})]})},Jl=({userId:s,onBack:o})=>e.jsx(Ql,{userId:s,onBack:o}),$l=s=>{const o=s.userId,[i,f]=t.useState(null),x="Summer Memory Match!",I="Play Memory Match for bonus rewards this week!";let c=null;i==="PunchOut"?c=e.jsx(Ai,{}):i==="DonkeyKong"?c=e.jsx(Qi,{onBack:()=>f(null)}):i==="Pacman"?c=e.jsx(El,{onBack:()=>f(null)}):i==="Asteroids"?c=e.jsx(Tl,{onBack:()=>f(null)}):i==="Tetris"?c=e.jsx(Rl,{onBack:()=>f(null)}):i==="Plinko"?c=e.jsx(Bl,{onBack:()=>f(null)}):i==="SlotMachine"?c=e.jsx(Wl,{userId:o,coinBalance:s.coinBalance||0,onDeposit:s.onDeposit||(()=>{}),onWithdraw:s.onWithdraw||(()=>{}),onScore:s.onScore||(()=>{}),onBack:()=>f(null)}):i==="SlotMachine2"?c=e.jsx(Fl,{userId:o,onBack:()=>f(null)}):i==="SlotMachine3"?c=e.jsx(Jl,{userId:o,onBack:()=>f(null)}):i==="MemoryMatch"?c=e.jsx(Fi,{onScore:s.onScore||(()=>{})}):i==="Sinistar"?c=e.jsx(al,{onBack:()=>f(null),userId:o}):i==="Commando"?c=e.jsx(cl,{}):i==="Centipede"?c=e.jsx(dl,{}):i==="Snake"?c=e.jsx(yl,{}):i==="DigDug"?c=e.jsx(vl,{}):i==="Joust"?c=e.jsx(xl,{onBack:()=>f(null)}):i==="SpaceInvaders"?c=e.jsx(nl,{onBack:()=>f(null)}):i==="PaperBoy"?c=e.jsx(kl,{}):i==="Qbert"?c=e.jsx(Ci,{userId:o}):i==="Rampage"?c=e.jsx(Li,{userId:o}):i==="StreetFighter"?c=e.jsx(Wi,{userId:o}):i==="RType"?c=e.jsx(Si,{userId:""}):i==="DangerousBeautySlot"?c=e.jsx(ii,{userId:o,onBack:()=>f(null)}):i==="MoonMaidenSlot"&&(c=e.jsx(xi,{userId:o,onBack:()=>f(null)}));const v=[{key:"DangerousBeautySlot",label:"ðŸŒ¸ Dangerous Beauty",onClick:()=>f("DangerousBeautySlot"),style:{background:"linear-gradient(135deg,#ffb7e5,#fd79a8)",color:"#e17055",fontWeight:700,boxShadow:"0 0 16px #e17055"}},{key:"MoonMaidenSlot",label:"ðŸŒ™ Moon Maiden",onClick:()=>f("MoonMaidenSlot"),style:{background:"linear-gradient(135deg,#b2bec3,#6c5ce7)",color:"#6c5ce7",fontWeight:700,boxShadow:"0 0 16px #6c5ce7"}},{key:"PunchOut",label:"ðŸ¥Š Punch Out",onClick:()=>f("PunchOut")},{key:"MemoryMatch",label:"ðŸ§  Memory Match",onClick:()=>f("MemoryMatch")},{key:"DonkeyKong",label:"ï¿½ Donkey Kong",onClick:()=>f("DonkeyKong")},{key:"Pacman",label:e.jsxs(e.Fragment,{children:[e.jsx("img",{src:zi,alt:"Pacman",style:{width:38,marginBottom:4}}),"Pacman"]}),onClick:()=>f("Pacman")},{key:"Asteroids",label:e.jsxs(e.Fragment,{children:[e.jsx("img",{src:Jn,alt:"Asteroids",style:{width:38,marginBottom:4}}),"Asteroids"]}),onClick:()=>f("Asteroids")},{key:"Tetris",label:e.jsxs(e.Fragment,{children:[e.jsx("img",{src:Oi,alt:"Tetris",style:{width:38,marginBottom:4}}),"Tetris"]}),onClick:()=>f("Tetris")},{key:"Plinko",label:e.jsxs(e.Fragment,{children:[e.jsx("img",{src:es,alt:"Plinko",style:{width:38,marginBottom:4}}),"Plinko"]}),onClick:()=>f("Plinko")},{key:"SlotMachine",label:e.jsxs(e.Fragment,{children:[e.jsx("img",{src:Rn,alt:"Slot Machine",style:{width:38,marginBottom:4}}),"Slot Machine ðŸŽ°"]}),onClick:()=>f("SlotMachine"),style:{background:"linear-gradient(135deg,#f39c12,#e74c3c,#00bfff,#f9e79f)",color:"#fff",fontWeight:700,boxShadow:"0 0 16px #f39c12"}},{key:"SlotMachine2",label:e.jsxs(e.Fragment,{children:[e.jsx("img",{src:Rn,alt:"Slot Machine 2",style:{width:38,marginBottom:4}}),"Cyberpunk Slot ðŸ›¸"]}),onClick:()=>f("SlotMachine2"),style:{background:"linear-gradient(135deg,#00fff7,#ff00ea,#00ff85,#ffe600)",color:"#222",fontWeight:700,boxShadow:"0 0 16px #00fff7"}},{key:"SlotMachine3",label:e.jsxs(e.Fragment,{children:[e.jsx("img",{src:Rn,alt:"Slot Machine 3",style:{width:38,marginBottom:4}}),"Egypt Slot ðŸ‘‘"]}),onClick:()=>f("SlotMachine3"),style:{background:"linear-gradient(135deg,#e1b12c,#44bd32,#fbc531,#00a8ff)",color:"#222",fontWeight:700,boxShadow:"0 0 16px #e1b12c"}},{key:"Sinistar",label:"ðŸ‘¹ Sinistar",onClick:()=>f("Sinistar")},{key:"Commando",label:"ðŸª– Commando",onClick:()=>f("Commando")},{key:"Centipede",label:"ðŸ› Centipede",onClick:()=>f("Centipede")},{key:"Snake",label:"ðŸ Snake",onClick:()=>f("Snake")},{key:"DigDug",label:"ðŸ‘· Dig Dug",onClick:()=>f("DigDug")},{key:"Joust",label:"ðŸ¦… Joust",onClick:()=>f("Joust")},{key:"SpaceInvaders",label:"ðŸ‘¾ Space Invaders",onClick:()=>f("SpaceInvaders")},{key:"PaperBoy",label:"ðŸš´ Paper Boy",onClick:()=>f("PaperBoy")},{key:"Qbert",label:"ðŸŸ¡ Q*bert",onClick:()=>f("Qbert")},{key:"Rampage",label:"ðŸ¦ Rampage",onClick:()=>f("Rampage")},{key:"StreetFighter",label:"ðŸ¥‹ Street Fighter",onClick:()=>f("StreetFighter")},{key:"RType",label:"ðŸš€ R-Type",onClick:()=>f("RType")}];return e.jsx("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:24},children:c||e.jsxs(e.Fragment,{children:[e.jsx("h2",{children:"Arcade Mini-Games"}),e.jsxs("div",{style:{background:"#ffe259",color:"#24308a",borderRadius:10,padding:"10px 18px",fontWeight:700,marginBottom:8,boxShadow:"0 2px 8px #24308a22"},children:[e.jsxs("span",{style:{fontSize:16},children:["ðŸŒž ",x]}),e.jsx("div",{style:{fontSize:13,fontWeight:400},children:I})]}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:32,justifyContent:"center"},children:v.map(m=>e.jsx("button",{className:"arcade-game",style:{minWidth:120,minHeight:80,outline:"none",boxShadow:"0 0 0 2px #24308a33",transition:"box-shadow 0.2s",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",...m.style||{}},onClick:m.onClick,"aria-label":`Play ${m.key}`,tabIndex:0,onKeyDown:j=>{(j.key==="Enter"||j.key===" ")&&m.onClick()},onFocus:j=>j.currentTarget.style.boxShadow="0 0 0 3px #24308a",onBlur:j=>j.currentTarget.style.boxShadow="0 0 0 2px #24308a33",children:m.label},m.key))})]})})},ec="_airdropBg_w10tt_1",tc="_airdropContainer_w10tt_10",nc="_headerSection_w10tt_23",sc="_headerIcon_w10tt_28",oc="_title_w10tt_43",ac="_subtitle_w10tt_50",rc="_highlight_w10tt_56",ic="_walletSection_w10tt_61",lc="_tonBtn_w10tt_65",cc="_donateCard_w10tt_77",fc="_donateTitle_w10tt_90",dc="_donateIcon_w10tt_99",uc="_donateDesc_w10tt_105",hc="_inputRow_w10tt_112",xc="_input_w10tt_112",gc="_donateBtn_w10tt_128",pc="_success_w10tt_147",yc="_error_w10tt_153",mc="_effectsSection_w10tt_159",Sc="_effectsTitle_w10tt_164",bc="_effectsGrid_w10tt_172",vc="_effectCard_w10tt_179",wc="_effectIcon_w10tt_209",kc="_effectName_w10tt_215",Ac="_effectDesc_w10tt_221",Z={airdropBg:ec,airdropContainer:tc,headerSection:nc,headerIcon:sc,title:oc,subtitle:ac,highlight:rc,walletSection:ic,tonBtn:lc,donateCard:cc,donateTitle:fc,donateIcon:dc,donateDesc:uc,inputRow:hc,input:xc,donateBtn:gc,success:pc,error:yc,effectsSection:mc,effectsTitle:Sc,effectsGrid:bc,effectCard:vc,effectIcon:wc,effectName:kc,effectDesc:Ac},jc=()=>{const[s,o]=t.useState(""),[i,f]=t.useState(null),[x,I]=t.useState(!1),[c]=xn(),v=async()=>{if(f(null),!s||isNaN(Number(s))||Number(s)<=0){f("Please enter a valid TON amount.");return}I(!0);try{await c.sendTransaction({validUntil:Math.floor(Date.now()/1e3)+360,messages:[{address:vn,amount:(Number(s)*1e9).toString()}]}),f("âœ… Thank you for your donation!"),o("");const m=localStorage.getItem("userId")||"unknown";await ga({userId:m,amount:Number(s)}),await Le(m,"airdrop_donation",{amountTon:Number(s)})}catch(m){let j="Transaction cancelled or failed.";typeof m=="object"&&m&&"message"in m&&typeof m.message=="string"&&(j+=`
${m.message}`),f(j)}I(!1)};return e.jsx("div",{className:Z.airdropBg,children:e.jsxs("div",{className:Z.airdropContainer,children:[e.jsxs("div",{className:Z.headerSection,children:[e.jsx("img",{src:qe,alt:"Airdrop",className:Z.headerIcon}),e.jsx("h2",{className:Z.title,children:"Airdrop & Charity"}),e.jsxs("p",{className:Z.subtitle,children:["Connect your TON wallet and become a Guardian Angel!",e.jsx("br",{}),e.jsx("span",{className:Z.highlight,children:"Donate any amount of TON to charity and help create a better tomorrow."})]})]}),e.jsx("div",{className:Z.walletSection,children:e.jsx(gn,{className:Z.tonBtn})}),e.jsxs("div",{className:Z.donateCard,children:[e.jsxs("div",{className:Z.donateTitle,children:[e.jsx("img",{src:we,alt:"Guardian Angel",className:Z.donateIcon}),e.jsx("span",{children:"Become a Guardian Angel"})]}),e.jsx("div",{className:Z.donateDesc,children:"Enter the amount of TON you wish to donate. Every contribution makes a difference!"}),e.jsxs("div",{className:Z.inputRow,children:[e.jsx("input",{type:"number",min:"0",step:"0.01",placeholder:"Amount (TON)",value:s,onChange:m=>o(m.target.value),className:Z.input,"aria-label":"Donation amount in TON",tabIndex:0,style:{outline:"none",boxShadow:"0 0 0 2px #24308a33",transition:"box-shadow 0.2s"},onFocus:m=>m.currentTarget.style.boxShadow="0 0 0 3px #24308a",onBlur:m=>m.currentTarget.style.boxShadow="0 0 0 2px #24308a33"}),e.jsx("button",{onClick:v,className:Z.donateBtn,disabled:x,"aria-label":"Donate TON to charity",tabIndex:0,style:{outline:"none",boxShadow:"0 0 0 2px #24308a33",transition:"box-shadow 0.2s"},onKeyDown:m=>{(m.key==="Enter"||m.key===" ")&&v()},onFocus:m=>m.currentTarget.style.boxShadow="0 0 0 3px #24308a",onBlur:m=>m.currentTarget.style.boxShadow="0 0 0 2px #24308a33",children:x?"Processing...":"Donate"})]}),i&&e.jsxs("div",{className:i.startsWith("âœ…")?Z.success:Z.error,style:i.startsWith("âœ…")?{animation:"popSuccess 0.5s"}:{},children:[i,e.jsx("style",{children:`
												@keyframes popSuccess {
													0% { transform: scale(0.8); opacity: 0.5; }
													60% { transform: scale(1.1); opacity: 1; }
													100% { transform: scale(1); opacity: 1; }
												}
											`})]})]}),e.jsxs("div",{className:Z.effectsSection,children:[e.jsx("h3",{className:Z.effectsTitle,children:"Airdrop Effects"}),e.jsxs("div",{className:Z.effectsGrid,children:[e.jsxs("div",{className:Z.effectCard,children:[e.jsx("img",{src:Sn,alt:"Boost",className:Z.effectIcon}),e.jsx("div",{className:Z.effectName,children:"Boosts"}),e.jsx("div",{className:Z.effectDesc,children:"Special boosts for all donors during airdrop events."})]}),e.jsxs("div",{className:Z.effectCard,children:[e.jsx("img",{src:ve,alt:"Rewards",className:Z.effectIcon}),e.jsx("div",{className:Z.effectName,children:"Exclusive Rewards"}),e.jsx("div",{className:Z.effectDesc,children:"Unlock unique in-game rewards and badges for your generosity."})]}),e.jsxs("div",{className:Z.effectCard,children:[e.jsx("img",{src:we,alt:"Leaderboard",className:Z.effectIcon}),e.jsx("div",{className:Z.effectName,children:"Charity Leaderboard"}),e.jsx("div",{className:Z.effectDesc,children:"Top donors are featured on the Guardian Angel leaderboard."})]})]})]})]})})},Ec="/assets/clickimg-DfywW0u5.png",Ic="/assets/double-tap-D8lEel7J.png";function Tc(s){return 1+Math.floor(s/1e4)*2}const Mc=({coinCount:s})=>{const o=Tc(s);return e.jsxs("span",{className:X.coinsPerTap,children:[e.jsx("img",{src:Ic,alt:"Coins per tap",style:{width:22,marginRight:4,verticalAlign:"middle"}}),"+",o," /tap"]})},Rc=({onClick:s,imgSrc:o})=>{const i=t.useRef(null),f=t.useRef(null),x=()=>{i.current&&(i.current.classList.add(X.pressed),setTimeout(()=>i.current&&i.current.classList.remove(X.pressed),120)),f.current&&(f.current.style.opacity="1",f.current.classList.remove(X.coinGain),f.current.offsetWidth,f.current.classList.add(X.coinGain),setTimeout(()=>f.current&&(f.current.style.opacity="0"),700)),Y("mining"),s()};return e.jsxs("div",{className:X.miningButtonWrapper,children:[e.jsx("img",{ref:i,src:o,alt:"Click to earn coins",className:X.miningButton,onClick:x}),e.jsx("div",{ref:f,className:X.coinGain,style:{opacity:0},children:"+ðŸ’°"})]})},Cc=({coinCount:s})=>e.jsxs("h1",{className:X.coinBalance,children:[e.jsx("img",{src:ve,alt:"Coin",style:{width:32,marginRight:8,verticalAlign:"middle"}}),s]}),Bc=({coinsPerHour:s})=>e.jsxs("div",{className:X.passiveIncome,children:[e.jsx("img",{src:Yt,alt:"Passive Income",style:{width:22,marginRight:4,verticalAlign:"middle"}}),"+",s.toLocaleString()," /hr"]}),Nc="/assets/battery-aLTBX9JC.png",Pc=({energy:s,maxEnergy:o})=>{const i=Math.max(0,Math.min(100,s/o*100));return e.jsxs("div",{className:X.energyBarContainer,children:[e.jsx("div",{className:X.energyBar,style:{width:`${i}%`}}),e.jsxs("span",{className:X.energyText,children:[e.jsx("img",{src:Nc,alt:"Energy",style:{width:18,marginRight:4,verticalAlign:"middle"}}),s," / ",o]})]})};function Lc(s){return 1+Math.floor(s/1e4)*2}function ro(){return 1e4}const fn=5e3;function Dc(){return fn}const _c=({userId:s})=>{const[o,i]=t.useState("marketplace");return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",gap:8,marginBottom:16,justifyContent:"center"},children:[e.jsx("button",{onClick:()=>i("marketplace"),style:{fontWeight:o==="marketplace"?700:400,background:o==="marketplace"?"#ffe259":"#fff",borderRadius:6,padding:"4px 16px",border:"1px solid #eee"},children:"Marketplace Listings"}),e.jsx("button",{onClick:()=>i("nfts"),style:{fontWeight:o==="nfts"?700:400,background:o==="nfts"?"#ffe259":"#fff",borderRadius:6,padding:"4px 16px",border:"1px solid #eee"},children:"NFT Gallery & Mint"})]}),o==="marketplace"?e.jsx(Aa,{}):e.jsx(ho,{userId:s})]})};function io(){var s,o,i;try{const f=(s=window.Telegram)==null?void 0:s.WebApp;if(f&&((i=(o=f.initDataUnsafe)==null?void 0:o.user)!=null&&i.id))return f.initDataUnsafe.user.id.toString()}catch{}}function Wc(){const[s,o]=t.useState(()=>{try{return JSON.parse(localStorage.getItem("trophiesEarned")||"{}")}catch{return{}}}),i=l=>{s[l.key]||(o(a=>{const r={...a,[l.key]:!0};return localStorage.setItem("trophiesEarned",JSON.stringify(r)),r}),x(a=>a+l.reward),j&&ba({userId:j,achievement:l.key}))},[f,x]=t.useState(0),[I,c]=t.useState(0),[v,m]=t.useState(null),[j,A]=t.useState(()=>io()||localStorage.getItem("userId")||"");t.useEffect(()=>{const l=io();l&&l!==j&&(A(l),localStorage.setItem("userId",l)),j&&Ea("app_loaded",j)},[j]),t.useEffect(()=>(H()||ss("arcade_bgm",!0,.35),()=>pn()),[]);const[k,L]=t.useState("coin"),[B,_]=t.useState(Dc()),[w,D]=t.useState(()=>{try{return JSON.parse(localStorage.getItem("purchasedItems")||"{}")}catch{return{}}}),[n,p]=t.useState(()=>{try{return JSON.parse(localStorage.getItem("upgrades")||"{}")}catch{return{}}}),[u,N]=t.useState(1),[R,M]=t.useState(1),[b,d]=t.useState({});t.useEffect(()=>{const l=setInterval(()=>{let a=ro();n.passiveIncome&&(a+=100*Math.pow(2,n.passiveIncome-1)),n.hungerDrive&&(a+=500*Math.pow(2,n.hungerDrive-1)),n.autoMiner&&(a+=50*Math.pow(2,n.autoMiner-1)),n.magnet&&(a+=100*Math.pow(2,n.magnet-1)),b.passiveboost&&b.passiveboost>Date.now()&&(a*=2),x(r=>r+a/3600)},1e3);return()=>clearInterval(l)},[n,b]),t.useEffect(()=>{Ia(),new Date().getHours()===10&&Notification.permission==="granted"&&Ta("Donâ€™t forget your daily check-in!",{body:"Earn your daily bonus in the app."})},[]),t.useEffect(()=>{(async()=>{const a=localStorage.getItem("userId");if(a){A(a);const r=await $n(a);r&&(x(r.coins),c(r.coins),m(r.country))}else{const C=new URLSearchParams(window.location.search).get("start"),G="You";if(localStorage.setItem("userId",G),A(G),C){const P=await Da(C);if(P&&P.userid!==G){await rs(P.userid,G,void 0,1);const{data:g}=await Q.from("referrals").select("id, referrer_id, referral_level").eq("referred_id",P.userid).single();g&&await rs(g.referrer_id,G,g.id,g.referral_level+1)}}}})()},[]),t.useEffect(()=>{!j||!v||f!==I&&(kn({userId:j,coins:f}),c(f))},[f,j,v,I]),t.useEffect(()=>{if(!j||!v)return;const l=setInterval(()=>{kn({userId:j,coins:f}),c(f)},3e4);return()=>clearInterval(l)},[f,j,v]);const T=async l=>{p(a=>{const r=a[l]||0;if(r>=5e3)return a;const G={coinPerTap:400,passiveIncome:500,energy:300,hungerDrive:500,energyRegen:350,tapStreak:600,criticalTap:700,autoMiner:800,energySaver:900,magnet:1e3,ultraBoost:2e3,goldenTouch:2500}[l]*Math.pow(2,r);if(f<G)return a;x(g=>g-G),j&&xa({userId:j,upgrade:l,cost:G}),l==="energy"&&_(g=>g+100*Math.pow(2,r)),l==="ultraBoost"&&(N(g=>g*2),M(g=>g*2),setTimeout(()=>{N(g=>g/2),M(g=>g/2)},60*60*1e3));const P={...a,[l]:r+1};return localStorage.setItem("upgrades",JSON.stringify(P)),P})},h=async l=>{const a=l.target.value;m(a),j&&await Na({userid:j,country:a,coins:0})},y=t.useCallback(()=>{let l=Lc(f);return n.coinPerTap&&(l+=2*Math.pow(2,n.coinPerTap-1)),n.goldenTouch&&(l+=10*Math.pow(2,n.goldenTouch-1)),b.doubletap&&b.doubletap>Date.now()&&(l*=2),b.megatap&&b.megatap>Date.now()&&(l*=100),b.doubleCoins&&b.doubleCoins>Date.now()&&(l*=2),w.goldentap&&(l+=100),l*u},[f,n,b,w,u]);t.useEffect(()=>{if(b.autoMiner&&b.autoMiner>Date.now()){const l=setInterval(()=>{x(a=>a+y())},1e3);return()=>clearInterval(l)}},[b,y]);const W=async()=>{if(B<=0)return;let l=y();n.tapStreak&&(l+=10*Math.pow(2,n.tapStreak-1)),n.criticalTap&&Math.random()<.05*n.criticalTap&&(l*=2),x(r=>r+l);let a=1;n.energySaver&&(a=Math.max(1,a-n.energySaver)),_(r=>Math.max(0,r-a)),j&&v&&kn({userId:j,coins:f+l}),b.megatap&&b.megatap>Date.now()&&d(r=>({...r,megatap:0}))},U=l=>{D(r=>{const C={...r,[l.label]:!0};return localStorage.setItem("purchasedItems",JSON.stringify(C)),C}),l.label.includes("Coin Multiplier")&&l.value&&N(l.value),l.label.includes("Energy Multiplier")&&l.value&&M(l.value);const a=Date.now();if(l.effect==="autoclicker"){const r=setInterval(()=>{x(C=>C+y())},1e3);setTimeout(()=>clearInterval(r),60*60*1e3)}if(l.effect==="doubletap"&&d(r=>({...r,doubletap:a+60*60*1e3})),l.effect==="refill"&&_(fn*R),l.effect==="passiveboost"&&d(r=>({...r,passiveboost:a+60*60*1e3})),l.effect==="luckyspin"&&Math.random()<.1&&x(r=>r*10),l.effect==="megatap"&&d(r=>({...r,megatap:a+10*1e3})),l.effect==="energysaver"&&d(r=>({...r,energysaver:a+60*60*1e3})),l.effect==="magnet"){const r=setInterval(()=>{x(C=>C+100)},5e3);setTimeout(()=>clearInterval(r),60*60*1e3)}l.effect==="goldentap"&&d(r=>({...r,goldentap:1/0})),l.effect==="ultraboost"&&(N(r=>r*2),M(r=>r*2),setTimeout(()=>{N(r=>r/2),M(r=>r/2)},10*60*1e3))},S=()=>{if(!v)return e.jsxs("div",{className:X.countrySelection,children:[e.jsx("h1",{children:"Select Your Country"}),e.jsxs("select",{onChange:h,defaultValue:"",children:[e.jsx("option",{value:"",disabled:!0,children:"Choose your country"}),_a.map(l=>e.jsx("option",{value:l,children:l},l))]})]});switch(k){case"Marketplace":return e.jsx(_c,{userId:j});case"AdminAnalytics":return e.jsx($a,{});case"coin":return e.jsxs("div",{className:X.centerContent,children:[e.jsxs("div",{className:X.topRow,children:[e.jsx("div",{className:X.coinsPerTapTopLeft,children:e.jsx(Mc,{coinCount:f})}),e.jsx("div",{className:X.coinBalanceCenter,children:e.jsx(Cc,{coinCount:Math.floor(f)})}),e.jsx("div",{className:X.passiveIncomeTopRight,children:e.jsx(Bc,{coinsPerHour:ro()})})]}),e.jsx(Pc,{energy:B,maxEnergy:fn}),e.jsxs("p",{children:["Country: ",v]}),e.jsx(Rc,{onClick:W,imgSrc:Ec})]});case"leaderboard":return e.jsx(Ga,{});case"Shop":return e.jsx(Ja,{onPurchase:U,purchased:w});case"Trophies":{const l=Object.keys(w).length;return e.jsx(cr,{coinCount:Math.floor(f),energy:Math.floor(B),shopPurchases:l,earned:s,onEarn:i})}case"Tasks":return e.jsx(Ir,{});case"Upgrades":return e.jsx(zr,{upgrades:n,coins:f,onPurchase:T});case"Friends":return e.jsx(Or,{});case"Boosts":return e.jsx(ei,{coinCount:f,activeBoosts:b,onPurchase:l=>{const a=Date.now();l==="doubleCoins"?(d(r=>({...r,doubleCoins:a+60*60*1e3})),x(r=>r-1e3)):l==="energyRefill"?(_(fn*R),x(r=>r-500)):l==="autoMiner"?(d(r=>({...r,autoMiner:a+60*60*1e3})),x(r=>r-2e3)):l==="passiveBoost"&&(d(r=>({...r,passiveboost:a+60*60*1e3})),x(r=>r-1500))}});case"Arcade":return e.jsx($l,{userId:j,coinBalance:f,onDeposit:l=>x(a=>a+l),onWithdraw:l=>x(a=>Math.max(0,a-l)),onScore:l=>x(a=>a+l)});case"Airdrop":return e.jsx(jc,{});case"profile":return e.jsx(Yr,{userId:j});case"chat":return e.jsx(Fr,{userId:j});case"events":return e.jsx(qr,{userId:j});case"nfts":return e.jsx(ho,{userId:j});case"useranalytics":return e.jsx(Zr,{userId:j});case"guardianangel":return e.jsx(ua,{userId:j});default:return null}};return e.jsx(Ba,{children:e.jsx("div",{className:X.background,children:e.jsxs("div",{className:X.app,children:[e.jsx("button",{onClick:()=>{ia(),H()||ss("arcade_bgm",!0,.35)},style:{position:"fixed",top:18,right:18,zIndex:1e3,background:H()?"#eee":"linear-gradient(135deg,#ffe259,#ffa751,#43cea2,#185a9d)",color:H()?"#888":"#222",border:"none",borderRadius:24,padding:"10px 18px",fontWeight:700,fontSize:18,boxShadow:"0 2px 12px #24308a22",transition:"background 0.2s, color 0.2s",cursor:"pointer"},"aria-label":H()?"Unmute":"Mute",children:H()?"ðŸ”‡ Sound Off":"ðŸ”Š Sound On"}),S(),v&&e.jsx(Va,{onNavigate:L})]})})})}function zc(){const s=Qn();return t.useEffect(()=>{async function o(){var i,f,x;if(s&&s.account.address){let I;try{const c=(i=window.Telegram)==null?void 0:i.WebApp;c&&((x=(f=c.initDataUnsafe)==null?void 0:f.user)!=null&&x.id)&&(I=c.initDataUnsafe.user.id.toString())}catch{}I&&await Q.from("users").update({ton_wallet:s.account.address}).eq("userid",I)}}o()},[s]),null}No.ready();Ro.createRoot(document.getElementById("root")).render(e.jsx(lo.StrictMode,{children:e.jsxs(Co,{manifestUrl:"https://ton-connect.github.io/demo-dapp-with-react-ui/tonconnect-manifest.json",children:[e.jsx(zc,{}),e.jsx(Wc,{})]})}));
